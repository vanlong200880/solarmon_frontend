{"ast":null,"code":"import Constants from \"./Constants\";\nimport Libs from \"./Libs\";\nvar Auth = {};\n\nAuth.checkIsLogin = function () {\n  try {\n    let ar = window.location.pathname.split(\"/\");\n    let path = ar.length > 1 ? ar[1] : \"\";\n    let isCheck = true;\n\n    if (path !== '') {\n      isCheck = Constants.SITE_URL.PUBLIC_URL.indexOf(path) < 0;\n    }\n\n    if (!isCheck) {\n      return true;\n    }\n\n    let token = localStorage.getItem(Constants.COMMON.TOKEN);\n\n    if (null === token || typeof token === 'undefined') {\n      return false;\n    }\n\n    let info = localStorage.getItem(Constants.COMMON.EMPLOYEE_INFO);\n    let userInfo = JSON.parse(Libs.base64Decrypt(info));\n\n    if (null === userInfo || typeof userInfo === 'undefined') {\n      return false;\n    }\n\n    if (null === userInfo.email || typeof userInfo.email === 'undefined') {\n      return false;\n    }\n\n    let expired = userInfo.timeout * 1;\n    let now = new Date().getTime();\n\n    if (now > expired * 1000) {\n      localStorage.removeItem(Constants.COMMON.TOKEN);\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n/**\n * check the action permission\n * @param {int} actions: permissions\n * @param {int} bitIdx: action index to check\n */\n\n\nAuth.getPermisson = function (actions, bitIdx) {\n  return Libs.checkBitOnOff(actions, bitIdx);\n};\n\nexport default Auth;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/utils/Auth.js"],"names":["Constants","Libs","Auth","checkIsLogin","ar","window","location","pathname","split","path","length","isCheck","SITE_URL","PUBLIC_URL","indexOf","token","localStorage","getItem","COMMON","TOKEN","info","EMPLOYEE_INFO","userInfo","JSON","parse","base64Decrypt","email","expired","timeout","now","Date","getTime","removeItem","e","getPermisson","actions","bitIdx","checkBitOnOff"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,aAAtB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,IAAIC,IAAI,GAAG,EAAX;;AACAA,IAAI,CAACC,YAAL,GAAoB,YAAY;AAC/B,MAAI;AACH,QAAIC,EAAE,GAAGC,MAAM,CAACC,QAAP,CAAgBC,QAAhB,CAAyBC,KAAzB,CAA+B,GAA/B,CAAT;AACA,QAAIC,IAAI,GAAGL,EAAE,CAACM,MAAH,GAAU,CAAV,GAAYN,EAAE,CAAC,CAAD,CAAd,GAAkB,EAA7B;AACA,QAAIO,OAAO,GAAG,IAAd;;AACA,QAAGF,IAAI,KAAG,EAAV,EAAa;AACZE,MAAAA,OAAO,GAAGX,SAAS,CAACY,QAAV,CAAmBC,UAAnB,CAA8BC,OAA9B,CAAsCL,IAAtC,IAA4C,CAAtD;AACA;;AACD,QAAG,CAACE,OAAJ,EAAY;AACX,aAAO,IAAP;AACA;;AACD,QAAII,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqBjB,SAAS,CAACkB,MAAV,CAAiBC,KAAtC,CAAZ;;AACA,QAAI,SAASJ,KAAT,IAAkB,OAAOA,KAAP,KAAiB,WAAvC,EAAoD;AACnD,aAAO,KAAP;AACA;;AACD,QAAIK,IAAI,GAAGJ,YAAY,CAACC,OAAb,CAAqBjB,SAAS,CAACkB,MAAV,CAAiBG,aAAtC,CAAX;AACA,QAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWvB,IAAI,CAACwB,aAAL,CAAmBL,IAAnB,CAAX,CAAf;;AACA,QAAI,SAASE,QAAT,IAAqB,OAAOA,QAAP,KAAoB,WAA7C,EAA0D;AACzD,aAAO,KAAP;AACA;;AACD,QAAI,SAASA,QAAQ,CAACI,KAAlB,IAA2B,OAAOJ,QAAQ,CAACI,KAAhB,KAA0B,WAAzD,EAAsE;AACrE,aAAO,KAAP;AACA;;AACD,QAAIC,OAAO,GAAGL,QAAQ,CAACM,OAAT,GAAmB,CAAjC;AACA,QAAIC,GAAG,GAAG,IAAIC,IAAJ,GAAWC,OAAX,EAAV;;AACA,QAAIF,GAAG,GAAGF,OAAO,GAAC,IAAlB,EAAwB;AACvBX,MAAAA,YAAY,CAACgB,UAAb,CAAwBhC,SAAS,CAACkB,MAAV,CAAiBC,KAAzC;AACA,aAAO,KAAP;AACA;;AACD,WAAO,IAAP;AACA,GA7BD,CA6BE,OAAOc,CAAP,EAAU;AACX,WAAO,KAAP;AACA;AACD,CAjCD;AAmCA;AACA;AACA;AACA;AACA;;;AACA/B,IAAI,CAACgC,YAAL,GAAoB,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC9C,SAAOnC,IAAI,CAACoC,aAAL,CAAmBF,OAAnB,EAA4BC,MAA5B,CAAP;AACA,CAFD;;AAIA,eAAelC,IAAf","sourcesContent":["import Constants from \"./Constants\";\nimport Libs from \"./Libs\";\nvar Auth = {};\nAuth.checkIsLogin = function () {\n\ttry {\n\t\tlet ar = window.location.pathname.split(\"/\");\n\t\tlet path = ar.length>1?ar[1]:\"\";\n\t\tlet isCheck = true;\n\t\tif(path!==''){\n\t\t\tisCheck = Constants.SITE_URL.PUBLIC_URL.indexOf(path)<0\n\t\t}\n\t\tif(!isCheck){\n\t\t\treturn true;\n\t\t}\n\t\tlet token = localStorage.getItem(Constants.COMMON.TOKEN);\n\t\tif (null === token || typeof token === 'undefined') {\n\t\t\treturn false;\n\t\t}\n\t\tlet info = localStorage.getItem(Constants.COMMON.EMPLOYEE_INFO);\n\t\tlet userInfo = JSON.parse(Libs.base64Decrypt(info));\n\t\tif (null === userInfo || typeof userInfo === 'undefined') {\n\t\t\treturn false;\n\t\t}\n\t\tif (null === userInfo.email || typeof userInfo.email === 'undefined') {\n\t\t\treturn false;\n\t\t}\n\t\tlet expired = userInfo.timeout * 1;\n\t\tlet now = new Date().getTime();\n\t\tif (now > expired*1000) {\n\t\t\tlocalStorage.removeItem(Constants.COMMON.TOKEN)\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n}\n\n/**\n * check the action permission\n * @param {int} actions: permissions\n * @param {int} bitIdx: action index to check\n */\nAuth.getPermisson = function (actions, bitIdx) {\n\treturn Libs.checkBitOnOff(actions, bitIdx);\n}\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}