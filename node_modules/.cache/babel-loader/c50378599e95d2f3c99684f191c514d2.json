{"ast":null,"code":"import DeviceJsx from './Device.jsx';\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport { withTranslation } from 'react-i18next';\nimport Constants from '../../../../../utils/Constants';\nimport ClientDeviceService from '../../../../../services/ClientDeviceService';\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport moment from 'moment';\n\nclass Device extends BaseComponent {\n  constructor(props, context) {\n    super(props, context);\n\n    this.downloadData = () => {\n      var {\n        dataList\n      } = this.state;\n      var {\n        t\n      } = this.props;\n      if (!Libs.isArrayData(dataList)) return;\n      var dataExport = [];\n\n      for (var i = 0, len = dataList.length; i < len; i++) {\n        var itemLevel = dataList[i].alerts;\n        var error = 0,\n            warning = 0,\n            info = 0,\n            fatal = 0,\n            debug = 0;\n\n        if (Libs.isArrayData(itemLevel)) {\n          for (var j = 0, leng = itemLevel.length; j < leng; j++) {\n            switch (parseInt(itemLevel[j].id)) {\n              case 1:\n                error = itemLevel[j].total_alert;\n                break;\n\n              case 2:\n                warning = itemLevel[j].total_alert;\n                break;\n\n              case 3:\n                info = itemLevel[j].total_alert;\n                break;\n\n              case 4:\n                fatal = itemLevel[j].total_alert;\n                break;\n\n              case 5:\n                debug = itemLevel[j].total_alert;\n                break;\n            }\n          }\n        }\n\n        dataExport.push({\n          'ID': dataList[i].id,\n          'Device name': dataList[i].name,\n          'Model': dataList[i].model,\n          'Serial number': dataList[i].serial_number,\n          'Device type': dataList[i].device_type_name,\n          'Power now': Libs.formatNum(dataList[i].power_now, '#,###.##') + \" kW\",\n          'Energy today': Libs.formatNum(dataList[i].today_energy, '#,###.##') + \" kWh\",\n          'Lifetime': Libs.formatElectricalUnit(dataList[i].lifetime, 'h'),\n          'Error': error,\n          'Warning': warning,\n          'Info': info,\n          'Fatal': fatal,\n          'Debug': debug\n        });\n      }\n\n      const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n      const fileExtension = '.xlsx';\n      const ws = XLSX.utils.json_to_sheet(dataExport, {\n        skipHeader: false\n      });\n      const wb = {\n        SheetNames: ['Alerts'],\n        Sheets: {\n          'Alerts': ws\n        }\n      };\n      const excelBuffer = XLSX.write(wb, {\n        bookType: 'xlsx',\n        type: 'array'\n      });\n      const data = new Blob([excelBuffer], {\n        type: fileType\n      });\n      FileSaver.saveAs(data, \"Export-alerts-\" + moment().format('YYYY-MM-DD_hh:mm:ss') + fileExtension);\n    };\n\n    this.onClickViewDevice = index => {\n      let {\n        dataList\n      } = this.state;\n      if (!Libs.isArrayData(dataList)) return;\n      var item = dataList[index];\n      if (Libs.isObjectEmpty(item)) return;\n      item.screen_mode = Constants.SCREEN_MODE.ADD;\n      this.setState({\n        show_tab: 1,\n        curItem: item,\n        viewDevice: true\n      });\n    };\n\n    this.onClickChartDevice = index => {\n      let {\n        dataList\n      } = this.state;\n      if (!Libs.isArrayData(dataList)) return;\n      var item = dataList[index];\n      if (Libs.isObjectEmpty(item)) return;\n      item.screen_mode = Constants.SCREEN_MODE.ADD;\n      this.setState({\n        show_tab: 3,\n        curItem: item,\n        viewDevice: true\n      }); // let curItem = this.state.curItem;\n      // curItem.data_send_time = 1;\n      // curItem.type = 1;\n      // curItem.screen_mode = Constants.SCREEN_MODE.ADD;\n      // this.setState({\n      //     curItem: curItem,\n      //     show_tab: 3,\n      //     viewDevice: true\n      // });\n    };\n\n    this.viewAlertDevice = index => {\n      var {\n        dataList,\n        curItem\n      } = this.state;\n      if (!Libs.isArrayData(dataList)) return;\n      var item = dataList[index];\n      if (Libs.isObjectEmpty(item)) return;\n      curItem.screen_mode = Constants.SCREEN_MODE.ADD;\n      this.setState({\n        curItem: Object.assign(curItem, item),\n        show_tab: 2,\n        viewDevice: true\n      });\n    };\n\n    this.onClickCloseViewDevice = status => {\n      if (status) {// this.getList();\n      }\n\n      this.setState({\n        viewDevice: false\n      });\n    };\n\n    this.jsxTemplate = DeviceJsx;\n    this.state = {\n      hash_id: !Libs.isObjectEmpty(this.params) ? this.params.id : null,\n      curItem: {},\n      dataList: [],\n      show_tab: 1,\n      searchParam: {\n        limit: Constants.COMMON.LIMIT,\n        offset: 0,\n        index: 1,\n        max_date: Libs.getCurrentDDMMYYYY(),\n        current_date: Libs.getCurrentDDMMYYYY()\n      },\n      viewDevice: false,\n      formSearch: false\n    };\n    this.paging = {\n      total: 0,\n      current: 1,\n      currentInput: 1\n    };\n    this.inputChangedHandler = this.inputChangedHandler.bind(this);\n    this.inputChangedEnter = this.inputChangedEnter.bind(this);\n    this.inputChangedBlue = this.inputChangedBlue.bind(this);\n  }\n\n  componentDidMount() {\n    this.getList();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let self = this;\n\n    if (nextProps.match.params.id !== this.props.match.params.id) {\n      this.setState({\n        hash_id: nextProps.match.params.id\n      }, () => {\n        self.getList();\n      });\n    }\n  }\n  /**\n   * setValue method to Input\n   * @author Long.Pham 20/05/2021\n   */\n\n\n  handleInputDateChange(event) {\n    let target = event.target;\n    let name = target.name;\n    var self = this;\n    let value = target.value;\n\n    if (target.type === 'checkbox') {\n      value = target.checked ? 1 : 0;\n    }\n\n    if (name) {\n      let {\n        searchParam\n      } = this.state;\n      searchParam[name] = value;\n      this.setState({\n        searchParam\n      }, () => {\n        self.getList();\n      });\n    }\n  }\n\n  /**\n   * get list\n   * @author Long.Pham 2019-06-03\n   */\n  getList() {\n    let self = this;\n    let params = this.state.searchParam;\n    params.id_language = this.employee.id_language;\n    params.id_employee = this.employee.id_employee;\n    params.hash_id = this.state.hash_id;\n    params.type = 'customer';\n    ClientDeviceService.instance.getListDeviceByHashId(params, (data, total_row) => {\n      if (Libs.isArrayData(data)) {\n        self.setState({\n          dataList: data\n        });\n        var total = parseInt(total_row / self.state.searchParam.limit);\n\n        if (total_row % self.state.searchParam.limit > 0) {\n          total = total + 1;\n        }\n\n        self.paging.total = total;\n        self.paging.current = self.state.searchParam.index;\n        self.paging.currentInput = self.state.searchParam.index;\n        self.state.total_row = total_row;\n      } else {\n        self.setState({\n          dataList: [],\n          total_row: 0\n        });\n        self.paging.total = 0;\n        self.paging.current = 1;\n        self.paging.currentInput = 1;\n      }\n\n      self.forceUpdate();\n    });\n  }\n\n  inputChangedHandler(event) {\n    let self = this;\n    let target = event.target;\n    let name = target.name;\n    let value = target.value;\n\n    if (name === 'current') {\n      if (!Libs.isBlank(value)) {\n        var {\n          t\n        } = this.props;\n\n        if (!Libs.isNumber(value)) {\n          self.toast(t('common.page_is_number'), \"error\");\n          return;\n        }\n      }\n\n      self.paging.currentInput = value;\n      self.forceUpdate();\n    }\n\n    if (name === 'limit') {\n      var {\n        searchParam\n      } = this.state;\n      searchParam.limit = value;\n      this.setState({\n        searchParam: searchParam\n      }, () => {\n        self.getList();\n      });\n    }\n  }\n\n  inputChangedEnter(event) {\n    let self = this;\n\n    if (event.key === 'Enter') {\n      var currentInput = this.paging.currentInput;\n\n      if (!Libs.isBlank(currentInput)) {\n        var {\n          t\n        } = this.props;\n\n        if (!Libs.isNumber(currentInput)) {\n          self.toast(t('common.page_is_number'), \"error\");\n          return;\n        }\n      }\n\n      if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n\n      if (parseInt(currentInput) > this.paging.total) {\n        currentInput = self.paging.total;\n      }\n\n      if (currentInput <= 0) {\n        currentInput = 1;\n      }\n\n      self.paging.current = currentInput;\n      self.paging.currentInput = currentInput;\n      this.onSelectPage(currentInput);\n      self.forceUpdate();\n    }\n  }\n\n  inputChangedBlue(event) {\n    let self = this;\n    let target = event.target;\n    let name = target.name;\n\n    if (name === 'current') {\n      var currentInput = this.paging.currentInput;\n\n      if (!Libs.isBlank(currentInput)) {\n        var {\n          t\n        } = this.props;\n\n        if (!Libs.isNumber(currentInput)) {\n          self.toast(t('common.page_is_number'), \"error\");\n          return;\n        }\n      }\n\n      if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n\n      if (parseInt(currentInput) > this.paging.total) {\n        currentInput = self.paging.total;\n      }\n\n      if (currentInput <= 0) {\n        currentInput = 1;\n      }\n\n      self.paging.current = currentInput;\n      self.paging.currentInput = currentInput;\n      this.onSelectPage(currentInput);\n      self.forceUpdate();\n    }\n  }\n  /**\n   * @description Select page in pagging\n   * @author long.pham 09/05/2021\n   * @param {int} index\n   */\n\n\n  onSelectPage(index) {\n    let self = this;\n    self.state.searchParam.index = index;\n\n    if (index > 0) {\n      self.state.searchParam.offset = (index - 1) * self.state.searchParam.limit;\n    } else {\n      self.state.searchParam.offset = 0;\n    }\n\n    self.getList();\n  }\n  /**\n   * @description reload data\n   * @author long.pham 09/05/2021\n   * @param {int} index\n   */\n\n\n  onClickReload() {\n    let self = this;\n    self.getList();\n  }\n  /**\n  * Func filter table\n  * @author Long.Pham 12-05-2021\n  * @param  {Object} e\n  */\n\n\n  onSort(event, sortKey) {\n    this.state.searchParam.sort_column = sortKey;\n    this.state.searchParam.order_by = this.state.searchParam.order_by === '' || this.state.searchParam.order_by === 'asc' ? 'desc' : 'asc';\n    this.getList();\n  }\n  /**\n    * @description Call form search\n    * @author Long.Pham 12/05/2021\n    */\n\n\n  onSearch() {\n    let formSearch = this.state.formSearch === false ? true : false;\n    this.setState({\n      formSearch: formSearch\n    });\n  }\n\n  onResetSearch() {\n    let self = this;\n    let searchParam = this.state.searchParam;\n    searchParam.name = null;\n    searchParam.id = null;\n    searchParam.index = 1;\n    searchParam.offset = 0;\n    self.paging.current = 1;\n    self.paging.currentInput = 1;\n    self.paging.total = 1;\n    self.setState({\n      searchParam: searchParam\n    }, () => {\n      self.getList();\n    });\n  }\n  /**\n   * Func search\n   * @author Long.Pham 12/05/2021\n   * @param  {Object} e\n   */\n\n\n  handleSearch() {\n    this.getList();\n  }\n\n  render() {\n    return this.jsxTemplate.call(this);\n  }\n\n}\n\nconst HighOrderComponentTranslated = withTranslation('common')(Device);\nexport default HighOrderComponentTranslated;","map":{"version":3,"sources":["/Volumes/Data/sources/solarmon_production/solarmon_frontend/src/containers/views/desktop/ModuleProject/Device/Device.js"],"names":["DeviceJsx","BaseComponent","Libs","withTranslation","Constants","ClientDeviceService","FileSaver","XLSX","moment","Device","constructor","props","context","downloadData","dataList","state","t","isArrayData","dataExport","i","len","length","itemLevel","alerts","error","warning","info","fatal","debug","j","leng","parseInt","id","total_alert","push","name","model","serial_number","device_type_name","formatNum","power_now","today_energy","formatElectricalUnit","lifetime","fileType","fileExtension","ws","utils","json_to_sheet","skipHeader","wb","SheetNames","Sheets","excelBuffer","write","bookType","type","data","Blob","saveAs","format","onClickViewDevice","index","item","isObjectEmpty","screen_mode","SCREEN_MODE","ADD","setState","show_tab","curItem","viewDevice","onClickChartDevice","viewAlertDevice","Object","assign","onClickCloseViewDevice","status","jsxTemplate","hash_id","params","searchParam","limit","COMMON","LIMIT","offset","max_date","getCurrentDDMMYYYY","current_date","formSearch","paging","total","current","currentInput","inputChangedHandler","bind","inputChangedEnter","inputChangedBlue","componentDidMount","getList","componentWillReceiveProps","nextProps","self","match","handleInputDateChange","event","target","value","checked","id_language","employee","id_employee","instance","getListDeviceByHashId","total_row","forceUpdate","isBlank","isNumber","toast","key","onSelectPage","onClickReload","onSort","sortKey","sort_column","order_by","onSearch","onResetSearch","handleSearch","render","call","HighOrderComponentTranslated"],"mappings":"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","sourcesContent":["import DeviceJsx from './Device.jsx';\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport { withTranslation } from 'react-i18next';\nimport Constants from '../../../../../utils/Constants';\nimport ClientDeviceService from '../../../../../services/ClientDeviceService';\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport moment from 'moment';\n\nclass Device extends BaseComponent {\n\n    constructor(props, context) {\n        super(props, context);\n        this.jsxTemplate = DeviceJsx;\n        this.state = {\n            hash_id: !Libs.isObjectEmpty(this.params) ? this.params.id : null,\n            curItem: {},\n            dataList: [],\n            show_tab: 1,\n            searchParam: {\n                limit: Constants.COMMON.LIMIT,\n                offset: 0,\n                index: 1,\n                max_date: Libs.getCurrentDDMMYYYY(),\n                current_date: Libs.getCurrentDDMMYYYY()\n            },\n            viewDevice: false,\n            formSearch: false\n        };\n\n        this.paging = {\n            total: 0,\n            current: 1,\n            currentInput: 1\n        };\n        this.inputChangedHandler = this.inputChangedHandler.bind(this);\n        this.inputChangedEnter = this.inputChangedEnter.bind(this);\n        this.inputChangedBlue = this.inputChangedBlue.bind(this);\n\n    }\n\n    componentDidMount() {\n        this.getList();\n    }\n    componentWillReceiveProps(nextProps) {\n        let self = this;\n        if (nextProps.match.params.id !== this.props.match.params.id) {\n            this.setState({\n                hash_id: nextProps.match.params.id\n            }, () => {\n                self.getList();\n            });\n        }\n    }\n\n    /**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */\n    handleInputDateChange(event) {\n        let target = event.target;\n        let name = target.name;\n        var self = this;\n        let value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n\n        if (name) {\n            let { searchParam } = this.state;\n            searchParam[name] = value;\n            this.setState({ searchParam }, () => {\n                self.getList();\n            });\n        }\n    }\n\n\n    downloadData = () => {\n        var { dataList } = this.state;\n        var { t } = this.props;\n        if (!Libs.isArrayData(dataList)) return;\n\n        var dataExport = [];\n        for (var i = 0, len = dataList.length; i < len; i++) {\n            var itemLevel = dataList[i].alerts;\n            var error = 0, warning = 0, info = 0, fatal = 0, debug = 0;\n            if (Libs.isArrayData(itemLevel)) {\n                for (var j = 0, leng = itemLevel.length; j < leng; j++) {\n                    switch (parseInt(itemLevel[j].id)) {\n                        case 1:\n                            error = itemLevel[j].total_alert;\n                            break;\n                        case 2:\n                            warning = itemLevel[j].total_alert;\n                            break;\n                        case 3:\n                            info = itemLevel[j].total_alert;\n                            break;\n                        case 4:\n                            fatal = itemLevel[j].total_alert;\n                            break;\n                        case 5:\n                            debug = itemLevel[j].total_alert;\n                            break;\n                    }\n                }\n            }\n            dataExport.push({\n                'ID': dataList[i].id,\n                'Device name': dataList[i].name,\n                'Model': dataList[i].model,\n                'Serial number': dataList[i].serial_number,\n                'Device type': dataList[i].device_type_name,\n                'Power now': Libs.formatNum(dataList[i].power_now, '#,###.##') + \" kW\",\n                'Energy today': Libs.formatNum(dataList[i].today_energy, '#,###.##') + \" kWh\",\n                'Lifetime': Libs.formatElectricalUnit(dataList[i].lifetime, 'h'),\n                'Error': error,\n                'Warning': warning,\n                'Info': info,\n                'Fatal': fatal,\n                'Debug': debug\n            });\n        }\n\n        const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n        const fileExtension = '.xlsx';\n        const ws = XLSX.utils.json_to_sheet(dataExport, { skipHeader: false });\n        const wb = {\n            SheetNames: ['Alerts'],\n            Sheets: { 'Alerts': ws }\n        };\n        const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, \"Export-alerts-\" + moment().format('YYYY-MM-DD_hh:mm:ss') + fileExtension);\n    }\n    /**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */\n    getList() {\n        let self = this;\n        let params = this.state.searchParam;\n        params.id_language = this.employee.id_language;\n        params.id_employee = this.employee.id_employee;\n        params.hash_id = this.state.hash_id;\n        params.type = 'customer';\n        \n        ClientDeviceService.instance.getListDeviceByHashId(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataList: data\n                });\n\n                var total = parseInt(total_row / self.state.searchParam.limit);\n                if (total_row % self.state.searchParam.limit > 0) {\n                    total = total + 1;\n                }\n                self.paging.total = total;\n                self.paging.current = self.state.searchParam.index;\n                self.paging.currentInput = self.state.searchParam.index;\n                self.state.total_row = total_row;\n\n            } else {\n                self.setState({\n                    dataList: [],\n                    total_row: 0\n                });\n                self.paging.total = 0;\n                self.paging.current = 1;\n                self.paging.currentInput = 1;\n            }\n            self.forceUpdate();\n        });\n    }\n\n\n    onClickViewDevice = (index) => {\n        let { dataList } = this.state;\n        if (!Libs.isArrayData(dataList)) return;\n        var item = dataList[index];\n        if (Libs.isObjectEmpty(item)) return;\n\n        item.screen_mode = Constants.SCREEN_MODE.ADD;\n        this.setState({\n            show_tab: 1,\n            curItem: item,\n            viewDevice: true\n        });\n    };\n\n\n    onClickChartDevice = (index) => {\n        let { dataList } = this.state;\n        if (!Libs.isArrayData(dataList)) return;\n        var item = dataList[index];\n        if (Libs.isObjectEmpty(item)) return;\n\n        item.screen_mode = Constants.SCREEN_MODE.ADD;\n        this.setState({\n            show_tab: 3,\n            curItem: item,\n            viewDevice: true\n        });\n\n        // let curItem = this.state.curItem;\n        // curItem.data_send_time = 1;\n        // curItem.type = 1;\n\n        // curItem.screen_mode = Constants.SCREEN_MODE.ADD;\n        // this.setState({\n        //     curItem: curItem,\n        //     show_tab: 3,\n        //     viewDevice: true\n        // });\n    };\n\n    viewAlertDevice = (index) => {\n        var { dataList, curItem } = this.state;\n        if (!Libs.isArrayData(dataList)) return;\n        var item = dataList[index];\n        if (Libs.isObjectEmpty(item)) return;\n        curItem.screen_mode = Constants.SCREEN_MODE.ADD;\n        this.setState({\n            curItem: Object.assign(curItem, item),\n            show_tab: 2,\n            viewDevice: true\n        })\n    }\n\n    onClickCloseViewDevice = (status) => {\n        if (status) {\n            // this.getList();\n        }\n        this.setState({\n            viewDevice: false\n        })\n    }\n\n\n\n\n    inputChangedHandler(event) {\n        let self = this;\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (name === 'current') {\n            if (!Libs.isBlank(value)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(value)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            self.paging.currentInput = value;\n            self.forceUpdate();\n        }\n\n        if (name === 'limit') {\n            var { searchParam } = this.state;\n            searchParam.limit = value;\n            this.setState({\n                searchParam: searchParam\n            }, () => {\n                self.getList();\n            })\n        }\n    }\n\n    inputChangedEnter(event) {\n        let self = this;\n        if (event.key === 'Enter') {\n            var currentInput = this.paging.currentInput;\n            if (!Libs.isBlank(currentInput)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(currentInput)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n            if (parseInt(currentInput) > this.paging.total) {\n                currentInput = self.paging.total;\n            }\n\n            if (currentInput <= 0) {\n                currentInput = 1;\n            }\n\n            self.paging.current = currentInput;\n            self.paging.currentInput = currentInput;\n            this.onSelectPage(currentInput);\n            self.forceUpdate();\n        }\n    }\n\n    inputChangedBlue(event) {\n        let self = this;\n        let target = event.target;\n        let name = target.name;\n        if (name === 'current') {\n            var currentInput = this.paging.currentInput;\n            if (!Libs.isBlank(currentInput)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(currentInput)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n            if (parseInt(currentInput) > this.paging.total) {\n                currentInput = self.paging.total;\n            }\n\n            if (currentInput <= 0) {\n                currentInput = 1;\n            }\n\n            self.paging.current = currentInput;\n            self.paging.currentInput = currentInput;\n            this.onSelectPage(currentInput);\n            self.forceUpdate();\n        }\n    }\n\n\n    /**\n     * @description Select page in pagging\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */\n    onSelectPage(index) {\n        let self = this;\n        self.state.searchParam.index = index;\n\n        if (index > 0) {\n            self.state.searchParam.offset = (index - 1) * self.state.searchParam.limit;\n        } else {\n            self.state.searchParam.offset = 0;\n        }\n        self.getList();\n    }\n\n\n    /**\n     * @description reload data\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */\n    onClickReload() {\n        let self = this;\n        self.getList();\n    }\n\n\n    /**\n    * Func filter table\n    * @author Long.Pham 12-05-2021\n    * @param  {Object} e\n    */\n\n    onSort(event, sortKey) {\n        this.state.searchParam.sort_column = sortKey;\n        this.state.searchParam.order_by = (this.state.searchParam.order_by === '' || this.state.searchParam.order_by === 'asc') ? 'desc' : 'asc';\n        this.getList();\n    }\n\n    /**\n      * @description Call form search\n      * @author Long.Pham 12/05/2021\n      */\n    onSearch() {\n        let formSearch = (this.state.formSearch === false) ? true : false;\n        this.setState({\n            formSearch: formSearch\n        });\n    }\n\n    onResetSearch() {\n        let self = this;\n        let searchParam = this.state.searchParam;\n        searchParam.name = null;\n        searchParam.id = null;\n        searchParam.index = 1;\n        searchParam.offset = 0;\n        self.paging.current = 1;\n        self.paging.currentInput = 1;\n        self.paging.total = 1;\n        self.setState({\n            searchParam: searchParam\n        }, () => {\n            self.getList();\n        });\n    }\n\n    /**\n     * Func search\n     * @author Long.Pham 12/05/2021\n     * @param  {Object} e\n     */\n    handleSearch() {\n        this.getList();\n    }\n\n    render() {\n        return this.jsxTemplate.call(this)\n    }\n}\n\nconst HighOrderComponentTranslated = withTranslation('common')(Device)\nexport default HighOrderComponentTranslated;"]},"metadata":{},"sourceType":"module"}