{"ast":null,"code":"import _toConsumableArray from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import ChartDeviceJsx from'./ChartDevice.jsx';import BaseComponent from'../../../../../BaseComponent';import Libs from'../../../../../../utils/Libs';import{withTranslation}from'react-i18next';import AnalyticsService from'../../../../../../services/AnalyticsService';import*as FileSaver from'file-saver';import*as XLSX from'xlsx';import moment from'moment';var ChartDevice=/*#__PURE__*/function(_BaseComponent){_inherits(ChartDevice,_BaseComponent);var _super=_createSuper(ChartDevice);function ChartDevice(props,context){var _this;_classCallCheck(this,ChartDevice);_this=_super.call(this,props,context);_this.callBackLoadChart=function(dataDevice,dataParameter){var self=_assertThisInitialized(_this);if(!Libs.isArrayData(dataDevice)||!Libs.isArrayData(dataParameter))return;_this.setState({dataDevice:dataDevice,dataParameter:dataParameter},function(){self.loadDataChart();});};_this.changeViewMinute=function(value){var chartParams=_this.state.chartParams,self=_assertThisInitialized(_this);if(Libs.isBlank(value))return;chartParams.data_send_time=value;_this.setState({chartParams:chartParams},function(){self.loadDataChart();});};_this.handleClickOutside=function(event){var target=event.target;var chartParams=_this.state.chartParams,self=_assertThisInitialized(_this);if(!_this.wrapperRef.current.contains(target)){if(chartParams.show_filter){chartParams.show_filter=false;self.setState({chartParams:chartParams});}}};_this.onClickFilter=function(value){var _this$state=_this.state,chartParams=_this$state.chartParams,dataFilter=_this$state.dataFilter,curItem=_this$state.curItem;var self=_assertThisInitialized(_this);if(!Libs.isArrayData(dataFilter))return;var item=Libs.find(dataFilter,'id',value);if(Libs.isObjectEmpty(item))return;chartParams.id_filter=item.id;chartParams.text_filter=item.text;chartParams.show_filter=false;chartParams.showNextBtn=false;switch(value){case'today':chartParams.end_date=Libs.getCurrentMMDDYYYYHI();chartParams.max_date=Libs.getCurrentMMDDYYYYHI();break;case'3_day':chartParams.end_date=Libs.getCurrentDDMMYYYY();chartParams.start_date=moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(),-2)).format('DD/MM/YYYY');chartParams.start_max_date=moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(),-2)).format('DD/MM/YYYY');chartParams.max_date=Libs.getCurrentDDMMYYYY();break;case'this_month':chartParams.max_date=moment().format('MM/YYYY');chartParams.end_date=moment().format('MM/YYYY');break;case'last_month':chartParams.max_date=moment().format('MM/YYYY');var tlast=new Date(Libs.getCurrentMMDDYYYYHI());var ylast=tlast.getFullYear(),mlast=tlast.getMonth();chartParams.end_date=moment(Libs.addMonths(new Date(ylast,mlast,1),-1)).endOf('month').format('MM/YYYY');chartParams.start_date=moment(Libs.addMonths(new Date(ylast,mlast,1),-1)).format('MM/YYYY');break;case'lifetime':case'12_month':chartParams.max_date=moment().format('MM/YYYY');chartParams.end_date=moment().format('MM/YYYY');chartParams.start_date=moment(Libs.addMonths(Libs.getCurrentMMDDYYYYHI(),-12)).format('MM/YYYY');break;// case 'lifetime':\n//     chartParams.start_date = moment(curItem.commissioning).format('MM/DD/YYYY HH:mm:ss');\n//     chartParams.end_date = Libs.getCurrentMMDDYYYYHI();\n//     break;\n}_this.setState({chartParams:chartParams},function(){self.loadDataChart();});};_this.onClickShowFilter=function(){var chartParams=_this.state.chartParams;chartParams.show_filter=true;_this.setState({chartParams:chartParams});};_this.downloadData=function(){var dataExport=_this.state.dataExport;if(Libs.isArrayData(dataExport)){var SheetNames=[],Sheets={};var fileType='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';var fileExtension='.xlsx';for(var i=0;i<dataExport.length;i++){SheetNames.push(dataExport[i].name);var dataSheets=[];var dataRows=dataExport[i].data;if(Libs.isArrayData(dataRows)){dataRows.map(function(item,index){dataSheets.push(item);});}var ws=XLSX.utils.json_to_sheet(dataSheets,{skipHeader:false});Sheets[dataExport[i].name]=ws;}var wb={SheetNames:SheetNames,Sheets:Sheets};var excelBuffer=XLSX.write(wb,{bookType:'xlsx',type:'array'});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,\"export-charting-\"+moment().format('YYYY-MM-DD_hh:mm:ss')+fileExtension);}};_this.state={hash_id:_this.props.hash_id,curItem:{data_send_time:1,type:2},dataExport:[],dataListDevice:[],dataChartDevice:[],chartToolOption:{},dataParameter:[],dataDevice:[],dataFilter:[{id:\"today\",text:\"Today\"},{id:\"3_day\",text:\"3 days\"},{id:\"this_month\",text:\"This month\"},{id:\"last_month\",text:\"Last month\"},{id:\"12_month\",text:\"Last 12 months\"},{id:\"lifetime\",text:\"Lifetime\"}],chartParams:{id_filter:'today',text_filter:'Today',show_filter:false,max_date:Libs.getCurrentDDMMYYYY(),data_send_time:1}};_this.jsxTemplate=ChartDeviceJsx;_this.wrapperRef=/*#__PURE__*/React.createRef();return _this;}_createClass(ChartDevice,[{key:\"componentDidMount\",value:function componentDidMount(){this.getListDeviceByProject();this.loadConfigDefaultDate();document.addEventListener('click',this.handleClickOutside);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('click',this.handleClickOutside);}},{key:\"loadDataChart\",value:function loadDataChart(){var _this2=this;var _this$state2=this.state,chartParams=_this$state2.chartParams,dataDevice=_this$state2.dataDevice,dataParameter=_this$state2.dataParameter,self=this;if(!Libs.isArrayData(dataDevice)||!Libs.isArrayData(dataParameter))return;var chartToolOption={};var params={};switch(chartParams.id_filter){case'today':params.start_date=Libs.convertAllFormatDate(Libs.dateFormat(chartParams.start_date,\"MM/DD/YYYY\",\"MM/DD/YYYY\")+\" 00:00:00\");params.end_date=Libs.convertAllFormatDate(Libs.dateFormat(chartParams.end_date,\"MM/DD/YYYY\",\"MM/DD/YYYY\")+\" 19:00:00\");break;case'3_day':params.start_date=Libs.dateFormat(chartParams.start_date,\"MM/DD/YYYY\",\"MM/DD/YYYY\")+\" 00:00:00\";params.end_date=Libs.dateFormat(chartParams.end_date,\"MM/DD/YYYY\",\"MM/DD/YYYY\")+\" 19:00:00\";break;case'last_month':case'this_month':params.start_date=Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(),\"DD\",\"MM/DD/YYYY\")+\"/\"+chartParams.start_date+\" 00:00:00\";params.end_date=Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(),\"DD\",\"MM/DD/YYYY\")+\"/\"+chartParams.end_date+\" 19:00:00\";break;case'lifetime':case'12_month':params.start_date=Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(),\"DD\",\"MM/DD/YYYY\")+\"/\"+chartParams.start_date+\" 00:00:00\";params.end_date=Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(),\"DD\",\"MM/DD/YYYY\")+\"/\"+chartParams.end_date+\" 19:00:00\";break;}params.id_language=this.employee.id_language;params.id_employee=this.employee.id_employee;params.dataDevice=dataDevice;params.filterBy=chartParams.id_filter;params.data_send_time=chartParams.data_send_time;var elHeight=document.getElementById('main-chart-view').clientHeight-60;chartToolOption.chart={zoomType:'xy',height:elHeight?elHeight:null};chartToolOption.credits={enabled:false};chartToolOption.exporting={enabled:true};chartToolOption.title={text:null,align:'left'};chartToolOption.xAxis=[];chartToolOption.yAxis=[];chartToolOption.tooltip={shared:true,crosshairs:true};chartToolOption.plotOptions={series:{turboThreshold:5000},column:{stacking:'normal'}};chartToolOption.series=[];var tickInterval=24;switch(chartParams.id_filter){case'today':if(chartParams.data_send_time==1){tickInterval=24;}else if(chartParams.data_send_time==2){tickInterval=12;}else if(chartParams.data_send_time==3){tickInterval=2;}break;case'3_day':if(chartParams.data_send_time==1){tickInterval=168;}else if(chartParams.data_send_time==2){tickInterval=57;}else if(chartParams.data_send_time==3){tickInterval=15;}break;case'last_month':case'this_month':tickInterval=4;break;case'lifetime':case'12_month':tickInterval=1;break;}var paramerter=[];for(var j=0,leng=dataParameter.length;j<leng;j++){var childs=dataParameter[j].dataParameter;if(!Libs.isArrayData(childs))return;var dataChildTmp=childs.filter(function(item){return item.is_checked==1;});if(Libs.isArrayData(dataChildTmp)){paramerter.push.apply(paramerter,_toConsumableArray(dataChildTmp));}}if(!Libs.isArrayData(paramerter))return;params.type='customer';AnalyticsService.instance.getChartByListDevice(params,function(data,total_row){if(Libs.isArrayData(data)){var categories=[],series=[],yAxis=[];var yAxisUnit=[];for(var i=0;i<paramerter.length;i++){if(i===0){yAxisUnit.push(paramerter[i]);yAxis.push({gridLineWidth:1,lineWidth:1,labels:{enabled:true},title:{text:!Libs.isBlank(paramerter[i].unit)?paramerter[i].unit:'',enabled:true},opposite:false});}else{var findyAxisUnit=Libs.find(yAxisUnit,'unit',paramerter[i].unit);if(Libs.isObjectEmpty(findyAxisUnit)){yAxisUnit.push(paramerter[i]);yAxis.push({gridLineWidth:1,lineWidth:1,labels:{enabled:true},title:{text:!Libs.isBlank(paramerter[i].unit)?paramerter[i].unit:'',enabled:true},opposite:true});}}var idyAxis=0;if(Libs.isArrayData(yAxisUnit)){yAxisUnit.map(function(h,index){if(paramerter[i].unit==h.unit){idyAxis=index;}});}for(var k=0,lenk=data.length;k<lenk;k++){var seriesItem={name:data[k].device_name+\" - \"+paramerter[i].name,type:'spline',yAxis:idyAxis,tooltip:{valueSuffix:' '+(!Libs.isBlank(paramerter[i].unit)?paramerter[i].unit:'')},data:[],gridLineWidth:1,lineWidth:1,marker:{radius:1.5,enabled:false}};var dataRow=data[k].data;var itemData=[];for(var _j=0;_j<dataRow.length;_j++){// generate series\nvar value=!Libs.isBlank(dataRow[_j][paramerter[i].slug])&&dataRow[_j][paramerter[i].slug]>0?dataRow[_j][paramerter[i].slug]:null;itemData.push([dataRow[_j].time_full,value]);categories.push(dataRow[_j].categories_time);}seriesItem.data=itemData;series.push(seriesItem);}}if(Libs.isArrayData(categories)&&Libs.isArrayData(series)&&Libs.isArrayData(yAxis)){chartToolOption.xAxis=[{categories:categories,alignTicks:true,tickInterval:tickInterval}];chartToolOption.series=series;chartToolOption.yAxis=yAxis;_this2.setState({chartToolOption:chartToolOption,dataChartDevice:data,dataExport:data});}}else{self.setState({chartToolOption:{},dataChartDevice:[],dataExport:[]});}});}},{key:\"loadConfigDefaultDate\",value:function loadConfigDefaultDate(){var chartParams=this.state.chartParams;switch(chartParams.id_filter){case'today':chartParams.max_date=Libs.getCurrentMMDDYYYYHI();chartParams.end_date=Libs.getCurrentMMDDYYYYHI();break;case'3_day':chartParams.end_date=Libs.getCurrentDDMMYYYY();chartParams.start_date=moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(),-2)).format('DD/MM/YYYY');chartParams.start_max_date=moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(),-2)).format('DD/MM/YYYY');break;case'this_month':chartParams.max_date=moment().format('MM/YYYY');chartParams.end_date=moment().format('MM/YYYY');break;case'last_month':chartParams.max_date=moment().format('MM/YYYY');var tlast=new Date(Libs.getCurrentMMDDYYYYHI());var ylast=tlast.getFullYear(),mlast=tlast.getMonth();chartParams.end_date=moment(Libs.addMonths(new Date(ylast,mlast,1),-1)).endOf('month').format('MM/YYYY');chartParams.start_date=moment(Libs.addMonths(new Date(ylast,mlast,1),-1)).format('MM/YYYY');break;case'lifetime':case'12_month':chartParams.max_date=moment().format('MM/YYYY');chartParams.end_date=moment().format('MM/YYYY');var tlast=new Date(Libs.getCurrentMMDDYYYYHI());var ylast=tlast.getFullYear(),mlast=tlast.getMonth();chartParams.start_date=moment(Libs.addMonths(new Date(ylast,mlast,1),-12)).format('MM/YYYY');chartParams.max_start_date=moment(Libs.addMonths(Libs.getCurrentMMDDYYYYHI(),-12)).format('MM/YYYY');break;}this.setState({chartParams:chartParams});}},{key:\"handleInputDateChange\",value:/**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */function handleInputDateChange(event){var target=event.target;var name=target.name;var self=this;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var chartParams=this.state.chartParams;switch(chartParams.id_filter){case'today':case'last_month':case'this_month':chartParams.start_date=value;chartParams[name]=value;break;case'3_day':if(name=='start_date'){chartParams.start_date=value;var arrDate=value.split('/');if(arrDate){var currentDate=arrDate[2]+'/'+arrDate[1]+\"/\"+arrDate[0];chartParams.end_date=moment(Libs.addDays(currentDate,2)).format('DD/MM/YYYY');}}if(name=='end_date'){chartParams.end_date=value;var _arrDate=value.split('/');if(_arrDate){var _currentDate=_arrDate[2]+'/'+_arrDate[1]+\"/\"+_arrDate[0];chartParams.start_date=moment(Libs.addDays(_currentDate,-2)).format('DD/MM/YYYY');}}break;case'12_month':if(name=='start_date'){chartParams.start_date=value;var _arrDate2=value.split('/');if(_arrDate2){var _currentDate2=_arrDate2[1]+'/'+_arrDate2[0]+'/01';var startOfMonth=moment(_currentDate2).startOf('month').format('YYYY-MM-DD');chartParams.end_date=moment(Libs.addMonths(startOfMonth,12)).format('MM/YYYY');}}if(name=='end_date'){chartParams.end_date=value;var _arrDate3=value.split('/');if(_arrDate3){var _currentDate3=_arrDate3[1]+'/'+_arrDate3[0]+'/01';var _startOfMonth=moment(_currentDate3).startOf('month').format('YYYY-MM-DD');chartParams.start_date=moment(Libs.addMonths(_startOfMonth,-12)).format('MM/YYYY');}}break;}self.setState({chartParams:chartParams});self.loadDataChart();}}},{key:\"getListDeviceByProject\",value:/**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */function getListDeviceByProject(){var self=this;var params={hash_id:this.state.hash_id,id_employee:this.employee.id_employee,id_language:this.employee.id_language};AnalyticsService.instance.getListDeviceByProject(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataListDevice:data});}else{self.setState({dataListDevice:[]});}self.forceUpdate();});}},{key:\"render\",value:function render(){return this.jsxTemplate.call(this);}}]);return ChartDevice;}(BaseComponent);var HighOrderComponentTranslated=withTranslation('common')(ChartDevice);export default HighOrderComponentTranslated;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModuleProject/Analytics/ChartDevice/ChartDevice.js"],"names":["React","ChartDeviceJsx","BaseComponent","Libs","withTranslation","AnalyticsService","FileSaver","XLSX","moment","ChartDevice","props","context","callBackLoadChart","dataDevice","dataParameter","self","isArrayData","setState","loadDataChart","changeViewMinute","value","chartParams","state","isBlank","data_send_time","handleClickOutside","event","target","wrapperRef","current","contains","show_filter","onClickFilter","dataFilter","curItem","item","find","isObjectEmpty","id_filter","id","text_filter","text","showNextBtn","end_date","getCurrentMMDDYYYYHI","max_date","getCurrentDDMMYYYY","start_date","addDays","format","start_max_date","tlast","Date","ylast","getFullYear","mlast","getMonth","addMonths","endOf","onClickShowFilter","downloadData","dataExport","SheetNames","Sheets","fileType","fileExtension","i","length","push","name","dataSheets","dataRows","data","map","index","ws","utils","json_to_sheet","skipHeader","wb","excelBuffer","write","bookType","type","Blob","saveAs","hash_id","dataListDevice","dataChartDevice","chartToolOption","jsxTemplate","createRef","getListDeviceByProject","loadConfigDefaultDate","document","addEventListener","removeEventListener","params","convertAllFormatDate","dateFormat","id_language","employee","id_employee","filterBy","elHeight","getElementById","clientHeight","chart","zoomType","height","credits","enabled","exporting","title","align","xAxis","yAxis","tooltip","shared","crosshairs","plotOptions","series","turboThreshold","column","stacking","tickInterval","paramerter","j","leng","childs","dataChildTmp","filter","is_checked","instance","getChartByListDevice","total_row","categories","yAxisUnit","gridLineWidth","lineWidth","labels","unit","opposite","findyAxisUnit","idyAxis","h","k","lenk","seriesItem","device_name","valueSuffix","marker","radius","dataRow","itemData","slug","time_full","categories_time","alignTicks","max_start_date","checked","arrDate","split","currentDate","startOfMonth","startOf","forceUpdate","call","HighOrderComponentTranslated"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ChartDeviceJsx from './ChartDevice.jsx';\nimport BaseComponent from '../../../../../BaseComponent';\nimport Libs from '../../../../../../utils/Libs';\nimport { withTranslation } from 'react-i18next';\nimport AnalyticsService from '../../../../../../services/AnalyticsService';\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport moment from 'moment';\n\nclass ChartDevice extends BaseComponent {\n    constructor(props, context) {\n        super(props, context);\n\n        this.state = {\n            hash_id: this.props.hash_id,\n            curItem: {\n                data_send_time: 1,\n                type: 2\n            },\n            dataExport: [],\n            dataListDevice: [],\n            dataChartDevice: [],\n            chartToolOption: {},\n            dataParameter: [],\n            dataDevice: [],\n            dataFilter: [\n                { id: \"today\", text: \"Today\" },\n                { id: \"3_day\", text: \"3 days\" },\n                { id: \"this_month\", text: \"This month\" },\n                { id: \"last_month\", text: \"Last month\" },\n                { id: \"12_month\", text: \"Last 12 months\" },\n                { id: \"lifetime\", text: \"Lifetime\" }\n            ],\n\n            chartParams: {\n                id_filter: 'today',\n                text_filter: 'Today',\n                show_filter: false,\n                max_date: Libs.getCurrentDDMMYYYY(),\n                data_send_time: 1\n            },\n        };\n\n        this.jsxTemplate = ChartDeviceJsx;\n        this.wrapperRef = React.createRef();\n\n    }\n\n    componentDidMount() {\n        this.getListDeviceByProject();\n        this.loadConfigDefaultDate();\n        document.addEventListener('click', this.handleClickOutside);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.handleClickOutside)\n    }\n\n\n    callBackLoadChart = (dataDevice, dataParameter) => {\n        var self = this;\n        if (!Libs.isArrayData(dataDevice) || !Libs.isArrayData(dataParameter)) return;\n        this.setState({\n            dataDevice: dataDevice,\n            dataParameter: dataParameter\n        }, () => {\n            self.loadDataChart();\n        })\n\n    }\n\n\n    loadDataChart() {\n        var { chartParams, dataDevice, dataParameter } = this.state, self = this;\n        if (!Libs.isArrayData(dataDevice) || !Libs.isArrayData(dataParameter)) return;\n        var chartToolOption = {};\n        var params = {};\n        switch (chartParams.id_filter) {\n            case 'today':\n                params.start_date = Libs.convertAllFormatDate(Libs.dateFormat(chartParams.start_date, \"MM/DD/YYYY\", \"MM/DD/YYYY\") + \" 00:00:00\");\n                params.end_date = Libs.convertAllFormatDate(Libs.dateFormat(chartParams.end_date, \"MM/DD/YYYY\", \"MM/DD/YYYY\") + \" 19:00:00\");\n                break;\n            case '3_day':\n                params.start_date = Libs.dateFormat(chartParams.start_date, \"MM/DD/YYYY\", \"MM/DD/YYYY\") + \" 00:00:00\";\n                params.end_date = Libs.dateFormat(chartParams.end_date, \"MM/DD/YYYY\", \"MM/DD/YYYY\") + \" 19:00:00\";\n                break;\n            case 'last_month':\n            case 'this_month':\n                params.start_date = Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(), \"DD\", \"MM/DD/YYYY\") + \"/\" + chartParams.start_date + \" 00:00:00\";\n                params.end_date = Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(), \"DD\", \"MM/DD/YYYY\") + \"/\" + chartParams.end_date + \" 19:00:00\";\n                break;\n            case 'lifetime':\n            case '12_month':\n                params.start_date = Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(), \"DD\", \"MM/DD/YYYY\") + \"/\" + chartParams.start_date + \" 00:00:00\";\n                params.end_date = Libs.dateFormat(Libs.getCurrentMMDDYYYYHI(), \"DD\", \"MM/DD/YYYY\") + \"/\" + chartParams.end_date + \" 19:00:00\";\n                break;\n        }\n\n\n\n        params.id_language = this.employee.id_language;\n        params.id_employee = this.employee.id_employee;\n        params.dataDevice = dataDevice;\n        params.filterBy = chartParams.id_filter;\n        params.data_send_time = chartParams.data_send_time;\n\n        let elHeight = (document.getElementById('main-chart-view').clientHeight) - 60;\n\n        chartToolOption.chart = { zoomType: 'xy', height: elHeight ? elHeight : null };\n        chartToolOption.credits = { enabled: false };\n        chartToolOption.exporting = { enabled: true };\n        chartToolOption.title = {\n            text: null,\n            align: 'left'\n        };\n        chartToolOption.xAxis = [];\n        chartToolOption.yAxis = [];\n        chartToolOption.tooltip = {\n            shared: true,\n            crosshairs: true\n        };\n        chartToolOption.plotOptions = {\n            series: {\n                turboThreshold: 5000\n            },\n            column: {\n                stacking: 'normal'\n            }\n        };\n        chartToolOption.series = [];\n        var tickInterval = 24;\n        switch (chartParams.id_filter) {\n            case 'today':\n                if (chartParams.data_send_time == 1) {\n                    tickInterval = 24;\n                } else if (chartParams.data_send_time == 2) {\n                    tickInterval = 12;\n                } else if (chartParams.data_send_time == 3) {\n                    tickInterval = 2;\n                }\n\n                break;\n            case '3_day':\n                if (chartParams.data_send_time == 1) {\n                    tickInterval = 168;\n                } else if (chartParams.data_send_time == 2) {\n                    tickInterval = 57;\n                } else if (chartParams.data_send_time == 3) {\n                    tickInterval = 15;\n                }\n                break;\n            case 'last_month':\n            case 'this_month':\n                tickInterval = 4;\n                break;\n            case 'lifetime':\n            case '12_month':\n                tickInterval = 1;\n                break;\n        }\n\n        var paramerter = [];\n        for (var j = 0, leng = dataParameter.length; j < leng; j++) {\n            var childs = dataParameter[j].dataParameter;\n            if (!Libs.isArrayData(childs)) return;\n            var dataChildTmp = childs.filter((item) => item.is_checked == 1);\n            if (Libs.isArrayData(dataChildTmp)) {\n                paramerter.push(...dataChildTmp);\n            }\n        }\n        if (!Libs.isArrayData(paramerter)) return;\n        params.type = 'customer';\n        \n        AnalyticsService.instance.getChartByListDevice(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                var categories = [], series = [], yAxis = [];\n                var yAxisUnit = [];\n                for (var i = 0; i < paramerter.length; i++) {\n                    if (i === 0) {\n                        yAxisUnit.push(paramerter[i]);\n                        yAxis.push({\n                            gridLineWidth: 1,\n                            lineWidth: 1,\n                            labels: {\n                                enabled: true\n                            },\n                            title: {\n                                text: (!Libs.isBlank(paramerter[i].unit) ? paramerter[i].unit : ''),\n                                enabled: true\n                            },\n                            opposite: false\n                        });\n                    } else {\n                        var findyAxisUnit = Libs.find(yAxisUnit, 'unit', paramerter[i].unit);\n                        if (Libs.isObjectEmpty(findyAxisUnit)) {\n                            yAxisUnit.push(paramerter[i]);\n                            yAxis.push({\n                                gridLineWidth: 1,\n                                lineWidth: 1,\n                                labels: {\n                                    enabled: true\n                                },\n                                title: {\n                                    text: (!Libs.isBlank(paramerter[i].unit) ? paramerter[i].unit : ''),\n                                    enabled: true\n                                },\n                                opposite: true\n                            });\n                        }\n                    }\n\n                    var idyAxis = 0;\n\n                    if (Libs.isArrayData(yAxisUnit)) {\n                        yAxisUnit.map((h, index) => {\n                            if (paramerter[i].unit == h.unit) {\n                                idyAxis = index;\n                            }\n                        })\n                    }\n\n                    for (let k = 0, lenk = data.length; k < lenk; k++) {\n                        var seriesItem = {\n                            name: data[k].device_name + \" - \" + paramerter[i].name,\n                            type: 'spline',\n                            yAxis: idyAxis,\n                            tooltip: {\n                                valueSuffix: ' ' + (!Libs.isBlank(paramerter[i].unit) ? paramerter[i].unit : '')\n                            },\n                            data: [],\n                            gridLineWidth: 1,\n                            lineWidth: 1,\n                            marker: {\n                                radius: 1.5,\n                                enabled: false\n                            }\n                        };\n\n                        var dataRow = data[k].data;\n                        var itemData = [];\n                        for (let j = 0; j < dataRow.length; j++) {\n                            // generate series\n                            var value = (!Libs.isBlank(dataRow[j][paramerter[i].slug]) && dataRow[j][paramerter[i].slug] > 0) ? dataRow[j][paramerter[i].slug] : null;\n                            itemData.push([dataRow[j].time_full, value]);\n                            categories.push(dataRow[j].categories_time);\n                        }\n\n                        seriesItem.data = itemData;\n                        series.push(seriesItem);\n                    }\n                }\n\n                if (Libs.isArrayData(categories) && Libs.isArrayData(series) && Libs.isArrayData(yAxis)) {\n                    chartToolOption.xAxis = [\n                        {\n                            categories: categories,\n                            alignTicks: true,\n                            tickInterval: tickInterval\n                        }\n                    ];\n                    chartToolOption.series = series;\n                    chartToolOption.yAxis = yAxis;\n\n                    this.setState({\n                        chartToolOption: chartToolOption,\n                        dataChartDevice: data,\n                        dataExport: data\n                    })\n                }\n            } else {\n                self.setState({\n                    chartToolOption: {},\n                    dataChartDevice: [],\n                    dataExport: []\n                });\n            }\n        });\n    }\n\n\n    changeViewMinute = (value) => {\n        var chartParams = this.state.chartParams, self = this;\n        if (Libs.isBlank(value)) return;\n        chartParams.data_send_time = value;\n        this.setState({ chartParams: chartParams }, () => {\n            self.loadDataChart();\n        });\n    }\n\n    handleClickOutside = (event) => {\n        const { target } = event;\n        var { chartParams } = this.state, self = this;\n        if (!this.wrapperRef.current.contains(target)) {\n            if (chartParams.show_filter) {\n                chartParams.show_filter = false;\n                self.setState({\n                    chartParams: chartParams\n                })\n            }\n        }\n    }\n\n    loadConfigDefaultDate() {\n        var { chartParams } = this.state;\n        switch (chartParams.id_filter) {\n            case 'today':\n                chartParams.max_date = Libs.getCurrentMMDDYYYYHI();\n                chartParams.end_date = Libs.getCurrentMMDDYYYYHI();\n                break;\n            case '3_day':\n                chartParams.end_date = Libs.getCurrentDDMMYYYY();\n                chartParams.start_date = moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(), -2)).format('DD/MM/YYYY');\n                chartParams.start_max_date = moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(), -2)).format('DD/MM/YYYY');\n                break;\n            case 'this_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                chartParams.end_date = moment().format('MM/YYYY');\n                break;\n            case 'last_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                var tlast = new Date(Libs.getCurrentMMDDYYYYHI());\n                var ylast = tlast.getFullYear(), mlast = tlast.getMonth();\n                chartParams.end_date = moment(Libs.addMonths(new Date(ylast, mlast, 1), -1)).endOf('month').format('MM/YYYY');\n                chartParams.start_date = moment(Libs.addMonths(new Date(ylast, mlast, 1), -1)).format('MM/YYYY');\n\n                break;\n            case 'lifetime':\n            case '12_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                chartParams.end_date = moment().format('MM/YYYY');\n                var tlast = new Date(Libs.getCurrentMMDDYYYYHI());\n                var ylast = tlast.getFullYear(), mlast = tlast.getMonth();\n                chartParams.start_date = moment(Libs.addMonths(new Date(ylast, mlast, 1), -12)).format('MM/YYYY');\n                chartParams.max_start_date = moment(Libs.addMonths(Libs.getCurrentMMDDYYYYHI(), -12)).format('MM/YYYY');\n                break;\n        }\n        this.setState({\n            chartParams: chartParams\n        })\n    }\n\n    onClickFilter = (value) => {\n        var { chartParams, dataFilter, curItem } = this.state;\n        var self = this;\n        if (!Libs.isArrayData(dataFilter)) return;\n        var item = Libs.find(dataFilter, 'id', value);\n        if (Libs.isObjectEmpty(item)) return;\n\n        chartParams.id_filter = item.id;\n        chartParams.text_filter = item.text;\n        chartParams.show_filter = false;\n        chartParams.showNextBtn = false;\n\n        switch (value) {\n            case 'today':\n                chartParams.end_date = Libs.getCurrentMMDDYYYYHI();\n                chartParams.max_date = Libs.getCurrentMMDDYYYYHI();\n                break;\n            case '3_day':\n                chartParams.end_date = Libs.getCurrentDDMMYYYY();\n                chartParams.start_date = moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(), -2)).format('DD/MM/YYYY');\n                chartParams.start_max_date = moment(Libs.addDays(Libs.getCurrentMMDDYYYYHI(), -2)).format('DD/MM/YYYY');\n                chartParams.max_date = Libs.getCurrentDDMMYYYY();\n                break;\n\n            case 'this_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                chartParams.end_date = moment().format('MM/YYYY');\n                break;\n            case 'last_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                var tlast = new Date(Libs.getCurrentMMDDYYYYHI());\n                var ylast = tlast.getFullYear(), mlast = tlast.getMonth();\n                chartParams.end_date = moment(Libs.addMonths(new Date(ylast, mlast, 1), -1)).endOf('month').format('MM/YYYY');\n                chartParams.start_date = moment(Libs.addMonths(new Date(ylast, mlast, 1), -1)).format('MM/YYYY');\n                break;\n\n            case 'lifetime':\n            case '12_month':\n                chartParams.max_date = moment().format('MM/YYYY');\n                chartParams.end_date = moment().format('MM/YYYY');\n                chartParams.start_date = moment(Libs.addMonths(Libs.getCurrentMMDDYYYYHI(), -12)).format('MM/YYYY');\n\n                break;\n            // case 'lifetime':\n            //     chartParams.start_date = moment(curItem.commissioning).format('MM/DD/YYYY HH:mm:ss');\n            //     chartParams.end_date = Libs.getCurrentMMDDYYYYHI();\n            //     break;\n        }\n\n        this.setState({\n            chartParams: chartParams\n        }, () => {\n            self.loadDataChart();\n        });\n    }\n\n    /**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */\n    handleInputDateChange(event) {\n        let target = event.target;\n        let name = target.name;\n        var self = this;\n        let value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n\n        if (name) {\n            let { chartParams } = this.state;\n            switch (chartParams.id_filter) {\n                case 'today':\n                case 'last_month':\n                case 'this_month':\n                    chartParams.start_date = value;\n                    chartParams[name] = value;\n                    break;\n                case '3_day':\n                    if (name == 'start_date') {\n                        chartParams.start_date = value;\n                        let arrDate = value.split('/');\n                        if (arrDate) {\n                            let currentDate = arrDate[2] + '/' + arrDate[1] + \"/\" + arrDate[0];\n                            chartParams.end_date = moment(Libs.addDays(currentDate, 2)).format('DD/MM/YYYY');\n                        }\n                    }\n\n                    if (name == 'end_date') {\n                        chartParams.end_date = value;\n                        let arrDate = value.split('/');\n                        if (arrDate) {\n                            let currentDate = arrDate[2] + '/' + arrDate[1] + \"/\" + arrDate[0];\n                            chartParams.start_date = moment(Libs.addDays(currentDate, -2)).format('DD/MM/YYYY');\n                        }\n                    }\n\n                    break;\n                case '12_month':\n                    if (name == 'start_date') {\n                        chartParams.start_date = value;\n                        let arrDate = value.split('/');\n                        if (arrDate) {\n                            let currentDate = arrDate[1] + '/' + arrDate[0] + '/01';\n                            const startOfMonth = moment(currentDate).startOf('month').format('YYYY-MM-DD');\n                            chartParams.end_date = moment(Libs.addMonths(startOfMonth, 12)).format('MM/YYYY');\n                        }\n                    }\n\n                    if (name == 'end_date') {\n                        chartParams.end_date = value;\n                        let arrDate = value.split('/');\n                        if (arrDate) {\n                            let currentDate = arrDate[1] + '/' + arrDate[0] + '/01';\n                            const startOfMonth = moment(currentDate).startOf('month').format('YYYY-MM-DD');\n                            chartParams.start_date = moment(Libs.addMonths(startOfMonth, -12)).format('MM/YYYY');\n                        }\n                    }\n                    break;\n            }\n\n            self.setState({\n                chartParams: chartParams\n            });\n            self.loadDataChart();\n        }\n    }\n\n\n\n    onClickShowFilter = () => {\n        var { chartParams } = this.state;\n        chartParams.show_filter = true;\n        this.setState({\n            chartParams: chartParams\n        });\n    }\n\n    /**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */\n    getListDeviceByProject() {\n        let self = this;\n        let params = {\n            hash_id: this.state.hash_id,\n            id_employee: this.employee.id_employee,\n            id_language: this.employee.id_language\n        };\n\n        AnalyticsService.instance.getListDeviceByProject(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataListDevice: data\n                });\n            } else {\n                self.setState({\n                    dataListDevice: []\n                });\n            }\n            self.forceUpdate();\n        });\n    }\n\n\n\n    downloadData = () => {\n        var { dataExport } = this.state;\n        if (Libs.isArrayData(dataExport)) {\n            var SheetNames = [], Sheets = {};\n            const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n            const fileExtension = '.xlsx';\n            for (var i = 0; i < dataExport.length; i++) {\n                SheetNames.push(dataExport[i].name);\n                var dataSheets = [];\n                var dataRows = dataExport[i].data;\n                if(Libs.isArrayData(dataRows)){\n                    dataRows.map((item, index) => {\n                        dataSheets.push(item);\n                    })\n                }\n                const ws = XLSX.utils.json_to_sheet(dataSheets, { skipHeader: false });\n                Sheets[dataExport[i].name] = ws;\n            }\n\n            const wb = {\n              SheetNames: SheetNames,\n              Sheets: Sheets\n            };\n            const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\n            const data = new Blob([excelBuffer], { type: fileType });\n            FileSaver.saveAs(data, \"export-charting-\" + moment().format('YYYY-MM-DD_hh:mm:ss') + fileExtension);\n        }\n    }\n    \n\n    render() {\n        return this.jsxTemplate.call(this)\n    }\n}\n\nconst HighOrderComponentTranslated = withTranslation('common')(ChartDevice)\nexport default HighOrderComponentTranslated;"]},"metadata":{},"sourceType":"module"}