{"ast":null,"code":"import BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport ControlCalendarJsx from './ControlCalendar.jsx';\nimport MainDeviceService from '../../../../../services/MainDeviceService';\nimport ControlCalendarValidate from './ControlCalendarValidate';\nimport moment from 'moment';\nimport Constants from '../../../../../utils/Constants';\n\nclass ControlCalendar extends BaseComponent {\n  constructor(props) {\n    super(props);\n\n    this.onSelectEvent = event => {\n      console.log(event);\n    };\n\n    this.state = {\n      curItem: this.props.curItem,\n      searchParam: {\n        date_from: moment().format(\"DD/MM/YYYY HH:mm\"),\n        min_date: moment().format(\"DD/MM/YYYY HH:mm\")\n      },\n      eventsList: [// {\n        //     'title': '',\n        //     'start': new Date(\"2022-02-27 15:38:00\"),\n        //     'end': new Date(\"2022-02-27 16:43:00\"),\n        //     desc: ''\n        // },\n        // {\n        //     'title': 'All Day Event very long title',\n        //     'start': new Date(2022, 1, 22, 17, 0, 0, 0),\n        //     'end': new Date(2022, 1, 24, 23, 30, 0, 0),\n        // },\n        // {\n        //     'title': '17h - 19h',\n        //     'start': new Date(2022, 1, 22, 17, 0, 0, 0),\n        //     'end': new Date(2022, 1, 22, 19, 0, 0, 0),\n        // },\n      ] // dataDeviceType: [],\n      // dataList: [],\n      // show_tab: this.props.show_tab,\n      // dataDeviceHardware: []\n\n    };\n    this.jsxTemplate = ControlCalendarJsx;\n  }\n  /**\n   * @description Called immediately after the component is mounted in the DOM. Called after the render function\n   * @author Long.Pham 12/09/2021\n   */\n\n\n  componentDidMount() {\n    this.getListControlCalendar();\n  }\n\n  /**\n       * get list\n       * @author Long.Pham 2019-06-03\n       */\n  getListControlCalendar() {\n    let self = this;\n    var {\n      curItem\n    } = this.state;\n    let params = Object.assign({}, curItem);\n    params.id_device = curItem.id;\n    var eventsList = [];\n    MainDeviceService.instance.getListControlCalendar(params, (data, total_row) => {\n      console.log(data);\n\n      if (Libs.isArrayData(data)) {\n        data.map((item, index) => {\n          eventsList.push({\n            'title': item.title,\n            'start': new Date(item.start),\n            'end': new Date(item.end),\n            'index': index,\n            'id': item.id,\n            'id_device': item.id_device\n          });\n        });\n        self.setState({\n          eventsList: eventsList\n        });\n      } else {\n        self.setState({\n          eventsList: []\n        });\n      }\n    });\n  }\n  /**\n   * setValue method to Input\n   * @author Long.Pham 20/05/2021\n   */\n\n\n  handleInputDateChange(event) {\n    let target = event.target;\n    let name = target.name;\n    let value = target.value;\n\n    if (target.type === 'checkbox') {\n      value = target.checked ? 1 : 0;\n    }\n\n    if (name) {\n      let {\n        searchParam\n      } = this.state;\n      searchParam[name] = value;\n\n      if (name == 'date_from') {\n        searchParam.date_to = moment(Libs.dateFormat(value, 'YYYY-MM-DD HH:mm:ss', 'DD/MM/YYYY HH:mm')).add(2, 'hours').format('DD/MM/YYYY HH:mm');\n      }\n\n      this.setState({\n        searchParam\n      });\n    }\n  } // handleSlotSelect = slotInfo => {\n  //     console.log(\"slotInfo: \", slotInfo);\n  //     // if (view === 'month') { // assumes you got 'view' from state\n  //     //   // ... do some date stuff to get _just the date_ from the slotInfo.start\n  //     //   handleNavigate(newDate);\n  //     //   handleViewChange('day');\n  //     // }\n  //     // ... any other slot selection functionality for other views\n  // };\n\n\n  async onClickAddControlCalendarAction() {\n    var {\n      curItem,\n      searchParam\n    } = this.state,\n        self = this;\n    var params = Object.assign({}, searchParam);\n    let v = new ControlCalendarValidate(this.props);\n    let errors = await v.FLValidationAll(params);\n\n    if (errors) {\n      this.setValidateMessage(errors);\n      return;\n    } //remove message validation\n\n\n    this.removeAllValidateMessage();\n    params.screen_mode = Constants.SCREEN_MODE.ADD;\n    if (Libs.isBlank(curItem.id)) return;\n    params.id_device = curItem.id;\n    params.date_from = Libs.dateFormat(searchParam.date_from, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n    params.date_to = Libs.dateFormat(searchParam.date_to, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n    MainDeviceService.instance.saveControlCalendar(params, function (status, data, msg) {\n      if (status) {\n        self.toast(msg, \"info\");\n        searchParam.date_from = null;\n        searchParam.date_to = null;\n        self.setState({\n          searchParam: searchParam\n        });\n      } else if (data) {\n        self.setValidateMessage(data);\n      } else if (!Libs.isBlank(msg)) {\n        self.toast(msg, \"error\");\n      }\n    }, true);\n  }\n  /**\n   * @description validate a field input\n   * @author Long.Pham 12/05/2021\n   * @param {*} event \n   */\n\n\n  async validateOne(event) {\n    let target = event.target;\n    let name = target.name;\n    let value = target.value;\n\n    if (name) {\n      let param = {\n        [name]: value\n      };\n      let v = new ControlCalendarValidate(this.props);\n      let error = await v.validateOne(param, name);\n\n      if (error != null) {\n        this.setValidateMessage(error, true);\n      }\n    }\n  } // onClickShowTab = (index) => {\n  //     this.setState({\n  //         show_tab: index\n  //     })\n  // }\n  // /**\n  //  * @description reload data\n  //  * @author Long.Pham 19/09/2021\n  //  * @param {int} index\n  //  */\n  // reloadLatestData() {\n  //     let self = this;\n  //     self.getDataListHardware();\n  // }\n\n\n}\n\nexport default ControlCalendar;","map":{"version":3,"sources":["/Volumes/Data/sources/solarmon_production/solarmon_frontend/src/containers/views/desktop/ModulePrivate/Device/ControlCalendar.js"],"names":["BaseComponent","Libs","ControlCalendarJsx","MainDeviceService","ControlCalendarValidate","moment","Constants","ControlCalendar","constructor","props","onSelectEvent","event","console","log","state","curItem","searchParam","date_from","format","min_date","eventsList","jsxTemplate","componentDidMount","getListControlCalendar","self","params","Object","assign","id_device","id","instance","data","total_row","isArrayData","map","item","index","push","title","Date","start","end","setState","handleInputDateChange","target","name","value","type","checked","date_to","dateFormat","add","onClickAddControlCalendarAction","v","errors","FLValidationAll","setValidateMessage","removeAllValidateMessage","screen_mode","SCREEN_MODE","ADD","isBlank","saveControlCalendar","status","msg","toast","validateOne","param","error"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport ControlCalendarJsx from './ControlCalendar.jsx';\nimport MainDeviceService from '../../../../../services/MainDeviceService';\n\nimport ControlCalendarValidate from './ControlCalendarValidate';\nimport moment from 'moment';\nimport Constants from '../../../../../utils/Constants';\n\nclass ControlCalendar extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: this.props.curItem,\n            searchParam: {\n                date_from: moment().format(\"DD/MM/YYYY HH:mm\"),\n                min_date: moment().format(\"DD/MM/YYYY HH:mm\"),\n            },\n            eventsList: [\n                // {\n                //     'title': '',\n                //     'start': new Date(\"2022-02-27 15:38:00\"),\n                //     'end': new Date(\"2022-02-27 16:43:00\"),\n                //     desc: ''\n                // },\n\n                // {\n                //     'title': 'All Day Event very long title',\n                //     'start': new Date(2022, 1, 22, 17, 0, 0, 0),\n                //     'end': new Date(2022, 1, 24, 23, 30, 0, 0),\n                // },\n\n                // {\n                //     'title': '17h - 19h',\n                //     'start': new Date(2022, 1, 22, 17, 0, 0, 0),\n                //     'end': new Date(2022, 1, 22, 19, 0, 0, 0),\n                // },\n            ]\n            // dataDeviceType: [],\n            // dataList: [],\n            // show_tab: this.props.show_tab,\n            // dataDeviceHardware: []\n        }\n\n        this.jsxTemplate = ControlCalendarJsx;\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/09/2021\n     */\n    componentDidMount() {\n        this.getListControlCalendar();\n    }\n\n\n    onSelectEvent = (event) => {\n        console.log(event)\n    }\n\n    /**\n         * get list\n         * @author Long.Pham 2019-06-03\n         */\n    getListControlCalendar() {\n        let self = this;\n        var { curItem } = this.state;\n        let params = Object.assign({}, curItem);\n        params.id_device = curItem.id;\n\n        var eventsList = [];\n        MainDeviceService.instance.getListControlCalendar(params, (data, total_row) => {\n            console.log(data);\n            if (Libs.isArrayData(data)) {\n                data.map((item, index) => {\n                    eventsList.push({\n                        'title': item.title,\n                        'start': new Date(item.start),\n                        'end': new Date(item.end),\n                        'index': index,\n                        'id': item.id,\n                        'id_device': item.id_device\n                    }\n                    );\n                })\n                self.setState({\n                    eventsList: eventsList\n                });\n\n            } else {\n                self.setState({\n                    eventsList: []\n                });\n            }\n        });\n    }\n\n    /**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */\n    handleInputDateChange(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n\n        if (name) {\n            let { searchParam } = this.state;\n            searchParam[name] = value;\n\n            if (name == 'date_from') {\n                searchParam.date_to = moment(Libs.dateFormat(value, 'YYYY-MM-DD HH:mm:ss', 'DD/MM/YYYY HH:mm')).add(2, 'hours').format('DD/MM/YYYY HH:mm')\n            }\n            this.setState({ searchParam });\n        }\n    }\n\n\n    // handleSlotSelect = slotInfo => {\n    //     console.log(\"slotInfo: \", slotInfo);\n    //     // if (view === 'month') { // assumes you got 'view' from state\n    //     //   // ... do some date stuff to get _just the date_ from the slotInfo.start\n    //     //   handleNavigate(newDate);\n    //     //   handleViewChange('day');\n    //     // }\n    //     // ... any other slot selection functionality for other views\n    // };\n\n\n    async onClickAddControlCalendarAction() {\n\n        var { curItem, searchParam } = this.state, self = this;\n\n        var params = Object.assign({}, searchParam);\n        let v = new ControlCalendarValidate(this.props);\n        let errors = await v.FLValidationAll(params);\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = Constants.SCREEN_MODE.ADD;\n        if (Libs.isBlank(curItem.id)) return;\n        params.id_device = curItem.id;\n\n        params.date_from = Libs.dateFormat(searchParam.date_from, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n        params.date_to = Libs.dateFormat(searchParam.date_to, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n\n        MainDeviceService.instance.saveControlCalendar(params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                searchParam.date_from = null;\n                searchParam.date_to = null;\n                self.setState({\n                    searchParam: searchParam\n                })\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new ControlCalendarValidate(this.props);\n            let error = await v.validateOne(param, name);\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n\n\n    // onClickShowTab = (index) => {\n    //     this.setState({\n    //         show_tab: index\n    //     })\n    // }\n\n\n\n    // /**\n    //  * @description reload data\n    //  * @author Long.Pham 19/09/2021\n    //  * @param {int} index\n    //  */\n    // reloadLatestData() {\n    //     let self = this;\n    //     self.getDataListHardware();\n    // }\n\n}\nexport default ControlCalendar;"]},"metadata":{},"sourceType":"module"}