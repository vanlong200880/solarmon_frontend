{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../BaseComponent';import Libs from'../../../../utils/Libs';import Constants from'../../../../utils/Constants';import AddChangePasswordJsx from'./AddChangePassword.jsx';import AddChangePasswordValidate from'./AddChangePasswordValidate';import EmployeeService from'../../../../services/EmployeeService';var AddChangePassword=/*#__PURE__*/function(_BaseComponent){_inherits(AddChangePassword,_BaseComponent);var _super=_createSuper(AddChangePassword);function AddChangePassword(props){var _this;_classCallCheck(this,AddChangePassword);_this=_super.call(this,props);_this.state={curItem:{}};_this.jsxTemplate=AddChangePasswordJsx;return _this;}_createClass(AddChangePassword,[{key:\"generatePassword\",value:function generatePassword(){var curItem=this.state.curItem;var password=Libs.generateStrRandom(2,2,2,2);curItem.password=password;curItem.password_confirm=password;this.setState({curItem:curItem});this.setValidateMessage({password:''},true);this.setValidateMessage({password_confirm:''},true);}/**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */},{key:\"validateOne\",value:function(){var _validateOne=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var t,target,name,value,curItem,param,v,error,regexp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:t=this.props.t;target=event.target;name=target.name;value=target.value;curItem=this.state.curItem;if(!name){_context.next=15;break;}param=_defineProperty({},name,value);v=new AddChangePasswordValidate(this.props);_context.next=10;return v.validateOne(param,name);case 10:error=_context.sent;regexp=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/;if(name==='password'){if(value.length<8||regexp.exec(value)===null){error={password:t('employee.password_valid_min_8character')};}else{error={password:''};}}if(name==='password_confirm'&&Libs.isBlank(error.password_confirm)){if(curItem.password!==value){error={password_confirm:t('employee.password_incorrect')};}else{error={password_confirm:''};}}if(error!=null){this.setValidateMessage(error,true);}case 15:case\"end\":return _context.stop();}}},_callee,this);}));function validateOne(_x){return _validateOne.apply(this,arguments);}return validateOne;}()/**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */},{key:\"onSave\",value:function(){var _onSave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var t,curItem,self,params,screenMode,v,errors,regexp,password,password_confirm;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:t=this.props.t;curItem=this.state.curItem,self=this;params=Object.assign({},this.state.curItem);screenMode=Constants.SCREEN_MODE.EDIT;v=new AddChangePasswordValidate(this.props);_context2.next=7;return v.FLValidationAll(params);case 7:errors=_context2.sent;if(!Libs.isBlank(curItem.password)||!Libs.isBlank(curItem.password_confirm)){regexp=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/;password=curItem.password;if(password.length<8||regexp.exec(password)===null){errors=Object.assign(Libs.isObjectEmpty(errors)?{}:errors,{password:t('employee.password_valid_min_8character')});}else{if(!Libs.isObjectEmpty(errors)){delete errors[password];}}password_confirm=curItem.password_confirm;if(password_confirm!==password||Libs.isBlank(curItem.password_confirm)){errors=Object.assign(Libs.isObjectEmpty(errors)?{}:errors,{password_confirm:t('employee.password_incorrect')});}else{if(!Libs.isObjectEmpty(errors)){delete errors[password_confirm];}}}if(!errors){_context2.next=12;break;}this.setValidateMessage(errors);return _context2.abrupt(\"return\");case 12://remove message validation\nthis.removeAllValidateMessage();params.screen_mode=screenMode;params.iso_code=this.employee.iso_code;params.email=this.employee.email;params.password=Libs.SHA3(curItem.password);params.current_password=Libs.SHA3(curItem.current_password);params.id=this.employee.id_employee;delete params.password_confirm;EmployeeService.instance.employeeChangePassword(params,function(status,data,msg){if(status){self.toast(msg,'info');self.props.onCloseChangePassword();}else{if(data){self.setValidateMessage(data);}else{if(!Libs.isBlank(msg)){self.toast(msg,'error');}}}},true);case 21:case\"end\":return _context2.stop();}}},_callee2,this);}));function onSave(){return _onSave.apply(this,arguments);}return onSave;}()}]);return AddChangePassword;}(BaseComponent);export default AddChangePassword;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/Account/AddChangePassword.js"],"names":["BaseComponent","Libs","Constants","AddChangePasswordJsx","AddChangePasswordValidate","EmployeeService","AddChangePassword","props","state","curItem","jsxTemplate","password","generateStrRandom","password_confirm","setState","setValidateMessage","event","t","target","name","value","param","v","validateOne","error","regexp","length","exec","isBlank","self","params","Object","assign","screenMode","SCREEN_MODE","EDIT","FLValidationAll","errors","isObjectEmpty","removeAllValidateMessage","screen_mode","iso_code","employee","email","SHA3","current_password","id","id_employee","instance","employeeChangePassword","status","data","msg","toast","onCloseChangePassword"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../BaseComponent';\nimport Libs from '../../../../utils/Libs';\nimport Constants from '../../../../utils/Constants';\nimport AddChangePasswordJsx from './AddChangePassword.jsx';\nimport AddChangePasswordValidate from './AddChangePasswordValidate';\nimport EmployeeService from '../../../../services/EmployeeService';\n\nclass AddChangePassword extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: {}\n        }\n\n        this.jsxTemplate = AddChangePasswordJsx;\n    }\n\n\n    generatePassword() {\n        var curItem = this.state.curItem;\n        var password = Libs.generateStrRandom(2, 2, 2, 2);\n        curItem.password = password;\n        curItem.password_confirm = password;\n        this.setState({ curItem: curItem });\n        this.setValidateMessage({ password: '' }, true);\n        this.setValidateMessage({ password_confirm: '' }, true);\n    }\n\n\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        var { t } = this.props;\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        var curItem = this.state.curItem;\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new AddChangePasswordValidate(this.props);\n            let error = await v.validateOne(param, name);\n            const regexp = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/;\n            if (name === 'password') {\n                if (value.length < 8 || regexp.exec(value) === null) {\n                    error = { password: t('employee.password_valid_min_8character') };\n                } else {\n                    error = { password: '' };\n                }\n            }\n\n            if (name === 'password_confirm' && Libs.isBlank(error.password_confirm)) {\n                if (curItem.password !== value) {\n                    error = { password_confirm: t('employee.password_incorrect') };\n                } else {\n                    error = { password_confirm: '' };\n                }\n            }\n\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n\n    /**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */\n    async onSave() {\n        var { t } = this.props;\n        var curItem = this.state.curItem, self = this;\n        var params = Object.assign({}, this.state.curItem);\n        var screenMode = Constants.SCREEN_MODE.EDIT;\n        let v = new AddChangePasswordValidate(this.props);\n        let errors = await v.FLValidationAll(params);\n\n        if (!Libs.isBlank(curItem.password) || !Libs.isBlank(curItem.password_confirm)) {\n            const regexp = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/;\n            var password = curItem.password;\n            if (password.length < 8 || regexp.exec(password) === null) {\n                errors = Object.assign(Libs.isObjectEmpty(errors) ? {} : errors, { password: t('employee.password_valid_min_8character') });\n            } else {\n                if (!Libs.isObjectEmpty(errors)) {\n                    delete errors[password];\n                }\n            }\n\n            var password_confirm = curItem.password_confirm;\n            if (password_confirm !== password || Libs.isBlank(curItem.password_confirm)) {\n                errors = Object.assign(Libs.isObjectEmpty(errors) ? {} : errors, { password_confirm: t('employee.password_incorrect') });\n            } else {\n                if (!Libs.isObjectEmpty(errors)) {\n                    delete errors[password_confirm];\n                }\n            }\n        }\n\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = screenMode;\n        params.iso_code = this.employee.iso_code;\n        params.email = this.employee.email;\n        params.password = Libs.SHA3(curItem.password);\n        params.current_password = Libs.SHA3(curItem.current_password);\n        params.id = this.employee.id_employee;\n\n        delete params.password_confirm;\n        EmployeeService.instance.employeeChangePassword(params, (status, data, msg) => {\n            if (status) {\n                self.toast(msg, 'info');\n                self.props.onCloseChangePassword();\n            } else {\n                if (data) {\n                    self.setValidateMessage(data);\n                } else {\n                    if (!Libs.isBlank(msg)) {\n                        self.toast(msg, 'error');\n                    }\n                }\n\n            }\n        }, true);\n    }\n}\nexport default AddChangePassword;"]},"metadata":{},"sourceType":"module"}