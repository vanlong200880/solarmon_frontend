{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../../BaseComponent';import Libs from'../../../../../utils/Libs';import Constants from'../../../../../utils/Constants';import AddPopupJsx from'./AddPopup.jsx';import AddPopupValidate from'./AddPopupValidate';import ErrorService from'../../../../../services/ErrorService';import ErrorTypeService from'../../../../../services/ErrorTypeService';import ErrorLevelService from'../../../../../services/ErrorLevelService';import ErrorStateService from'../../../../../services/ErrorStateService';import DeviceGroupService from'../../../../../services/DeviceGroupService';var AddPopup=/*#__PURE__*/function(_BaseComponent){_inherits(AddPopup,_BaseComponent);var _super=_createSuper(AddPopup);function AddPopup(props){var _this;_classCallCheck(this,AddPopup);_this=_super.call(this,props);_this.handleDropdownChange=function(item,name){var self=_assertThisInitialized(_this);var curItem=self.state.curItem;var t=_this.props.t;if(name==='id_error_type'){if(Libs.isObjectEmpty(item)){curItem.id_error_type='';}else{var value=item.value;curItem[name]=value;self.setValidateMessage({id_error_type:''},true);}}if(name==='id_error_level'){if(Libs.isObjectEmpty(item)){curItem.id_error_level='';}else{var value=item.value;curItem[name]=value;self.setValidateMessage({id_error_level:''},true);}}if(name==='id_error_state'){if(Libs.isObjectEmpty(item)){curItem.id_error_state='';}else{var value=item.value;curItem[name]=value;self.setValidateMessage({id_error_state:''},true);}}if(name==='id_device_group'){if(Libs.isObjectEmpty(item)){curItem.id_device_group='';}else{var value=item.value;curItem[name]=value;self.setValidateMessage({id_device_group:''},true);}}self.setState({curItem:curItem});};_this.onClickShowTab=function(e,tabActive){var curItem=_this.state.curItem;if(Libs.isBlank(tabActive))return;curItem.tabActive=tabActive;_this.setState({curItem:curItem});};_this.handleInputTranslateChange=function(event){var target=event.target;var name=target.name;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var item=_this.state.curItem;var allLanguage=_this.state.allLanguage;var isoCode=name.substr(-2,2),dataMessage=name.substr(0,7),dataDescription=name.substr(0,11),dataSolutions=name.substr(0,9);allLanguage.map(function(language,index){if(isoCode===language.iso_code&&dataMessage==='message'){item.data[index].message=event.target.validity.valid?value:_this.state.curItem.data[index].message;}if(isoCode===language.iso_code&&dataDescription==='description'){item.data[index].description=event.target.validity.valid?value:_this.state.curItem.data[index].description;}if(isoCode===language.iso_code&&dataSolutions==='solutions'){item.data[index].solutions=event.target.validity.valid?value:_this.state.curItem.data[index].solutions;}return 1;});item[name]=event.target.validity.valid?value:_this.state.curItem[name];_this.setState({curItem:item});}};_this.state={curItem:_this.props.curItem,allLanguage:_this.props.allLanguage,dataErrorType:[],dataErrorLevel:[],dataErrorState:[],dataDeviceGroup:[]};_this.jsxTemplate=AddPopupJsx;_this.handleDropdownChange=_this.handleDropdownChange.bind(_assertThisInitialized(_this));return _this;}/**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */_createClass(AddPopup,[{key:\"componentDidMount\",value:function componentDidMount(){var curItem=this.state.curItem;if(Constants.SCREEN_MODE.ADD==curItem.screen_mode){curItem.status=1;}this.getListErrorType();this.getListErrorLevel();this.getListErrorState();this.getListDeviceGroup();this.setState({curItem:curItem});}},{key:\"getListDeviceGroup\",value:/**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */function getListDeviceGroup(){var self=this;var params={id_language:this.employee.id_language};DeviceGroupService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataDeviceGroup:data});}else{self.setState({dataDeviceGroup:[]});}});}/**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */},{key:\"getListErrorState\",value:function getListErrorState(){var self=this;var params={id_language:this.employee.id_language};ErrorStateService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataErrorState:data});}else{self.setState({dataErrorState:[]});}});}/**\n    * ge list error level\n    * @author Long.Pham 2019-06-03\n    */},{key:\"getListErrorLevel\",value:function getListErrorLevel(){var self=this;var params={id_language:this.employee.id_language};ErrorLevelService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataErrorLevel:data});}else{self.setState({dataErrorLevel:[]});}});}/**\n    * ge list error type\n    * @author Long.Pham 2019-06-03\n    */},{key:\"getListErrorType\",value:function getListErrorType(){var self=this;var params={id_language:this.employee.id_language};ErrorTypeService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataErrorType:data});}else{self.setState({dataErrorType:[]});}});}},{key:\"validateOne\",value:/**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */function(){var _validateOne=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var target,name,value,param,v,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:target=event.target;name=target.name;value=target.value;if(!name){_context.next=10;break;}param=_defineProperty({},name,value);v=new AddPopupValidate(this.props);_context.next=8;return v.validateOne(param,name);case 8:error=_context.sent;if(error!=null){this.setValidateMessage(error,true);}case 10:case\"end\":return _context.stop();}}},_callee,this);}));function validateOne(_x){return _validateOne.apply(this,arguments);}return validateOne;}()/**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */},{key:\"onSave\",value:/**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */function(){var _onSave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var curItem,self,params,screenMode,v,errors,itemLanguageDefault;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:curItem=this.state.curItem,self=this;params=Object.assign({},this.state.curItem);screenMode=!Libs.isBlank(curItem.id)?Constants.SCREEN_MODE.EDIT:!Libs.isBlank(this.props.curItem.screen_mode)?this.props.curItem.screen_mode:Constants.SCREEN_MODE.ADD;v=new AddPopupValidate(this.props);_context2.next=6;return v.FLValidationAll(curItem);case 6:errors=_context2.sent;if(!errors){_context2.next=10;break;}this.setValidateMessage(errors);return _context2.abrupt(\"return\");case 10://remove message validation\nthis.removeAllValidateMessage();params.screen_mode=screenMode;params.iso_code_lang=this.employee.lang;params.id_language=this.employee.id_language;params.iso_code=this.employee.iso_code;if(!Libs.isArrayData(params.data)){_context2.next=22;break;}itemLanguageDefault=Libs.find(params.data,'is_default',1);if(itemLanguageDefault){_context2.next=19;break;}return _context2.abrupt(\"return\");case 19:params.data.map(function(item,index){params.data[index].message=item.message===''?itemLanguageDefault.message:item.message;params.data[index].description=item.description===''?itemLanguageDefault.description:item.description;params.data[index].solutions=item.solutions===''?itemLanguageDefault.solutions:item.solutions;return params;});_context2.next=23;break;case 22:return _context2.abrupt(\"return\",false);case 23:ErrorService.instance.save(params,function(status,data,msg){if(status){self.toast(msg,\"info\");self.props.onClickCloseAdd(true);}else if(data){self.setValidateMessage(data);}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);case 24:case\"end\":return _context2.stop();}}},_callee2,this);}));function onSave(){return _onSave.apply(this,arguments);}return onSave;}()}]);return AddPopup;}(BaseComponent);export default AddPopup;","map":{"version":3,"sources":["/Volumes/Data/sources/solarmon_production/solarmon_frontend/src/containers/views/desktop/ModuleSystem/Error/AddPopup.js"],"names":["BaseComponent","Libs","Constants","AddPopupJsx","AddPopupValidate","ErrorService","ErrorTypeService","ErrorLevelService","ErrorStateService","DeviceGroupService","AddPopup","props","handleDropdownChange","item","name","self","curItem","state","t","isObjectEmpty","id_error_type","value","setValidateMessage","id_error_level","id_error_state","id_device_group","setState","onClickShowTab","e","tabActive","isBlank","handleInputTranslateChange","event","target","type","checked","allLanguage","isoCode","substr","dataMessage","dataDescription","dataSolutions","map","language","index","iso_code","data","message","validity","valid","description","solutions","dataErrorType","dataErrorLevel","dataErrorState","dataDeviceGroup","jsxTemplate","bind","SCREEN_MODE","ADD","screen_mode","status","getListErrorType","getListErrorLevel","getListErrorState","getListDeviceGroup","params","id_language","employee","instance","getDropdownList","total_row","isArrayData","param","v","validateOne","error","Object","assign","screenMode","id","EDIT","FLValidationAll","errors","removeAllValidateMessage","iso_code_lang","lang","itemLanguageDefault","find","save","msg","toast","onClickCloseAdd"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport Constants from '../../../../../utils/Constants';\nimport AddPopupJsx from './AddPopup.jsx';\nimport AddPopupValidate from './AddPopupValidate';\nimport ErrorService from '../../../../../services/ErrorService';\nimport ErrorTypeService from '../../../../../services/ErrorTypeService';\nimport ErrorLevelService from '../../../../../services/ErrorLevelService';\nimport ErrorStateService from '../../../../../services/ErrorStateService';\nimport DeviceGroupService from '../../../../../services/DeviceGroupService';\n\nclass AddPopup extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: this.props.curItem,\n            allLanguage: this.props.allLanguage,\n            dataErrorType: [],\n            dataErrorLevel: [],\n            dataErrorState: [],\n            dataDeviceGroup: []\n        }\n\n        this.jsxTemplate = AddPopupJsx;\n        this.handleDropdownChange = this.handleDropdownChange.bind(this);\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */\n    componentDidMount() {\n        var { curItem } = this.state;\n        if(Constants.SCREEN_MODE.ADD == curItem.screen_mode){\n            curItem.status = 1;\n        }\n        this.getListErrorType();\n        this.getListErrorLevel();\n        this.getListErrorState();\n        this.getListDeviceGroup();\n        this.setState({\n            curItem: curItem\n        })\n    }\n\n    handleDropdownChange = (item, name) => {\n        var self = this;\n        let curItem = self.state.curItem;\n        var { t } = this.props;\n\n        if (name === 'id_error_type') {\n            if (Libs.isObjectEmpty(item)) {\n                curItem.id_error_type = '';\n            } else {\n                var value = item.value;\n                curItem[name] = value;\n                self.setValidateMessage({ id_error_type: '' }, true);\n            }\n        }\n\n        if (name === 'id_error_level') {\n            if (Libs.isObjectEmpty(item)) {\n                curItem.id_error_level = '';\n            } else {\n                var value = item.value;\n                curItem[name] = value;\n                self.setValidateMessage({ id_error_level: '' }, true);\n            }\n        }\n        if (name === 'id_error_state') {\n            if (Libs.isObjectEmpty(item)) {\n                curItem.id_error_state = '';\n            } else {\n                var value = item.value;\n                curItem[name] = value;\n                self.setValidateMessage({ id_error_state: '' }, true);\n            }\n        }\n\n        if (name === 'id_device_group') {\n            if (Libs.isObjectEmpty(item)) {\n                curItem.id_device_group = '';\n            } else {\n                var value = item.value;\n                curItem[name] = value;\n                self.setValidateMessage({ id_device_group: '' }, true);\n            }\n        }\n\n        self.setState({\n            curItem: curItem\n        });\n    }\n\n\n     /**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */\n      getListDeviceGroup() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        DeviceGroupService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataDeviceGroup: data\n                });\n            } else {\n                self.setState({\n                    dataDeviceGroup: []\n                });\n            }\n        })\n    }\n\n    /**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */\n     getListErrorState() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        ErrorStateService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataErrorState: data\n                });\n            } else {\n                self.setState({\n                    dataErrorState: []\n                });\n            }\n        })\n    }\n\n     /**\n    * ge list error level\n    * @author Long.Pham 2019-06-03\n    */\n      getListErrorLevel() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        ErrorLevelService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataErrorLevel: data\n                });\n            } else {\n                self.setState({\n                    dataErrorLevel: []\n                });\n            }\n        })\n    }\n\n\n    /**\n    * ge list error type\n    * @author Long.Pham 2019-06-03\n    */\n     getListErrorType() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        ErrorTypeService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataErrorType: data\n                });\n            } else {\n                self.setState({\n                    dataErrorType: []\n                });\n            }\n        })\n    }\n\n\n    onClickShowTab = (e, tabActive) => {\n        var curItem = this.state.curItem;\n        if (Libs.isBlank(tabActive)) return;\n        curItem.tabActive = tabActive;\n\n        this.setState({\n            curItem: curItem\n        });\n    }\n\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new AddPopupValidate(this.props);\n            let error = await v.validateOne(param, name);\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n\n    /**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n\n    handleInputTranslateChange = (event) => {\n        var target = event.target;\n        var name = target.name;\n        var value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n        if (name) {\n            let item = this.state.curItem;\n            let allLanguage = this.state.allLanguage;\n            let isoCode = name.substr(-2, 2),\n                dataMessage = name.substr(0, 7),\n                dataDescription = name.substr(0, 11),\n                dataSolutions = name.substr(0, 9);\n                \n\n            allLanguage.map((language, index) => {\n                if (isoCode === language.iso_code && dataMessage === 'message') {\n                    item.data[index].message = (event.target.validity.valid) ? value : this.state.curItem.data[index].message;\n                }\n\n                if (isoCode === language.iso_code && dataDescription === 'description') {\n                    item.data[index].description = (event.target.validity.valid) ? value : this.state.curItem.data[index].description;\n                }\n\n                if (isoCode === language.iso_code && dataSolutions === 'solutions') {\n                    item.data[index].solutions = (event.target.validity.valid) ? value : this.state.curItem.data[index].solutions;\n                }\n\n                return 1;\n            });\n\n            item[name] = (event.target.validity.valid) ? value : this.state.curItem[name];\n\n            this.setState({ curItem: item });\n        }\n    }\n\n\n\n    /**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */\n    async onSave() {\n        var {curItem} = this.state, self = this;\n        var params = Object.assign({}, this.state.curItem);\n        var screenMode = (!Libs.isBlank(curItem.id)) ? Constants.SCREEN_MODE.EDIT : ((!Libs.isBlank(this.props.curItem.screen_mode)) ? this.props.curItem.screen_mode : Constants.SCREEN_MODE.ADD);\n        let v = new AddPopupValidate(this.props);\n        let errors = await v.FLValidationAll(curItem);\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = screenMode;\n\n        params.iso_code_lang = this.employee.lang;\n        params.id_language = this.employee.id_language;\n        params.iso_code = this.employee.iso_code;\n\n        if (Libs.isArrayData(params.data)) {\n            let itemLanguageDefault = Libs.find(params.data, 'is_default', 1);\n            if (!itemLanguageDefault) return;\n\n            params.data.map((item, index) => {\n                params.data[index].message  = (item.message === '') ? itemLanguageDefault.message : item.message;\n                params.data[index].description = (item.description === '') ? itemLanguageDefault.description : item.description;\n                params.data[index].solutions  = (item.solutions === '') ? itemLanguageDefault.solutions : item.solutions;\n                return params;\n\n            });\n        } else { return false; }\n\n        ErrorService.instance.save(params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                self.props.onClickCloseAdd(true);\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n}\nexport default AddPopup;"]},"metadata":{},"sourceType":"module"}