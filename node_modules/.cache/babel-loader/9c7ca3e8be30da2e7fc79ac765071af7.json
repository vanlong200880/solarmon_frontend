{"ast":null,"code":"import _defineProperty from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../../../BaseComponent';import Libs from'../../../../../../utils/Libs';import ControlCalendarJsx from'./ControlCalendar.jsx';import MainDeviceService from'../../../../../../services/MainDeviceService';import ControlCalendarValidate from'./ControlCalendarValidate';import moment from'moment';import Constants from'../../../../../../utils/Constants';var ControlCalendar=/*#__PURE__*/function(_BaseComponent){_inherits(ControlCalendar,_BaseComponent);var _super=_createSuper(ControlCalendar);function ControlCalendar(props){var _this;_classCallCheck(this,ControlCalendar);_this=_super.call(this,props);_this.closeDeleteCalendar=function(status){if(status){_this.getListControlCalendar();}_this.setState({deleteItemCalendar:false},function(){document.body.classList.remove('on');});};_this.state={curItem:_this.props.curItem,itemCalendar:{},deleteItemCalendar:false,searchParam:{date_from:moment().format(\"DD/MM/YYYY HH:mm\"),min_date:moment().format(\"DD/MM/YYYY HH:mm\")},eventsList:[]};_this.jsxTemplate=ControlCalendarJsx;return _this;}/**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/09/2021\n     */_createClass(ControlCalendar,[{key:\"componentDidMount\",value:function componentDidMount(){this.getListControlCalendar();}/**\n         * get list\n         * @author Long.Pham 2019-06-03\n         */},{key:\"getListControlCalendar\",value:function getListControlCalendar(){var self=this;var curItem=this.state.curItem;var params=Object.assign({},curItem);params.id_device=curItem.id;var eventsList=[];MainDeviceService.instance.getListControlCalendar(params,function(data,total_row){if(Libs.isArrayData(data)){data.map(function(item,index){eventsList.push({'title':item.title,'start':new Date(item.start),'end':new Date(item.end),'index':index,'id':item.id,'id_device':item.id_device});});self.setState({eventsList:eventsList});}else{self.setState({eventsList:[]});}});}/**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */},{key:\"handleInputDateChange\",value:function handleInputDateChange(event){var target=event.target;var name=target.name;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var searchParam=this.state.searchParam;searchParam[name]=value;if(name=='date_from'){searchParam.date_to=moment(Libs.dateFormat(value,'YYYY-MM-DD HH:mm:ss','DD/MM/YYYY HH:mm')).add(2,'hours').format('DD/MM/YYYY HH:mm');}this.setState({searchParam:searchParam});}}},{key:\"onClickAddControlCalendarAction\",value:function(){var _onClickAddControlCalendarAction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state,curItem,searchParam,self,params,v,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=this.state,curItem=_this$state.curItem,searchParam=_this$state.searchParam,self=this;params=Object.assign({},searchParam);v=new ControlCalendarValidate(this.props);_context.next=5;return v.FLValidationAll(params);case 5:errors=_context.sent;if(!errors){_context.next=9;break;}this.setValidateMessage(errors);return _context.abrupt(\"return\");case 9://remove message validation\nthis.removeAllValidateMessage();params.screen_mode=Constants.SCREEN_MODE.ADD;if(!Libs.isBlank(curItem.id)){_context.next=13;break;}return _context.abrupt(\"return\");case 13:params.id=curItem.id;params.id_device=curItem.id;params.deviceID=curItem.id_device;params.date_from=Libs.dateFormat(searchParam.date_from,\"YYYY-MM-DD HH:mm:ss\",\"DD/MM/YYYY HH:mm:ss\");params.date_to=Libs.dateFormat(searchParam.date_to,\"YYYY-MM-DD HH:mm:ss\",\"DD/MM/YYYY HH:mm:ss\");params.hash_id=this.props.hash_id;MainDeviceService.instance.saveControlCalendar(params,function(status,data,msg){if(status){self.toast(msg,\"info\");searchParam.date_from=null;searchParam.date_to=null;self.setState({searchParam:searchParam},function(){self.getListControlCalendar();});}else if(data){self.setValidateMessage(data);}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);case 20:case\"end\":return _context.stop();}}},_callee,this);}));function onClickAddControlCalendarAction(){return _onClickAddControlCalendarAction.apply(this,arguments);}return onClickAddControlCalendarAction;}()},{key:\"onSelectEvent\",value:function onSelectEvent(event){if(Libs.isObjectEmpty(event))return;this.setState({itemCalendar:event,deleteItemCalendar:true},function(){document.body.classList.add('on');});}},{key:\"validateOne\",value:/**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */function(){var _validateOne=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var target,name,value,param,v,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:target=event.target;name=target.name;value=target.value;if(!name){_context2.next=10;break;}param=_defineProperty({},name,value);v=new ControlCalendarValidate(this.props);_context2.next=8;return v.validateOne(param,name);case 8:error=_context2.sent;if(error!=null){this.setValidateMessage(error,true);}case 10:case\"end\":return _context2.stop();}}},_callee2,this);}));function validateOne(_x){return _validateOne.apply(this,arguments);}return validateOne;}()}]);return ControlCalendar;}(BaseComponent);export default ControlCalendar;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModulePrivate/Control/Manual/ControlCalendar.js"],"names":["BaseComponent","Libs","ControlCalendarJsx","MainDeviceService","ControlCalendarValidate","moment","Constants","ControlCalendar","props","closeDeleteCalendar","status","getListControlCalendar","setState","deleteItemCalendar","document","body","classList","remove","state","curItem","itemCalendar","searchParam","date_from","format","min_date","eventsList","jsxTemplate","self","params","Object","assign","id_device","id","instance","data","total_row","isArrayData","map","item","index","push","title","Date","start","end","event","target","name","value","type","checked","date_to","dateFormat","add","v","FLValidationAll","errors","setValidateMessage","removeAllValidateMessage","screen_mode","SCREEN_MODE","ADD","isBlank","deviceID","hash_id","saveControlCalendar","msg","toast","isObjectEmpty","param","validateOne","error"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../../../BaseComponent';\nimport Libs from '../../../../../../utils/Libs';\nimport ControlCalendarJsx from './ControlCalendar.jsx';\nimport MainDeviceService from '../../../../../../services/MainDeviceService';\nimport ControlCalendarValidate from './ControlCalendarValidate';\nimport moment from 'moment';\nimport Constants from '../../../../../../utils/Constants';\n\nclass ControlCalendar extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: this.props.curItem,\n            itemCalendar: {},\n            deleteItemCalendar: false,\n            searchParam: {\n                date_from: moment().format(\"DD/MM/YYYY HH:mm\"),\n                min_date: moment().format(\"DD/MM/YYYY HH:mm\"),\n            },\n            eventsList: []\n        }\n\n        this.jsxTemplate = ControlCalendarJsx;\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/09/2021\n     */\n    componentDidMount() {\n        this.getListControlCalendar();\n    }\n\n    /**\n         * get list\n         * @author Long.Pham 2019-06-03\n         */\n    getListControlCalendar() {\n        let self = this;\n        var { curItem } = this.state;\n        let params = Object.assign({}, curItem);\n        params.id_device = curItem.id;\n\n        var eventsList = [];\n        MainDeviceService.instance.getListControlCalendar(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                data.map((item, index) => {\n                    eventsList.push({\n                        'title': item.title,\n                        'start': new Date(item.start),\n                        'end': new Date(item.end),\n                        'index': index,\n                        'id': item.id,\n                        'id_device': item.id_device\n                    }\n                    );\n                })\n                self.setState({\n                    eventsList: eventsList\n                });\n\n            } else {\n                self.setState({\n                    eventsList: []\n                });\n            }\n        });\n    }\n\n    /**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */\n    handleInputDateChange(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n\n        if (name) {\n            let { searchParam } = this.state;\n            searchParam[name] = value;\n\n            if (name == 'date_from') {\n                searchParam.date_to = moment(Libs.dateFormat(value, 'YYYY-MM-DD HH:mm:ss', 'DD/MM/YYYY HH:mm')).add(2, 'hours').format('DD/MM/YYYY HH:mm')\n            }\n            this.setState({ searchParam });\n        }\n    }\n\n    async onClickAddControlCalendarAction() {\n        var { curItem, searchParam } = this.state, self = this;\n        var params = Object.assign({}, searchParam);\n        let v = new ControlCalendarValidate(this.props);\n        let errors = await v.FLValidationAll(params);\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = Constants.SCREEN_MODE.ADD;\n        if (Libs.isBlank(curItem.id)) return;\n        params.id = curItem.id;\n        params.id_device = curItem.id;\n        params.deviceID = curItem.id_device;\n\n        params.date_from = Libs.dateFormat(searchParam.date_from, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n        params.date_to = Libs.dateFormat(searchParam.date_to, \"YYYY-MM-DD HH:mm:ss\", \"DD/MM/YYYY HH:mm:ss\");\n        params.hash_id = this.props.hash_id;\n\n        MainDeviceService.instance.saveControlCalendar(params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                searchParam.date_from = null;\n                searchParam.date_to = null;\n                self.setState({\n                    searchParam: searchParam\n                }, () => {\n                    self.getListControlCalendar();\n                })\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n\n\n    onSelectEvent(event) {\n        if (Libs.isObjectEmpty(event)) return;\n        this.setState({\n            itemCalendar: event,\n            deleteItemCalendar: true\n        }, ()=>{\n            document.body.classList.add('on');\n        });\n    }\n\n    closeDeleteCalendar = (status) => {\n        if (status) {\n            this.getListControlCalendar();\n        }\n        this.setState({\n            deleteItemCalendar: false\n        }, () => {\n            document.body.classList.remove('on');\n        })\n    }\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new ControlCalendarValidate(this.props);\n            let error = await v.validateOne(param, name);\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n}\nexport default ControlCalendar;"]},"metadata":{},"sourceType":"module"}