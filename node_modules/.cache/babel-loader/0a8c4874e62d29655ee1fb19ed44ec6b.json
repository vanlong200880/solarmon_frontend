{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../../BaseComponent';import Libs from'../../../../../utils/Libs';import Constants from'../../../../../utils/Constants';import AddPopupJsx from'./AddPopup.jsx';import AddPopupValidate from'./AddPopupValidate';import ProjectGroupService from'../../../../../services/ProjectGroupService';import ProjectService from'../../../../../services/ProjectService';import EmployeeService from'../../../../../services/EmployeeService';var AddPopup=/*#__PURE__*/function(_BaseComponent){_inherits(AddPopup,_BaseComponent);var _super=_createSuper(AddPopup);function AddPopup(props){var _this;_classCallCheck(this,AddPopup);_this=_super.call(this,props);_this.onIsCheckedChange=function(index){var dataListEmployee=_this.state.dataListEmployee;if(!Libs.isArrayData(dataListEmployee))return;var item=dataListEmployee[index];if(Libs.isObjectEmpty(item))return;dataListEmployee[index].is_checked=dataListEmployee[index].is_checked?0:1;_this.setState({dataListEmployee:dataListEmployee});};_this.onFileAvatarChange=function(event){var t=_this.props.t;var target=event.target;var file=target.files[0];if(!file||file===undefined||file===null)return;var fileName=file.name,fileSize=file.size;var checkExtFile=Libs.checkExtensionFile(fileName,1);var msgAvatarError=null;if(!checkExtFile){msgAvatarError=t('message.msg_err_ext_image_file');}else if(fileSize<=0){msgAvatarError=t('message.msg_err_file_size');}else if(fileSize>Constants.COMMON.MAX_IMAGE_SIZE){msgAvatarError=t('message.msg_err_max_size_upload');}var self=_assertThisInitialized(_this);var curItem=_this.state.curItem;if(!Libs.isBlank(msgAvatarError)){curItem.upload_thumbnail='';curItem.thumbnail_message=msgAvatarError;_this.setState({curItem:curItem});return;}else{curItem.thumbnail_message='';_this.setState({curItem:curItem});}//Read file upload\nvar reader=new FileReader();reader.onload=function(e){curItem.upload_thumbnail=e.target.result;curItem.upload_thumbnail_name=fileName;self.setState({curItem:curItem});};reader.readAsDataURL(file);};_this.onClickDeleteAvatar=function(event){var curItem=_this.state.curItem;curItem.thumbnail_message='';curItem.thumbnail_upload='';curItem.thumbnail=null;_this.setState({curItem:curItem});};_this.handleDropdownChange=function(item,name){var self=_assertThisInitialized(_this);var curItem=self.state.curItem;if(Libs.isObjectEmpty(item)){curItem.id_project_group='';}else{var value=item.value;curItem[name]=value;self.setValidateMessage({id_project_group:''},true);}self.setState({curItem:curItem});};_this.onClickShowTab=function(e,tabActive){var curItem=_this.state.curItem;if(Libs.isBlank(tabActive))return;curItem.tabActive=tabActive;_this.setState({curItem:curItem});};_this.handleInputTranslateChange=function(event){var target=event.target;var name=target.name;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var item=_this.state.curItem;var allLanguage=_this.state.allLanguage;var isoCode=name.substr(-2,2),dataName=name.substr(0,4),dataSiteName=name.substr(0,9),dataDescription=name.substr(0,11);allLanguage.map(function(language,index){if(isoCode===language.iso_code&&dataName==='name'){item.data[index].name=event.target.validity.valid?value:_this.state.curItem.data[index].name;}if(isoCode===language.iso_code&&dataSiteName==='site_name'){item.data[index].site_name=event.target.validity.valid?value:_this.state.curItem.data[index].site_name;}if(isoCode===language.iso_code&&dataDescription==='description'){item.data[index].description=event.target.validity.valid?value:_this.state.curItem.data[index].description;}return 1;});item[name]=event.target.validity.valid?value:_this.state.curItem[name];_this.setState({curItem:item});}};_this.state={curItem:Object.assign({},_this.props.curItem),allLanguage:_this.props.allLanguage,dataProjectGroup:[],dataListEmployee:[]};_this.jsxTemplate=AddPopupJsx;_this.handleDropdownChange=_this.handleDropdownChange.bind(_assertThisInitialized(_this));return _this;}/**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */_createClass(AddPopup,[{key:\"componentDidMount\",value:function componentDidMount(){var curItem=this.state.curItem;if(curItem.screen_mode===Constants.SCREEN_MODE.ADD){var dataEmployees=[];dataEmployees.push({id_project:null,id_employee:this.employee.id_employee});curItem.dataEmployees=dataEmployees;}this.getDataProjectGroup();this.getListAllEmployee();}},{key:\"getListAllEmployee\",value:/**\n     * ge list employee\n     * @author Long.Pham 2019-06-03\n     */function getListAllEmployee(){var self=this;var params={id_language:this.employee.id_language};var curItem=this.state.curItem;var dataEmployees=Libs.isArrayData(curItem.dataEmployees)?curItem.dataEmployees:[];EmployeeService.instance.getListAll(params,function(data,total_row){if(Libs.isArrayData(data)){for(var i=0,len=data.length;i<len;i++){var findItem=Libs.find(dataEmployees,'id_employee',data[i].id);if(!Libs.isObjectEmpty(findItem)){data[i].is_checked=1;}else{data[i].is_checked=0;}}self.setState({dataListEmployee:data});}else{self.setState({dataListEmployee:[]});}});}/**\n     * @description Upload icon  \n     * @author Long.Pham 12/05/2021\n     */},{key:\"getDataProjectGroup\",value:/**\n     * ge list roles\n     * @author Long.Pham 2019-06-03\n     */function getDataProjectGroup(){var self=this;var params={id_language:this.employee.id_language};ProjectGroupService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataProjectGroup:data});}else{self.setState({dataProjectGroup:[]});}});}},{key:\"validateOne\",value:/**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */function(){var _validateOne=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var target,name,value,param,v,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:target=event.target;name=target.name;value=target.value;if(!name){_context.next=10;break;}param=_defineProperty({},name,value);v=new AddPopupValidate(this.props);_context.next=8;return v.validateOne(param,name);case 8:error=_context.sent;if(error!=null){this.setValidateMessage(error,true);}case 10:case\"end\":return _context.stop();}}},_callee,this);}));function validateOne(_x){return _validateOne.apply(this,arguments);}return validateOne;}()/**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */},{key:\"onSave\",value:/**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */function(){var _onSave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this$state,curItem,dataListEmployee,self,params,screenMode,v,errors,dataEmployees,i,len,itemLanguageDefault;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$state=this.state,curItem=_this$state.curItem,dataListEmployee=_this$state.dataListEmployee,self=this;params=Object.assign({},this.state.curItem);screenMode=!Libs.isBlank(curItem.id)?Constants.SCREEN_MODE.EDIT:!Libs.isBlank(this.props.curItem.screen_mode)?this.props.curItem.screen_mode:Constants.SCREEN_MODE.ADD;v=new AddPopupValidate(this.props);_context2.next=6;return v.FLValidationAll(curItem);case 6:errors=_context2.sent;if(!errors){_context2.next=10;break;}this.setValidateMessage(errors);return _context2.abrupt(\"return\");case 10://remove message validation\nthis.removeAllValidateMessage();params.screen_mode=screenMode;params.iso_code_lang=this.employee.lang;params.id_language=this.employee.id_language;params.iso_code=this.employee.iso_code;dataEmployees=[];if(Libs.isArrayData(dataListEmployee)){for(i=0,len=dataListEmployee.length;i<len;i++){if(dataListEmployee[i].is_checked){dataEmployees.push({id_project:null,id_employee:dataListEmployee[i].id});}}}params.dataEmployees=dataEmployees;if(!Libs.isArrayData(params.data)){_context2.next=25;break;}itemLanguageDefault=Libs.find(params.data,'is_default',1);if(itemLanguageDefault){_context2.next=22;break;}return _context2.abrupt(\"return\");case 22:params.data.map(function(item,index){params.data[index].name=item.name===''?itemLanguageDefault.name:item.name;params.data[index].site_name=item.site_name===''?itemLanguageDefault.site_name:item.site_name;params.data[index].description=item.description===''?itemLanguageDefault.description:item.description;return params;});_context2.next=26;break;case 25:return _context2.abrupt(\"return\",false);case 26:ProjectService.instance.save(params,function(status,data,msg){if(status){self.toast(msg,\"info\");self.props.onClickCloseAdd(true);}else if(data){self.setValidateMessage(data);}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);case 27:case\"end\":return _context2.stop();}}},_callee2,this);}));function onSave(){return _onSave.apply(this,arguments);}return onSave;}()}]);return AddPopup;}(BaseComponent);export default AddPopup;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModuleSystem/Project/AddPopup.js"],"names":["BaseComponent","Libs","Constants","AddPopupJsx","AddPopupValidate","ProjectGroupService","ProjectService","EmployeeService","AddPopup","props","onIsCheckedChange","index","dataListEmployee","state","isArrayData","item","isObjectEmpty","is_checked","setState","onFileAvatarChange","event","t","target","file","files","undefined","fileName","name","fileSize","size","checkExtFile","checkExtensionFile","msgAvatarError","COMMON","MAX_IMAGE_SIZE","self","curItem","isBlank","upload_thumbnail","thumbnail_message","reader","FileReader","onload","e","result","upload_thumbnail_name","readAsDataURL","onClickDeleteAvatar","thumbnail_upload","thumbnail","handleDropdownChange","id_project_group","value","setValidateMessage","onClickShowTab","tabActive","handleInputTranslateChange","type","checked","allLanguage","isoCode","substr","dataName","dataSiteName","dataDescription","map","language","iso_code","data","validity","valid","site_name","description","Object","assign","dataProjectGroup","jsxTemplate","bind","screen_mode","SCREEN_MODE","ADD","dataEmployees","push","id_project","id_employee","employee","getDataProjectGroup","getListAllEmployee","params","id_language","instance","getListAll","total_row","i","len","length","findItem","find","id","getDropdownList","param","v","validateOne","error","screenMode","EDIT","FLValidationAll","errors","removeAllValidateMessage","iso_code_lang","lang","itemLanguageDefault","save","status","msg","toast","onClickCloseAdd"],"mappings":"+tCACA,MAAOA,CAAAA,aAAP,KAA0B,2BAA1B,CACA,MAAOC,CAAAA,IAAP,KAAiB,2BAAjB,CACA,MAAOC,CAAAA,SAAP,KAAsB,gCAAtB,CACA,MAAOC,CAAAA,WAAP,KAAwB,gBAAxB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,oBAA7B,CACA,MAAOC,CAAAA,mBAAP,KAAgC,6CAAhC,CACA,MAAOC,CAAAA,cAAP,KAA2B,wCAA3B,CACA,MAAOC,CAAAA,eAAP,KAA4B,yCAA5B,C,GAEMC,CAAAA,Q,4GACF,kBAAYC,KAAZ,CAAmB,0CACf,uBAAMA,KAAN,EADe,MA4BnBC,iBA5BmB,CA4BC,SAACC,KAAD,CAAW,CAC3B,GAAMC,CAAAA,gBAAN,CAA2B,MAAKC,KAAhC,CAAMD,gBAAN,CACA,GAAI,CAACX,IAAI,CAACa,WAAL,CAAiBF,gBAAjB,CAAL,CAAyC,OACzC,GAAIG,CAAAA,IAAI,CAAGH,gBAAgB,CAACD,KAAD,CAA3B,CACA,GAAIV,IAAI,CAACe,aAAL,CAAmBD,IAAnB,CAAJ,CAA8B,OAC9BH,gBAAgB,CAACD,KAAD,CAAhB,CAAwBM,UAAxB,CAAqCL,gBAAgB,CAACD,KAAD,CAAhB,CAAwBM,UAAxB,CAAqC,CAArC,CAAyC,CAA9E,CACA,MAAKC,QAAL,CAAc,CACVN,gBAAgB,CAAEA,gBADR,CAAd,EAGH,CArCkB,OA4EnBO,kBA5EmB,CA4EE,SAACC,KAAD,CAAW,CAC5B,GAAMC,CAAAA,CAAN,CAAY,MAAKZ,KAAjB,CAAMY,CAAN,CACA,GAAIC,CAAAA,MAAM,CAAGF,KAAK,CAACE,MAAnB,CACA,GAAIC,CAAAA,IAAI,CAAGD,MAAM,CAACE,KAAP,CAAa,CAAb,CAAX,CACA,GAAI,CAACD,IAAD,EAASA,IAAI,GAAKE,SAAlB,EAA+BF,IAAI,GAAK,IAA5C,CAAkD,OAClD,GAAIG,CAAAA,QAAQ,CAAGH,IAAI,CAACI,IAApB,CAA0BC,QAAQ,CAAGL,IAAI,CAACM,IAA1C,CACA,GAAIC,CAAAA,YAAY,CAAG7B,IAAI,CAAC8B,kBAAL,CAAwBL,QAAxB,CAAkC,CAAlC,CAAnB,CACA,GAAIM,CAAAA,cAAc,CAAG,IAArB,CACA,GAAI,CAACF,YAAL,CAAmB,CACfE,cAAc,CAAGX,CAAC,CAAC,gCAAD,CAAlB,CACH,CAFD,IAGK,IAAIO,QAAQ,EAAI,CAAhB,CAAmB,CACpBI,cAAc,CAAGX,CAAC,CAAC,2BAAD,CAAlB,CACH,CAFI,IAGA,IAAIO,QAAQ,CAAG1B,SAAS,CAAC+B,MAAV,CAAiBC,cAAhC,CAAgD,CACjDF,cAAc,CAAGX,CAAC,CAAC,iCAAD,CAAlB,CACH,CAED,GAAIc,CAAAA,IAAI,8BAAR,CACA,GAAMC,CAAAA,OAAN,CAAkB,MAAKvB,KAAvB,CAAMuB,OAAN,CACA,GAAI,CAACnC,IAAI,CAACoC,OAAL,CAAaL,cAAb,CAAL,CAAmC,CAC/BI,OAAO,CAACE,gBAAR,CAA2B,EAA3B,CACAF,OAAO,CAACG,iBAAR,CAA4BP,cAA5B,CACA,MAAKd,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAIA,OACH,CARD,IAQO,CACHA,OAAO,CAACG,iBAAR,CAA4B,EAA5B,CACA,MAAKrB,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAGH,CAED;AACA,GAAII,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAb,CACAD,MAAM,CAACE,MAAP,CAAgB,SAAUC,CAAV,CAAa,CACzBP,OAAO,CAACE,gBAAR,CAA2BK,CAAC,CAACrB,MAAF,CAASsB,MAApC,CACAR,OAAO,CAACS,qBAAR,CAAgCnB,QAAhC,CACAS,IAAI,CAACjB,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAGH,CAND,CAOAI,MAAM,CAACM,aAAP,CAAqBvB,IAArB,EACH,CAzHkB,OAgInBwB,mBAhImB,CAgIG,SAAC3B,KAAD,CAAW,CAC7B,GAAMgB,CAAAA,OAAN,CAAkB,MAAKvB,KAAvB,CAAMuB,OAAN,CACAA,OAAO,CAACG,iBAAR,CAA4B,EAA5B,CACAH,OAAO,CAACY,gBAAR,CAA2B,EAA3B,CACAZ,OAAO,CAACa,SAAR,CAAoB,IAApB,CAEA,MAAK/B,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAGH,CAzIkB,OAoKnBc,oBApKmB,CAoKI,SAACnC,IAAD,CAAOY,IAAP,CAAgB,CACnC,GAAIQ,CAAAA,IAAI,8BAAR,CACA,GAAIC,CAAAA,OAAO,CAAGD,IAAI,CAACtB,KAAL,CAAWuB,OAAzB,CAEA,GAAInC,IAAI,CAACe,aAAL,CAAmBD,IAAnB,CAAJ,CAA8B,CAC1BqB,OAAO,CAACe,gBAAR,CAA2B,EAA3B,CACH,CAFD,IAEO,CACH,GAAIC,CAAAA,KAAK,CAAGrC,IAAI,CAACqC,KAAjB,CACAhB,OAAO,CAACT,IAAD,CAAP,CAAgByB,KAAhB,CACAjB,IAAI,CAACkB,kBAAL,CAAwB,CAAEF,gBAAgB,CAAE,EAApB,CAAxB,CAAkD,IAAlD,EACH,CAEDhB,IAAI,CAACjB,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAGH,CAnLkB,OAqLnBkB,cArLmB,CAqLF,SAACX,CAAD,CAAIY,SAAJ,CAAkB,CAC/B,GAAInB,CAAAA,OAAO,CAAG,MAAKvB,KAAL,CAAWuB,OAAzB,CACA,GAAInC,IAAI,CAACoC,OAAL,CAAakB,SAAb,CAAJ,CAA6B,OAC7BnB,OAAO,CAACmB,SAAR,CAAoBA,SAApB,CAEA,MAAKrC,QAAL,CAAc,CACVkB,OAAO,CAAEA,OADC,CAAd,EAGH,CA7LkB,OA2NnBoB,0BA3NmB,CA2NU,SAACpC,KAAD,CAAW,CACpC,GAAIE,CAAAA,MAAM,CAAGF,KAAK,CAACE,MAAnB,CACA,GAAIK,CAAAA,IAAI,CAAGL,MAAM,CAACK,IAAlB,CACA,GAAIyB,CAAAA,KAAK,CAAG9B,MAAM,CAAC8B,KAAnB,CACA,GAAI9B,MAAM,CAACmC,IAAP,GAAgB,UAApB,CAAgC,CAC5BL,KAAK,CAAG9B,MAAM,CAACoC,OAAP,CAAiB,CAAjB,CAAqB,CAA7B,CACH,CACD,GAAI/B,IAAJ,CAAU,CACN,GAAIZ,CAAAA,IAAI,CAAG,MAAKF,KAAL,CAAWuB,OAAtB,CACA,GAAIuB,CAAAA,WAAW,CAAG,MAAK9C,KAAL,CAAW8C,WAA7B,CACA,GAAIC,CAAAA,OAAO,CAAGjC,IAAI,CAACkC,MAAL,CAAY,CAAC,CAAb,CAAgB,CAAhB,CAAd,CACIC,QAAQ,CAAGnC,IAAI,CAACkC,MAAL,CAAY,CAAZ,CAAe,CAAf,CADf,CAEIE,YAAY,CAAGpC,IAAI,CAACkC,MAAL,CAAY,CAAZ,CAAc,CAAd,CAFnB,CAGIG,eAAe,CAAGrC,IAAI,CAACkC,MAAL,CAAY,CAAZ,CAAe,EAAf,CAHtB,CAKAF,WAAW,CAACM,GAAZ,CAAgB,SAACC,QAAD,CAAWvD,KAAX,CAAqB,CACjC,GAAIiD,OAAO,GAAKM,QAAQ,CAACC,QAArB,EAAiCL,QAAQ,GAAK,MAAlD,CAA0D,CACtD/C,IAAI,CAACqD,IAAL,CAAUzD,KAAV,EAAiBgB,IAAjB,CAAyBP,KAAK,CAACE,MAAN,CAAa+C,QAAb,CAAsBC,KAAvB,CAAgClB,KAAhC,CAAwC,MAAKvC,KAAL,CAAWuB,OAAX,CAAmBgC,IAAnB,CAAwBzD,KAAxB,EAA+BgB,IAA/F,CACH,CAED,GAAIiC,OAAO,GAAKM,QAAQ,CAACC,QAArB,EAAiCJ,YAAY,GAAK,WAAtD,CAAmE,CAC/DhD,IAAI,CAACqD,IAAL,CAAUzD,KAAV,EAAiB4D,SAAjB,CAA8BnD,KAAK,CAACE,MAAN,CAAa+C,QAAb,CAAsBC,KAAvB,CAAgClB,KAAhC,CAAwC,MAAKvC,KAAL,CAAWuB,OAAX,CAAmBgC,IAAnB,CAAwBzD,KAAxB,EAA+B4D,SAApG,CACH,CAED,GAAIX,OAAO,GAAKM,QAAQ,CAACC,QAArB,EAAiCH,eAAe,GAAK,aAAzD,CAAwE,CACpEjD,IAAI,CAACqD,IAAL,CAAUzD,KAAV,EAAiB6D,WAAjB,CAAgCpD,KAAK,CAACE,MAAN,CAAa+C,QAAb,CAAsBC,KAAvB,CAAgClB,KAAhC,CAAwC,MAAKvC,KAAL,CAAWuB,OAAX,CAAmBgC,IAAnB,CAAwBzD,KAAxB,EAA+B6D,WAAtG,CACH,CACD,MAAO,EAAP,CACH,CAbD,EAeAzD,IAAI,CAACY,IAAD,CAAJ,CAAcP,KAAK,CAACE,MAAN,CAAa+C,QAAb,CAAsBC,KAAvB,CAAgClB,KAAhC,CAAwC,MAAKvC,KAAL,CAAWuB,OAAX,CAAmBT,IAAnB,CAArD,CAEA,MAAKT,QAAL,CAAc,CAAEkB,OAAO,CAAErB,IAAX,CAAd,EACH,CACJ,CA7PkB,CAEf,MAAKF,KAAL,CAAa,CACTuB,OAAO,CAAEqC,MAAM,CAACC,MAAP,CAAc,EAAd,CAAkB,MAAKjE,KAAL,CAAW2B,OAA7B,CADA,CAETuB,WAAW,CAAE,MAAKlD,KAAL,CAAWkD,WAFf,CAGTgB,gBAAgB,CAAE,EAHT,CAIT/D,gBAAgB,CAAE,EAJT,CAAb,CAOA,MAAKgE,WAAL,CAAmBzE,WAAnB,CACA,MAAK+C,oBAAL,CAA4B,MAAKA,oBAAL,CAA0B2B,IAA1B,+BAA5B,CAVe,aAWlB,CACD;AACJ;AACA;AACA,O,sDACI,4BAAoB,CAChB,GAAMzC,CAAAA,OAAN,CAAkB,KAAKvB,KAAvB,CAAMuB,OAAN,CACA,GAAIA,OAAO,CAAC0C,WAAR,GAAwB5E,SAAS,CAAC6E,WAAV,CAAsBC,GAAlD,CAAuD,CACnD,GAAIC,CAAAA,aAAa,CAAG,EAApB,CACAA,aAAa,CAACC,IAAd,CAAmB,CAAEC,UAAU,CAAE,IAAd,CAAoBC,WAAW,CAAE,KAAKC,QAAL,CAAcD,WAA/C,CAAnB,EACAhD,OAAO,CAAC6C,aAAR,CAAwBA,aAAxB,CAEH,CACD,KAAKK,mBAAL,GACA,KAAKC,kBAAL,GACH,C,kCAYD;AACJ;AACA;AACA,OACI,6BAAqB,CACjB,GAAIpD,CAAAA,IAAI,CAAG,IAAX,CACA,GAAIqD,CAAAA,MAAM,CAAG,CACTC,WAAW,CAAE,KAAKJ,QAAL,CAAcI,WADlB,CAAb,CAIA,GAAMrD,CAAAA,OAAN,CAAkB,KAAKvB,KAAvB,CAAMuB,OAAN,CAEA,GAAI6C,CAAAA,aAAa,CAAGhF,IAAI,CAACa,WAAL,CAAiBsB,OAAO,CAAC6C,aAAzB,EAA0C7C,OAAO,CAAC6C,aAAlD,CAAkE,EAAtF,CACA1E,eAAe,CAACmF,QAAhB,CAAyBC,UAAzB,CAAoCH,MAApC,CAA4C,SAACpB,IAAD,CAAOwB,SAAP,CAAqB,CAC7D,GAAI3F,IAAI,CAACa,WAAL,CAAiBsD,IAAjB,CAAJ,CAA4B,CACxB,IAAK,GAAIyB,CAAAA,CAAC,CAAG,CAAR,CAAWC,GAAG,CAAG1B,IAAI,CAAC2B,MAA3B,CAAmCF,CAAC,CAAGC,GAAvC,CAA4CD,CAAC,EAA7C,CAAiD,CAC7C,GAAIG,CAAAA,QAAQ,CAAG/F,IAAI,CAACgG,IAAL,CAAUhB,aAAV,CAAyB,aAAzB,CAAwCb,IAAI,CAACyB,CAAD,CAAJ,CAAQK,EAAhD,CAAf,CACA,GAAI,CAACjG,IAAI,CAACe,aAAL,CAAmBgF,QAAnB,CAAL,CAAmC,CAC/B5B,IAAI,CAACyB,CAAD,CAAJ,CAAQ5E,UAAR,CAAqB,CAArB,CACH,CAFD,IAEO,CACHmD,IAAI,CAACyB,CAAD,CAAJ,CAAQ5E,UAAR,CAAqB,CAArB,CACH,CACJ,CACDkB,IAAI,CAACjB,QAAL,CAAc,CACVN,gBAAgB,CAAEwD,IADR,CAAd,EAGH,CAZD,IAYO,CACHjC,IAAI,CAACjB,QAAL,CAAc,CACVN,gBAAgB,CAAE,EADR,CAAd,EAGH,CACJ,CAlBD,EAmBH,CAED;AACJ;AACA;AACA,O,mCAkEI;AACJ;AACA;AACA,OACI,8BAAsB,CAClB,GAAIuB,CAAAA,IAAI,CAAG,IAAX,CACA,GAAIqD,CAAAA,MAAM,CAAG,CACTC,WAAW,CAAE,KAAKJ,QAAL,CAAcI,WADlB,CAAb,CAIApF,mBAAmB,CAACqF,QAApB,CAA6BS,eAA7B,CAA6CX,MAA7C,CAAqD,SAACpB,IAAD,CAAOwB,SAAP,CAAqB,CACtE,GAAI3F,IAAI,CAACa,WAAL,CAAiBsD,IAAjB,CAAJ,CAA4B,CACxBjC,IAAI,CAACjB,QAAL,CAAc,CACVyD,gBAAgB,CAAEP,IADR,CAAd,EAGH,CAJD,IAIO,CACHjC,IAAI,CAACjB,QAAL,CAAc,CACVyD,gBAAgB,CAAE,EADR,CAAd,EAGH,CACJ,CAVD,EAWH,C,2BA8BD;AACJ;AACA;AACA;AACA,O,oFACI,iBAAkBvD,KAAlB,sJACQE,MADR,CACiBF,KAAK,CAACE,MADvB,CAEQK,IAFR,CAEeL,MAAM,CAACK,IAFtB,CAGQyB,KAHR,CAGgB9B,MAAM,CAAC8B,KAHvB,KAIQzB,IAJR,0BAKYyE,KALZ,oBAMazE,IANb,CAMoByB,KANpB,EAQYiD,CARZ,CAQgB,GAAIjG,CAAAA,gBAAJ,CAAqB,KAAKK,KAA1B,CARhB,uBAS0B4F,CAAAA,CAAC,CAACC,WAAF,CAAcF,KAAd,CAAqBzE,IAArB,CAT1B,QASY4E,KATZ,eAUQ,GAAIA,KAAK,EAAI,IAAb,CAAmB,CACf,KAAKlD,kBAAL,CAAwBkD,KAAxB,CAA+B,IAA/B,EACH,CAZT,4D,6FAgBA;AACJ;AACA;AACA;AACA,O,sBAwCI;AACJ;AACA;AACA,O,+EACI,qQACsC,KAAK1F,KAD3C,CACSuB,OADT,aACSA,OADT,CACkBxB,gBADlB,aACkBA,gBADlB,CACkDuB,IADlD,CACyD,IADzD,CAEQqD,MAFR,CAEiBf,MAAM,CAACC,MAAP,CAAc,EAAd,CAAkB,KAAK7D,KAAL,CAAWuB,OAA7B,CAFjB,CAGQoE,UAHR,CAGsB,CAACvG,IAAI,CAACoC,OAAL,CAAaD,OAAO,CAAC8D,EAArB,CAAF,CAA8BhG,SAAS,CAAC6E,WAAV,CAAsB0B,IAApD,CAA6D,CAACxG,IAAI,CAACoC,OAAL,CAAa,KAAK5B,KAAL,CAAW2B,OAAX,CAAmB0C,WAAhC,CAAF,CAAkD,KAAKrE,KAAL,CAAW2B,OAAX,CAAmB0C,WAArE,CAAmF5E,SAAS,CAAC6E,WAAV,CAAsBC,GAH1L,CAIQqB,CAJR,CAIY,GAAIjG,CAAAA,gBAAJ,CAAqB,KAAKK,KAA1B,CAJZ,wBAKuB4F,CAAAA,CAAC,CAACK,eAAF,CAAkBtE,OAAlB,CALvB,QAKQuE,MALR,oBAMQA,MANR,2BAOQ,KAAKtD,kBAAL,CAAwBsD,MAAxB,EAPR,0CAUI;AACA,KAAKC,wBAAL,GACApB,MAAM,CAACV,WAAP,CAAqB0B,UAArB,CAEAhB,MAAM,CAACqB,aAAP,CAAuB,KAAKxB,QAAL,CAAcyB,IAArC,CACAtB,MAAM,CAACC,WAAP,CAAqB,KAAKJ,QAAL,CAAcI,WAAnC,CACAD,MAAM,CAACrB,QAAP,CAAkB,KAAKkB,QAAL,CAAclB,QAAhC,CAEIc,aAlBR,CAkBwB,EAlBxB,CAmBI,GAAGhF,IAAI,CAACa,WAAL,CAAiBF,gBAAjB,CAAH,CAAsC,CAClC,IAAQiF,CAAR,CAAY,CAAZ,CAAeC,GAAf,CAAqBlF,gBAAgB,CAACmF,MAAtC,CAA8CF,CAAC,CAAGC,GAAlD,CAAuDD,CAAC,EAAxD,CAA2D,CACvD,GAAGjF,gBAAgB,CAACiF,CAAD,CAAhB,CAAoB5E,UAAvB,CAAkC,CAC9BgE,aAAa,CAACC,IAAd,CAAmB,CACfC,UAAU,CAAE,IADG,CAEfC,WAAW,CAAExE,gBAAgB,CAACiF,CAAD,CAAhB,CAAoBK,EAFlB,CAAnB,EAIH,CACJ,CACJ,CACDV,MAAM,CAACP,aAAP,CAAuBA,aAAvB,CA7BJ,IA+BQhF,IAAI,CAACa,WAAL,CAAiB0E,MAAM,CAACpB,IAAxB,CA/BR,2BAgCY2C,mBAhCZ,CAgCkC9G,IAAI,CAACgG,IAAL,CAAUT,MAAM,CAACpB,IAAjB,CAAuB,YAAvB,CAAqC,CAArC,CAhClC,IAiCa2C,mBAjCb,qEAmCQvB,MAAM,CAACpB,IAAP,CAAYH,GAAZ,CAAgB,SAAClD,IAAD,CAAOJ,KAAP,CAAiB,CAC7B6E,MAAM,CAACpB,IAAP,CAAYzD,KAAZ,EAAmBgB,IAAnB,CAA2BZ,IAAI,CAACY,IAAL,GAAc,EAAf,CAAqBoF,mBAAmB,CAACpF,IAAzC,CAAgDZ,IAAI,CAACY,IAA/E,CACA6D,MAAM,CAACpB,IAAP,CAAYzD,KAAZ,EAAmB4D,SAAnB,CAAgCxD,IAAI,CAACwD,SAAL,GAAmB,EAApB,CAA0BwC,mBAAmB,CAACxC,SAA9C,CAA0DxD,IAAI,CAACwD,SAA9F,CACAiB,MAAM,CAACpB,IAAP,CAAYzD,KAAZ,EAAmB6D,WAAnB,CAAkCzD,IAAI,CAACyD,WAAL,GAAqB,EAAtB,CAA4BuC,mBAAmB,CAACvC,WAAhD,CAA8DzD,IAAI,CAACyD,WAApG,CACA,MAAOgB,CAAAA,MAAP,CAEH,CAND,EAnCR,iEA0CoB,KA1CpB,UA4CIlF,cAAc,CAACoF,QAAf,CAAwBsB,IAAxB,CAA6BxB,MAA7B,CAAqC,SAAUyB,MAAV,CAAkB7C,IAAlB,CAAwB8C,GAAxB,CAA6B,CAC9D,GAAID,MAAJ,CAAY,CACR9E,IAAI,CAACgF,KAAL,CAAWD,GAAX,CAAgB,MAAhB,EACA/E,IAAI,CAAC1B,KAAL,CAAW2G,eAAX,CAA2B,IAA3B,EACH,CAHD,IAIK,IAAIhD,IAAJ,CAAU,CACXjC,IAAI,CAACkB,kBAAL,CAAwBe,IAAxB,EACH,CAFI,IAIA,IAAI,CAACnE,IAAI,CAACoC,OAAL,CAAa6E,GAAb,CAAL,CAAwB,CACzB/E,IAAI,CAACgF,KAAL,CAAWD,GAAX,CAAgB,OAAhB,EACH,CACJ,CAZD,CAYG,IAZH,EA5CJ,8D,kGAtQmBlH,a,EAiUvB,cAAeQ,CAAAA,QAAf","sourcesContent":["\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport Constants from '../../../../../utils/Constants';\nimport AddPopupJsx from './AddPopup.jsx';\nimport AddPopupValidate from './AddPopupValidate';\nimport ProjectGroupService from '../../../../../services/ProjectGroupService';\nimport ProjectService from '../../../../../services/ProjectService';\nimport EmployeeService from '../../../../../services/EmployeeService';\n\nclass AddPopup extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: Object.assign({}, this.props.curItem),\n            allLanguage: this.props.allLanguage,\n            dataProjectGroup: [],\n            dataListEmployee: []\n        }\n\n        this.jsxTemplate = AddPopupJsx;\n        this.handleDropdownChange = this.handleDropdownChange.bind(this);\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */\n    componentDidMount() {\n        var { curItem } = this.state;\n        if (curItem.screen_mode === Constants.SCREEN_MODE.ADD) {\n            var dataEmployees = [];\n            dataEmployees.push({ id_project: null, id_employee: this.employee.id_employee });\n            curItem.dataEmployees = dataEmployees;\n\n        }\n        this.getDataProjectGroup();\n        this.getListAllEmployee();\n    }\n\n    onIsCheckedChange = (index) => {\n        var { dataListEmployee } = this.state;\n        if (!Libs.isArrayData(dataListEmployee)) return;\n        var item = dataListEmployee[index];\n        if (Libs.isObjectEmpty(item)) return;\n        dataListEmployee[index].is_checked = dataListEmployee[index].is_checked ? 0 : 1;\n        this.setState({\n            dataListEmployee: dataListEmployee\n        })\n    }\n    /**\n     * ge list employee\n     * @author Long.Pham 2019-06-03\n     */\n    getListAllEmployee() {\n        let self = this;\n        var params = {\n            id_language: this.employee.id_language\n        };\n\n        var { curItem } = this.state;\n        \n        var dataEmployees = Libs.isArrayData(curItem.dataEmployees) ? curItem.dataEmployees : [];\n        EmployeeService.instance.getListAll(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                for (var i = 0, len = data.length; i < len; i++) {\n                    var findItem = Libs.find(dataEmployees, 'id_employee', data[i].id);\n                    if (!Libs.isObjectEmpty(findItem)) {\n                        data[i].is_checked = 1;\n                    } else {\n                        data[i].is_checked = 0;\n                    }\n                }\n                self.setState({\n                    dataListEmployee: data\n                });\n            } else {\n                self.setState({\n                    dataListEmployee: []\n                });\n            }\n        })\n    }\n\n    /**\n     * @description Upload icon  \n     * @author Long.Pham 12/05/2021\n     */\n    onFileAvatarChange = (event) => {\n        var { t } = this.props;\n        var target = event.target;\n        var file = target.files[0];\n        if (!file || file === undefined || file === null) return;\n        var fileName = file.name, fileSize = file.size;\n        var checkExtFile = Libs.checkExtensionFile(fileName, 1);\n        var msgAvatarError = null;\n        if (!checkExtFile) {\n            msgAvatarError = t('message.msg_err_ext_image_file')\n        }\n        else if (fileSize <= 0) {\n            msgAvatarError = t('message.msg_err_file_size');\n        }\n        else if (fileSize > Constants.COMMON.MAX_IMAGE_SIZE) {\n            msgAvatarError = t('message.msg_err_max_size_upload');\n        }\n\n        var self = this;\n        var { curItem } = this.state;\n        if (!Libs.isBlank(msgAvatarError)) {\n            curItem.upload_thumbnail = '';\n            curItem.thumbnail_message = msgAvatarError;\n            this.setState({\n                curItem: curItem\n            });\n\n            return;\n        } else {\n            curItem.thumbnail_message = '';\n            this.setState({\n                curItem: curItem\n            });\n        }\n\n        //Read file upload\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            curItem.upload_thumbnail = e.target.result;\n            curItem.upload_thumbnail_name = fileName;\n            self.setState({\n                curItem: curItem\n            });\n        };\n        reader.readAsDataURL(file);\n    }\n\n\n    /**\n     * @description Delete icon upload \n     * @author Long.Pham 12/05/2021\n     */\n    onClickDeleteAvatar = (event) => {\n        var { curItem } = this.state;\n        curItem.thumbnail_message = '';\n        curItem.thumbnail_upload = '';\n        curItem.thumbnail = null;\n\n        this.setState({\n            curItem: curItem\n        });\n    }\n\n\n\n    /**\n     * ge list roles\n     * @author Long.Pham 2019-06-03\n     */\n    getDataProjectGroup() {\n        let self = this;\n        var params = {\n            id_language: this.employee.id_language\n        };\n\n        ProjectGroupService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataProjectGroup: data\n                });\n            } else {\n                self.setState({\n                    dataProjectGroup: []\n                });\n            }\n        })\n    }\n\n    handleDropdownChange = (item, name) => {\n        var self = this;\n        let curItem = self.state.curItem;\n\n        if (Libs.isObjectEmpty(item)) {\n            curItem.id_project_group = '';\n        } else {\n            var value = item.value;\n            curItem[name] = value;\n            self.setValidateMessage({ id_project_group: '' }, true);\n        }\n\n        self.setState({\n            curItem: curItem\n        });\n    }\n\n    onClickShowTab = (e, tabActive) => {\n        var curItem = this.state.curItem;\n        if (Libs.isBlank(tabActive)) return;\n        curItem.tabActive = tabActive;\n\n        this.setState({\n            curItem: curItem\n        });\n    }\n\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new AddPopupValidate(this.props);\n            let error = await v.validateOne(param, name);\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n\n    /**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n\n    handleInputTranslateChange = (event) => {\n        var target = event.target;\n        var name = target.name;\n        var value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n        if (name) {\n            let item = this.state.curItem;\n            let allLanguage = this.state.allLanguage;\n            let isoCode = name.substr(-2, 2),\n                dataName = name.substr(0, 4),\n                dataSiteName = name.substr(0,9),\n                dataDescription = name.substr(0, 11);\n\n            allLanguage.map((language, index) => {\n                if (isoCode === language.iso_code && dataName === 'name') {\n                    item.data[index].name = (event.target.validity.valid) ? value : this.state.curItem.data[index].name;\n                }\n\n                if (isoCode === language.iso_code && dataSiteName === 'site_name') {\n                    item.data[index].site_name = (event.target.validity.valid) ? value : this.state.curItem.data[index].site_name;\n                }\n\n                if (isoCode === language.iso_code && dataDescription === 'description') {\n                    item.data[index].description = (event.target.validity.valid) ? value : this.state.curItem.data[index].description;\n                }\n                return 1;\n            });\n\n            item[name] = (event.target.validity.valid) ? value : this.state.curItem[name];\n\n            this.setState({ curItem: item });\n        }\n    }\n\n\n\n    /**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */\n    async onSave() {\n        var {curItem, dataListEmployee} = this.state, self = this;\n        var params = Object.assign({}, this.state.curItem);\n        var screenMode = (!Libs.isBlank(curItem.id)) ? Constants.SCREEN_MODE.EDIT : ((!Libs.isBlank(this.props.curItem.screen_mode)) ? this.props.curItem.screen_mode : Constants.SCREEN_MODE.ADD);\n        let v = new AddPopupValidate(this.props);\n        let errors = await v.FLValidationAll(curItem);\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = screenMode;\n\n        params.iso_code_lang = this.employee.lang;\n        params.id_language = this.employee.id_language;\n        params.iso_code = this.employee.iso_code;\n\n        var dataEmployees = [];\n        if(Libs.isArrayData(dataListEmployee)){\n            for(var i = 0, len = dataListEmployee.length; i < len; i++){\n                if(dataListEmployee[i].is_checked){\n                    dataEmployees.push({\n                        id_project: null,\n                        id_employee: dataListEmployee[i].id\n                    })\n                }\n            }\n        }\n        params.dataEmployees = dataEmployees;\n\n        if (Libs.isArrayData(params.data)) {\n            let itemLanguageDefault = Libs.find(params.data, 'is_default', 1);\n            if (!itemLanguageDefault) return;\n\n            params.data.map((item, index) => {\n                params.data[index].name = (item.name === '') ? itemLanguageDefault.name : item.name;\n                params.data[index].site_name = (item.site_name === '') ? itemLanguageDefault.site_name : item.site_name;\n                params.data[index].description = (item.description === '') ? itemLanguageDefault.description : item.description;\n                return params;\n\n            });\n        } else { return false; }\n\n        ProjectService.instance.save(params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                self.props.onClickCloseAdd(true);\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n}\nexport default AddPopup;"]},"metadata":{},"sourceType":"module"}