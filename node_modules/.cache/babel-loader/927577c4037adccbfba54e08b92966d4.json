{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solarmon_production/solarmon_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../../../BaseComponent';import Libs from'../../../../../../utils/Libs';import Constants from'../../../../../../utils/Constants';import AddDeviceSharePopupJsx from'./AddDeviceSharePopup.jsx';import DeviceService from'../../../../../../services/DeviceService';import ProjectService from'../../../../../../services/ProjectService';var AddDeviceSharePopup=/*#__PURE__*/function(_BaseComponent){_inherits(AddDeviceSharePopup,_BaseComponent);var _super=_createSuper(AddDeviceSharePopup);function AddDeviceSharePopup(props){var _this;_classCallCheck(this,AddDeviceSharePopup);_this=_super.call(this,props);_this.onIsCheckedChange=function(index){var dataList=_this.state.dataList;if(!Libs.isArrayData(dataList))return;var item=dataList[index];if(Libs.isObjectEmpty(item))return;dataList[index].is_checked=dataList[index].is_checked?0:1;_this.setState({dataList:dataList});};_this.handleDropdownChange=function(item,name){var self=_assertThisInitialized(_this);var curItem=self.state.curItem;if(Libs.isObjectEmpty(item)){curItem.id_project='';}else{var value=item.value;curItem[name]=value;}self.setState({curItem:curItem},function(){self.getList();});};_this.state={curItem:{},curItemProject:_this.props.curItemProject,dataListProject:[],dataList:[],searchParam:{}};_this.jsxTemplate=AddDeviceSharePopupJsx;_this.handleDropdownChange=_this.handleDropdownChange.bind(_assertThisInitialized(_this));return _this;}/**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */_createClass(AddDeviceSharePopup,[{key:\"componentDidMount\",value:function componentDidMount(){this.getList();this.getDataListProject();}},{key:\"getList\",value:/**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */function getList(){var self=this;var curItem=this.state.curItem;var params=this.state.searchParam;params.id_language=this.employee.id_language;params.id_project=curItem.id_project;if(Libs.isBlank(curItem.id_project))return;DeviceService.instance.getListDeviceByProjectShare(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataList:data});}else{self.setState({dataList:[]});}self.forceUpdate();});}/**\n     * ge list project\n     * @author Long.Pham 2019-06-03\n     */},{key:\"getDataListProject\",value:function getDataListProject(){var self=this;var curItemProject=this.state.curItemProject;var params={id_language:this.employee.id_language,id_project:curItemProject.id?curItemProject.id:null};ProjectService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataListProject:data});}else{self.setState({dataListProject:[]});}});}},{key:\"onSave\",value:/**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */function(){var _onSave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state,curItemProject,dataList,self,params,dataParams,i,len;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=this.state,curItemProject=_this$state.curItemProject,dataList=_this$state.dataList,self=this;if(!(Libs.isBlank(curItemProject.id)||!Libs.isArrayData(dataList))){_context.next=3;break;}return _context.abrupt(\"return\");case 3:params={};dataParams=[];for(i=0,len=dataList.length;i<len;i++){if(dataList[i].is_checked==1){dataParams.push({id_project:curItemProject.id,id_device:dataList[i].id});}}if(Libs.isArrayData(dataParams)){_context.next=8;break;}return _context.abrupt(\"return\");case 8:params.dataParams=dataParams;params.screen_mode=Constants.SCREEN_MODE.ADD;DeviceService.instance.saveDeviceShare(params,function(status,data,msg){if(status){self.toast(msg,\"info\");self.props.onClickCloseDeviceShare(true);}else if(data){self.setValidateMessage(data);}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);case 11:case\"end\":return _context.stop();}}},_callee,this);}));function onSave(){return _onSave.apply(this,arguments);}return onSave;}()}]);return AddDeviceSharePopup;}(BaseComponent);export default AddDeviceSharePopup;","map":{"version":3,"sources":["/Volumes/Data/sources/solarmon_production/solarmon_frontend/src/containers/views/desktop/ModuleSystem/Project/AddDeviceShare/AddDeviceSharePopup.js"],"names":["BaseComponent","Libs","Constants","AddDeviceSharePopupJsx","DeviceService","ProjectService","AddDeviceSharePopup","props","onIsCheckedChange","index","dataList","state","isArrayData","item","isObjectEmpty","is_checked","setState","handleDropdownChange","name","self","curItem","id_project","value","getList","curItemProject","dataListProject","searchParam","jsxTemplate","bind","getDataListProject","params","id_language","employee","isBlank","instance","getListDeviceByProjectShare","data","total_row","forceUpdate","id","getDropdownList","dataParams","i","len","length","push","id_device","screen_mode","SCREEN_MODE","ADD","saveDeviceShare","status","msg","toast","onClickCloseDeviceShare","setValidateMessage"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../../../BaseComponent';\nimport Libs from '../../../../../../utils/Libs';\nimport Constants from '../../../../../../utils/Constants';\nimport AddDeviceSharePopupJsx from './AddDeviceSharePopup.jsx';\nimport DeviceService from '../../../../../../services/DeviceService';\nimport ProjectService from '../../../../../../services/ProjectService';\n\nclass AddDeviceSharePopup extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: {},\n            curItemProject: this.props.curItemProject,\n            dataListProject: [],\n            dataList: [],\n            searchParam: {},\n        }\n\n        this.jsxTemplate = AddDeviceSharePopupJsx;\n        this.handleDropdownChange = this.handleDropdownChange.bind(this);\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */\n    componentDidMount() {\n        this.getList();\n        this.getDataListProject();\n    }\n\n\n    onIsCheckedChange = (index) => {\n        var {dataList} = this.state;\n        if(!Libs.isArrayData(dataList)) return;\n        var item = dataList[index];\n        if(Libs.isObjectEmpty(item)) return;\n        dataList[index].is_checked = dataList[index].is_checked ? 0: 1;\n\n        this.setState({\n            dataList: dataList\n        });\n    }\n    /**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */\n    getList() {\n        let self = this;\n        var { curItem } = this.state;\n        let params = this.state.searchParam;\n        params.id_language = this.employee.id_language;\n        params.id_project = curItem.id_project;\n        if(Libs.isBlank(curItem.id_project)) return;\n        DeviceService.instance.getListDeviceByProjectShare(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataList: data\n                });\n            } else {\n                self.setState({\n                    dataList: []\n                });\n                \n            }\n            self.forceUpdate();\n        });\n    }\n\n    /**\n     * ge list project\n     * @author Long.Pham 2019-06-03\n     */\n     getDataListProject() {\n        let self = this;\n        var {curItemProject} = this.state;\n        var params = {\n            id_language: this.employee.id_language,\n            id_project: curItemProject.id ? curItemProject.id : null\n        };\n\n        ProjectService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataListProject: data\n                });\n            } else {\n                self.setState({\n                    dataListProject: []\n                });\n            }\n        })\n    }\n\n\n    handleDropdownChange = (item, name) => {\n        var self = this;\n        let curItem = self.state.curItem;\n\n        if (Libs.isObjectEmpty(item)) {\n            curItem.id_project = '';\n        } else {\n            var value = item.value;\n            curItem[name] = value;\n        }\n\n        self.setState({\n            curItem: curItem\n        }, () => {\n            self.getList();\n        });\n    }\n\n\n\n    /**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */\n    async onSave() {\n        var {curItemProject, dataList } = this.state, self = this;\n        if(Libs.isBlank(curItemProject.id) || !Libs.isArrayData(dataList)) return;\n        var params = {};\n        var dataParams = [];\n        for(var i = 0, len = dataList.length; i < len; i++){\n            if(dataList[i].is_checked == 1){\n                dataParams.push({\n                    id_project: curItemProject.id,\n                    id_device: dataList[i].id\n                })\n            }\n        }\n\n        if(!Libs.isArrayData(dataParams)) return;\n        params.dataParams = dataParams;\n        params.screen_mode = Constants.SCREEN_MODE.ADD;\n    \n        DeviceService.instance.saveDeviceShare(params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                self.props.onClickCloseDeviceShare(true);\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n}\nexport default AddDeviceSharePopup;"]},"metadata":{},"sourceType":"module"}