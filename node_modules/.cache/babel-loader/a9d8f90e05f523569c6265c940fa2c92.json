{"ast":null,"code":"import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import DeviceAlarmJsx from'./DeviceAlarm.jsx';import BaseComponent from'../../../../../BaseComponent';import Libs from'../../../../../../utils/Libs';import{withTranslation}from'react-i18next';import Constants from'../../../../../../utils/Constants';import ClientDeviceService from'../../../../../../services/ClientDeviceService';import ErrorLevelService from'../../../../../../services/ErrorLevelService';import ErrorTypeService from'../../../../../../services/ErrorTypeService';var DeviceAlarm=/*#__PURE__*/function(_BaseComponent){_inherits(DeviceAlarm,_BaseComponent);var _super=_createSuper(DeviceAlarm);function DeviceAlarm(props,context){var _this;_classCallCheck(this,DeviceAlarm);_this=_super.call(this,props,context);_this.handleDropdownChange=function(item,name){if(Libs.isObjectEmpty(item))return;var self=_assertThisInitialized(_this),value=item.value;var searchParam=self.state.searchParam;if(name==='id_error_level'){if(Libs.isObjectEmpty(item)){searchParam.id_error_level='';}}if(name==='id_error_type'){if(Libs.isObjectEmpty(item)){searchParam.id_error_type='';}}searchParam[name]=value;self.setState({searchParam:searchParam});};_this.jsxTemplate=DeviceAlarmJsx;_this.state={curItem:Object.assign({},_this.props.curItem),dataList:[],dataErrorLevel:[],dataErrorType:[],searchParam:{limit:Constants.COMMON.LIMIT,offset:0,index:1},formSearch:false,allLanguage:Libs.isBlank(_this.employee)?[]:_this.employee.languages};_this.paging={total:0,current:1,currentInput:1};_this.inputChangedHandler=_this.inputChangedHandler.bind(_assertThisInitialized(_this));_this.inputChangedEnter=_this.inputChangedEnter.bind(_assertThisInitialized(_this));_this.inputChangedBlue=_this.inputChangedBlue.bind(_assertThisInitialized(_this));_this.handleInputDateChange=_this.handleInputDateChange.bind(_assertThisInitialized(_this));return _this;}_createClass(DeviceAlarm,[{key:\"componentDidMount\",value:function componentDidMount(){this.getList();this.getListErrorLevel();this.getListErrorType();}/**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */},{key:\"handleInputDateChange\",value:function handleInputDateChange(event){var target=event.target;var name=target.name;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var searchParam=this.state.searchParam;searchParam[name]=value;this.setState({searchParam:searchParam});}}/**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */},{key:\"getListErrorType\",value:function getListErrorType(){var self=this;var params={id_language:this.employee.id_language};ErrorTypeService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataErrorType:data});}else{self.setState({dataErrorType:[]});}});}/**\n   * ge list error level\n   * @author Long.Pham 2019-06-03\n   */},{key:\"getListErrorLevel\",value:function getListErrorLevel(){var self=this;var params={id_language:this.employee.id_language};ErrorLevelService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataErrorLevel:data});}else{self.setState({dataErrorLevel:[]});}});}},{key:\"getList\",value:/**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */function getList(){var self=this;var curItem=this.state.curItem;var params=this.state.searchParam;params.id_language=this.employee.id_language;params.id=curItem.id;params.type='customer';ClientDeviceService.instance.getListAlertByDevice(params,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataList:data});var total=parseInt(total_row/self.state.searchParam.limit);if(total_row%self.state.searchParam.limit>0){total=total+1;}self.paging.total=total;self.paging.current=self.state.searchParam.index;self.paging.currentInput=self.state.searchParam.index;self.state.total_row=total_row;}else{self.setState({dataList:[],total_row:0});self.paging.total=0;self.paging.current=1;self.paging.currentInput=1;}self.forceUpdate();});}},{key:\"inputChangedHandler\",value:function inputChangedHandler(event){var self=this;var target=event.target;var name=target.name;var value=target.value;if(name==='current'){if(!Libs.isBlank(value)){var t=this.props.t;if(!Libs.isNumber(value)){self.toast(t('common.page_is_number'),\"error\");return;}}self.paging.currentInput=value;self.forceUpdate();}if(name==='limit'){var searchParam=this.state.searchParam;searchParam.limit=value;this.setState({searchParam:searchParam},function(){self.getList();});}}},{key:\"inputChangedEnter\",value:function inputChangedEnter(event){var self=this;if(event.key==='Enter'){var currentInput=this.paging.currentInput;if(!Libs.isBlank(currentInput)){var t=this.props.t;if(!Libs.isNumber(currentInput)){self.toast(t('common.page_is_number'),\"error\");return;}}if(Libs.isBlank(currentInput)&&!Libs.isNumber(currentInput))return;if(parseInt(currentInput)>this.paging.total){currentInput=self.paging.total;}if(currentInput<=0){currentInput=1;}self.paging.current=currentInput;self.paging.currentInput=currentInput;this.onSelectPage(currentInput);self.forceUpdate();}}},{key:\"inputChangedBlue\",value:function inputChangedBlue(event){var self=this;var target=event.target;var name=target.name;if(name==='current'){var currentInput=this.paging.currentInput;if(!Libs.isBlank(currentInput)){var t=this.props.t;if(!Libs.isNumber(currentInput)){self.toast(t('common.page_is_number'),\"error\");return;}}if(Libs.isBlank(currentInput)&&!Libs.isNumber(currentInput))return;if(parseInt(currentInput)>this.paging.total){currentInput=self.paging.total;}if(currentInput<=0){currentInput=1;}self.paging.current=currentInput;self.paging.currentInput=currentInput;this.onSelectPage(currentInput);self.forceUpdate();}}/**\n     * @description Select page in pagging\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */},{key:\"onSelectPage\",value:function onSelectPage(index){var self=this;self.state.searchParam.index=index;if(index>0){self.state.searchParam.offset=(index-1)*self.state.searchParam.limit;}else{self.state.searchParam.offset=0;}self.getList();}/**\n     * @description reload data\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */},{key:\"onClickReload\",value:function onClickReload(){var self=this;self.getList();}/**\n    * Func filter table\n    * @author Long.Pham 12-05-2021\n    * @param  {Object} e\n    */},{key:\"onSort\",value:function onSort(event,sortKey){this.state.searchParam.sort_column=sortKey;this.state.searchParam.order_by=this.state.searchParam.order_by===''||this.state.searchParam.order_by==='asc'?'desc':'asc';this.getList();}/**\n      * @description Call form search\n      * @author Long.Pham 12/05/2021\n      */},{key:\"onSearch\",value:function onSearch(){var formSearch=this.state.formSearch===false?true:false;this.setState({formSearch:formSearch});}},{key:\"onResetSearch\",value:function onResetSearch(){var self=this;var searchParam=this.state.searchParam;searchParam.date_from=null;searchParam.date_to=null;searchParam.id_error_level=null;searchParam.id_error_type=null;searchParam.index=1;searchParam.offset=0;self.paging.current=1;self.paging.currentInput=1;self.paging.total=1;self.setState({searchParam:searchParam},function(){self.getList();});}/**\n     * Func search\n     * @author Long.Pham 12/05/2021\n     * @param  {Object} e\n     */},{key:\"handleSearch\",value:function handleSearch(){this.getList();}},{key:\"render\",value:function render(){return this.jsxTemplate.call(this);}}]);return DeviceAlarm;}(BaseComponent);var HighOrderComponentTranslated=withTranslation('common')(DeviceAlarm);export default HighOrderComponentTranslated;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModuleProject/Device/DeviceAlarm/DeviceAlarm.js"],"names":["DeviceAlarmJsx","BaseComponent","Libs","withTranslation","Constants","ClientDeviceService","ErrorLevelService","ErrorTypeService","DeviceAlarm","props","context","handleDropdownChange","item","name","isObjectEmpty","self","value","searchParam","state","id_error_level","id_error_type","setState","jsxTemplate","curItem","Object","assign","dataList","dataErrorLevel","dataErrorType","limit","COMMON","LIMIT","offset","index","formSearch","allLanguage","isBlank","employee","languages","paging","total","current","currentInput","inputChangedHandler","bind","inputChangedEnter","inputChangedBlue","handleInputDateChange","getList","getListErrorLevel","getListErrorType","event","target","type","checked","params","id_language","instance","getDropdownList","data","total_row","isArrayData","id","getListAlertByDevice","parseInt","forceUpdate","t","isNumber","toast","key","onSelectPage","sortKey","sort_column","order_by","date_from","date_to","call","HighOrderComponentTranslated"],"mappings":"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","sourcesContent":["import DeviceAlarmJsx from './DeviceAlarm.jsx';\nimport BaseComponent from '../../../../../BaseComponent';\nimport Libs from '../../../../../../utils/Libs';\nimport { withTranslation } from 'react-i18next';\nimport Constants from '../../../../../../utils/Constants';\nimport ClientDeviceService from '../../../../../../services/ClientDeviceService';\nimport ErrorLevelService from '../../../../../../services/ErrorLevelService';\nimport ErrorTypeService from '../../../../../../services/ErrorTypeService';\n\nclass DeviceAlarm extends BaseComponent {\n\n    constructor(props, context) {\n        super(props, context);\n        this.jsxTemplate = DeviceAlarmJsx;\n        this.state = {\n            curItem: Object.assign({}, this.props.curItem),\n            dataList: [],\n            dataErrorLevel: [],\n            dataErrorType: [],\n            searchParam: {\n                limit: Constants.COMMON.LIMIT,\n                offset: 0,\n                index: 1,\n            },\n            formSearch: false,\n            allLanguage: Libs.isBlank(this.employee) ? [] : this.employee.languages\n        };\n\n        this.paging = {\n            total: 0,\n            current: 1,\n            currentInput: 1\n        };\n        this.inputChangedHandler = this.inputChangedHandler.bind(this);\n        this.inputChangedEnter = this.inputChangedEnter.bind(this);\n        this.inputChangedBlue = this.inputChangedBlue.bind(this);\n        this.handleInputDateChange = this.handleInputDateChange.bind(this);\n    }\n\n    componentDidMount() {\n        this.getList();\n        this.getListErrorLevel();\n        this.getListErrorType();\n    }\n\n    /**\n     * setValue method to Input\n     * @author Long.Pham 20/05/2021\n     */\n    handleInputDateChange(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n\n        if (name) {\n            let { searchParam } = this.state;\n            searchParam[name] = value;\n            this.setState({ searchParam: searchParam });\n        }\n    }\n\n    /**\n    * ge list error state\n    * @author Long.Pham 2019-06-03\n    */\n    getListErrorType() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        ErrorTypeService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataErrorType: data\n                });\n            } else {\n                self.setState({\n                    dataErrorType: []\n                });\n            }\n        })\n    }\n\n    /**\n   * ge list error level\n   * @author Long.Pham 2019-06-03\n   */\n    getListErrorLevel() {\n        let self = this;\n        var params = { id_language: this.employee.id_language };\n\n        ErrorLevelService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataErrorLevel: data\n                });\n            } else {\n                self.setState({\n                    dataErrorLevel: []\n                });\n            }\n        })\n    }\n\n\n\n\n    handleDropdownChange = (item, name) => {\n        if (Libs.isObjectEmpty(item)) return;\n        var self = this, value = item.value;\n        let { searchParam } = self.state;\n        if (name === 'id_error_level') {\n            if (Libs.isObjectEmpty(item)) {\n                searchParam.id_error_level = '';\n            }\n        }\n\n        if (name === 'id_error_type') {\n            if (Libs.isObjectEmpty(item)) {\n                searchParam.id_error_type = '';\n            }\n        }\n\n        searchParam[name] = value;\n        self.setState({\n            searchParam: searchParam\n        });\n    }\n\n    /**\n     * get list\n     * @author Long.Pham 2019-06-03\n     */\n    getList() {\n        let self = this;\n        var { curItem } = this.state;\n        let params = this.state.searchParam;\n        params.id_language = this.employee.id_language;\n        params.id = curItem.id;\n        params.type = 'customer';\n        \n        ClientDeviceService.instance.getListAlertByDevice(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataList: data\n                });\n\n                var total = parseInt(total_row / self.state.searchParam.limit);\n                if (total_row % self.state.searchParam.limit > 0) {\n                    total = total + 1;\n                }\n                self.paging.total = total;\n                self.paging.current = self.state.searchParam.index;\n                self.paging.currentInput = self.state.searchParam.index;\n                self.state.total_row = total_row;\n\n            } else {\n                self.setState({\n                    dataList: [],\n                    total_row: 0\n                });\n                self.paging.total = 0;\n                self.paging.current = 1;\n                self.paging.currentInput = 1;\n            }\n            self.forceUpdate();\n        });\n    }\n\n\n    inputChangedHandler(event) {\n        let self = this;\n        let target = event.target;\n        let name = target.name;\n        let value = target.value;\n        if (name === 'current') {\n            if (!Libs.isBlank(value)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(value)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            self.paging.currentInput = value;\n            self.forceUpdate();\n        }\n\n        if (name === 'limit') {\n            var { searchParam } = this.state;\n            searchParam.limit = value;\n            this.setState({\n                searchParam: searchParam\n            }, () => {\n                self.getList();\n            })\n        }\n    }\n\n    inputChangedEnter(event) {\n        let self = this;\n        if (event.key === 'Enter') {\n            var currentInput = this.paging.currentInput;\n            if (!Libs.isBlank(currentInput)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(currentInput)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n            if (parseInt(currentInput) > this.paging.total) {\n                currentInput = self.paging.total;\n            }\n\n            if (currentInput <= 0) {\n                currentInput = 1;\n            }\n\n            self.paging.current = currentInput;\n            self.paging.currentInput = currentInput;\n            this.onSelectPage(currentInput);\n            self.forceUpdate();\n        }\n    }\n\n    inputChangedBlue(event) {\n        let self = this;\n        let target = event.target;\n        let name = target.name;\n        if (name === 'current') {\n            var currentInput = this.paging.currentInput;\n            if (!Libs.isBlank(currentInput)) {\n                var { t } = this.props;\n                if (!Libs.isNumber(currentInput)) {\n                    self.toast(t('common.page_is_number'), \"error\");\n                    return;\n                }\n            }\n\n            if (Libs.isBlank(currentInput) && !Libs.isNumber(currentInput)) return;\n            if (parseInt(currentInput) > this.paging.total) {\n                currentInput = self.paging.total;\n            }\n\n            if (currentInput <= 0) {\n                currentInput = 1;\n            }\n\n            self.paging.current = currentInput;\n            self.paging.currentInput = currentInput;\n            this.onSelectPage(currentInput);\n            self.forceUpdate();\n        }\n    }\n\n\n    /**\n     * @description Select page in pagging\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */\n    onSelectPage(index) {\n        let self = this;\n        self.state.searchParam.index = index;\n\n        if (index > 0) {\n            self.state.searchParam.offset = (index - 1) * self.state.searchParam.limit;\n        } else {\n            self.state.searchParam.offset = 0;\n        }\n        self.getList();\n    }\n\n\n    /**\n     * @description reload data\n     * @author long.pham 09/05/2021\n     * @param {int} index\n     */\n    onClickReload() {\n        let self = this;\n        self.getList();\n    }\n\n\n    /**\n    * Func filter table\n    * @author Long.Pham 12-05-2021\n    * @param  {Object} e\n    */\n\n    onSort(event, sortKey) {\n        this.state.searchParam.sort_column = sortKey;\n        this.state.searchParam.order_by = (this.state.searchParam.order_by === '' || this.state.searchParam.order_by === 'asc') ? 'desc' : 'asc';\n        this.getList();\n    }\n\n    /**\n      * @description Call form search\n      * @author Long.Pham 12/05/2021\n      */\n    onSearch() {\n        let formSearch = (this.state.formSearch === false) ? true : false;\n        this.setState({\n            formSearch: formSearch\n        });\n    }\n\n    onResetSearch() {\n        let self = this;\n        let searchParam = this.state.searchParam;\n        searchParam.date_from = null;\n        searchParam.date_to = null;\n        searchParam.id_error_level = null;\n        searchParam.id_error_type = null;\n        searchParam.index = 1;\n        searchParam.offset = 0;\n        self.paging.current = 1;\n        self.paging.currentInput = 1;\n        self.paging.total = 1;\n        self.setState({\n            searchParam: searchParam\n        }, () => {\n            self.getList();\n        });\n    }\n\n    /**\n     * Func search\n     * @author Long.Pham 12/05/2021\n     * @param  {Object} e\n     */\n    handleSearch() {\n        this.getList();\n    }\n\n    render() {\n        return this.jsxTemplate.call(this)\n    }\n}\n\nconst HighOrderComponentTranslated = withTranslation('common')(DeviceAlarm)\nexport default HighOrderComponentTranslated;"]},"metadata":{},"sourceType":"module"}