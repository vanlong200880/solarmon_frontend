{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import BaseComponent from'../../../../BaseComponent';import Libs from'../../../../../utils/Libs';import Constants from'../../../../../utils/Constants';import AddPopupJsx from'./AddPopup.jsx';import AddPopupValidate from'./AddPopupValidate';import RoleService from'../../../../../services/RoleService';var AddPopup=/*#__PURE__*/function(_BaseComponent){_inherits(AddPopup,_BaseComponent);var _super=_createSuper(AddPopup);function AddPopup(props){var _this;_classCallCheck(this,AddPopup);_this=_super.call(this,props);_this.onClickShowTab=function(e,tabActive){var curItem=_this.state.curItem;if(Libs.isBlank(tabActive))return;curItem.tabActive=tabActive;_this.setState({curItem:curItem});};_this.handleInputTranslateChange=function(event){var target=event.target;var name=target.name;var value=target.value;if(target.type==='checkbox'){value=target.checked?1:0;}if(name){var item=_this.state.curItem;var allLanguage=_this.state.allLanguage;var isoCode=name.substr(-2,2),dataName=name.substr(0,4),dataDescription=name.substr(0,11);allLanguage.map(function(language,index){if(isoCode===language.iso_code&&dataName==='name'){item.data[index].name=event.target.validity.valid?value:_this.state.curItem.data[index].name;}if(isoCode===language.iso_code&&dataDescription==='description'){item.data[index].description=event.target.validity.valid?value:_this.state.curItem.data[index].description;}return 1;});item[name]=event.target.validity.valid?value:_this.state.curItem[name];_this.setState({curItem:item});}};_this.state={curItem:_this.props.curItem,allLanguage:_this.props.allLanguage};_this.jsxTemplate=AddPopupJsx;return _this;}/**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */_createClass(AddPopup,[{key:\"componentDidMount\",value:function componentDidMount(){}},{key:\"validateOne\",value:/**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */function(){var _validateOne=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var target,name,value,param,v,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:target=event.target;name=target.name;value=target.value;if(!name){_context.next=10;break;}param=_defineProperty({},name,value);v=new AddPopupValidate(this.props);_context.next=8;return v.validateOne(param,name);case 8:error=_context.sent;if(error!=null){this.setValidateMessage(error,true);}case 10:case\"end\":return _context.stop();}}},_callee,this);}));function validateOne(_x){return _validateOne.apply(this,arguments);}return validateOne;}()/**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */},{key:\"onSave\",value:/**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */function(){var _onSave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var curItem,self,params,screenMode,v,errors,itemLanguageDefault;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:curItem=this.state.curItem,self=this;params=Object.assign({},this.state.curItem);screenMode=!Libs.isBlank(curItem.id)?Constants.SCREEN_MODE.EDIT:!Libs.isBlank(this.props.curItem.screen_mode)?this.props.curItem.screen_mode:Constants.SCREEN_MODE.ADD;v=new AddPopupValidate(this.props);_context2.next=6;return v.FLValidationAll(curItem);case 6:errors=_context2.sent;if(!errors){_context2.next=10;break;}this.setValidateMessage(errors);return _context2.abrupt(\"return\");case 10://remove message validation\nthis.removeAllValidateMessage();params.screen_mode=screenMode;params.iso_code_lang=this.employee.lang;params.id_language=this.employee.id_language;params.iso_code=this.employee.iso_code;params.status=1;if(!Libs.isArrayData(params.data)){_context2.next=23;break;}itemLanguageDefault=Libs.find(params.data,'is_default',1);if(itemLanguageDefault){_context2.next=20;break;}return _context2.abrupt(\"return\");case 20:params.data.map(function(item,index){params.data[index].name=item.name===''?itemLanguageDefault.name:item.name;params.data[index].description=item.description===''?itemLanguageDefault.description:item.description;return params;});_context2.next=24;break;case 23:return _context2.abrupt(\"return\",false);case 24:RoleService.instance.save(params,function(status,data,msg){if(status){self.toast(msg,\"info\");self.props.onClickCloseAdd(true);}else if(data){self.setValidateMessage(data);}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);case 25:case\"end\":return _context2.stop();}}},_callee2,this);}));function onSave(){return _onSave.apply(this,arguments);}return onSave;}()}]);return AddPopup;}(BaseComponent);export default AddPopup;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModuleSystem/Role/AddPopup.js"],"names":["BaseComponent","Libs","Constants","AddPopupJsx","AddPopupValidate","RoleService","AddPopup","props","onClickShowTab","e","tabActive","curItem","state","isBlank","setState","handleInputTranslateChange","event","target","name","value","type","checked","item","allLanguage","isoCode","substr","dataName","dataDescription","map","language","index","iso_code","data","validity","valid","description","jsxTemplate","param","v","validateOne","error","setValidateMessage","self","params","Object","assign","screenMode","id","SCREEN_MODE","EDIT","screen_mode","ADD","FLValidationAll","errors","removeAllValidateMessage","iso_code_lang","employee","lang","id_language","status","isArrayData","itemLanguageDefault","find","instance","save","msg","toast","onClickCloseAdd"],"mappings":"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","sourcesContent":["\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport Constants from '../../../../../utils/Constants';\nimport AddPopupJsx from './AddPopup.jsx';\nimport AddPopupValidate from './AddPopupValidate';\nimport RoleService from '../../../../../services/RoleService';\n\nclass AddPopup extends BaseComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            curItem: this.props.curItem,\n            allLanguage: this.props.allLanguage\n        }\n\n        this.jsxTemplate = AddPopupJsx;\n    }\n    /**\n     * @description Called immediately after the component is mounted in the DOM. Called after the render function\n     * @author Long.Pham 12/05/2021\n     */\n    componentDidMount() {\n    }\n\n    onClickShowTab = (e, tabActive) => {\n        var curItem = this.state.curItem;\n        if (Libs.isBlank(tabActive)) return;\n        curItem.tabActive = tabActive;\n\n        this.setState({\n            curItem: curItem\n        });\n    }\n\n\n    /**\n     * @description validate a field input\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n    async validateOne(event) {\n        let target = event.target;\n        let name = target.name;\n        let value = target.value\n        if (name) {\n            let param = {\n                [name]: value\n            }\n            let v = new AddPopupValidate(this.props);\n            let error = await v.validateOne(param, name);\n            if (error != null) {\n                this.setValidateMessage(error, true);\n            }\n        }\n    }\n\n    /**\n     * @description select change\n     * @author Long.Pham 12/05/2021\n     * @param {*} event \n     */\n\n    handleInputTranslateChange = (event) => {\n        var target = event.target;\n        var name = target.name;\n        var value = target.value;\n        if (target.type === 'checkbox') {\n            value = target.checked ? 1 : 0;\n        }\n        if (name) {\n            let item = this.state.curItem;\n            let allLanguage = this.state.allLanguage;\n            let isoCode = name.substr(-2, 2),\n                dataName = name.substr(0, 4),\n                dataDescription = name.substr(0, 11);\n\n            allLanguage.map((language, index) => {\n                if (isoCode === language.iso_code && dataName === 'name') {\n                    item.data[index].name = (event.target.validity.valid) ? value : this.state.curItem.data[index].name;\n                }\n\n                if (isoCode === language.iso_code && dataDescription === 'description') {\n                    item.data[index].description = (event.target.validity.valid) ? value : this.state.curItem.data[index].description;\n                }\n                return 1;\n            });\n\n            item[name] = (event.target.validity.valid) ? value : this.state.curItem[name];\n\n            this.setState({ curItem: item });\n        }\n    }\n\n\n\n    /**\n     * @description save data\n     * @author long.pham 12/05/2021\n     */\n    async onSave() {\n        var curItem = this.state.curItem, self = this;\n        var params = Object.assign({}, this.state.curItem);\n        var screenMode = (!Libs.isBlank(curItem.id)) ? Constants.SCREEN_MODE.EDIT : ((!Libs.isBlank(this.props.curItem.screen_mode)) ? this.props.curItem.screen_mode : Constants.SCREEN_MODE.ADD);\n        let v = new AddPopupValidate(this.props);\n        let errors = await v.FLValidationAll(curItem);\n        if (errors) {\n            this.setValidateMessage(errors);\n            return;\n        }\n        //remove message validation\n        this.removeAllValidateMessage();\n        params.screen_mode = screenMode;\n        params.iso_code_lang = this.employee.lang;\n        params.id_language = this.employee.id_language;\n        params.iso_code = this.employee.iso_code;\n        params.status = 1;\n\n        if (Libs.isArrayData(params.data)) {\n            let itemLanguageDefault = Libs.find(params.data, 'is_default', 1);\n            if (!itemLanguageDefault) return;\n\n            params.data.map((item, index) => {\n                params.data[index].name = (item.name === '') ? itemLanguageDefault.name : item.name;\n                params.data[index].description = (item.description === '') ? itemLanguageDefault.description : item.description;\n                return params;\n\n            });\n        } else { return false; }\n\n        RoleService.instance.save( params, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                self.props.onClickCloseAdd(true);\n            }\n            else if (data) {\n                self.setValidateMessage(data);\n            }\n\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n    }\n}\nexport default AddPopup;"]},"metadata":{},"sourceType":"module"}