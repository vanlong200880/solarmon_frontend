{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Volumes/Data/sources/solars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import PermissionsJsx from'./Permissions.jsx';import BaseComponent from'../../../../BaseComponent';import Libs from'../../../../../utils/Libs';import{withTranslation}from'react-i18next';import Constants from'../../../../../utils/Constants';import'./Permissions.scss';import RoleService from'../../../../../services/RoleService';var Permissions=/*#__PURE__*/function(_BaseComponent){_inherits(Permissions,_BaseComponent);var _super=_createSuper(Permissions);function Permissions(props,context){var _this;_classCallCheck(this,Permissions);_this=_super.call(this,props,context);_this.handleInputChange=function(event,item,dataKey,vAuth,index){var self=_assertThisInitialized(_this);var checked=event.target.checked;var mask=0;var dataList=_this.state.dataList;if(checked){for(var k=0;k<vAuth+1;k++){mask=1<<k;}// add view permission if other permission has been checked\nif(!Libs.isBlank(vAuth)&&vAuth!=Constants.AUTH_MODE.VIEW){item[Constants.AUTH_DATA_KEY.VIEW]=1;}}else{if(!Libs.isBlank(vAuth)&&vAuth==Constants.AUTH_MODE.VIEW){item[Constants.AUTH_DATA_KEY.NEW]=0;item[Constants.AUTH_DATA_KEY.EDIT]=0;item[Constants.AUTH_DATA_KEY.DEL]=0;item[Constants.AUTH_DATA_KEY.PRINT]=0;item[Constants.AUTH_DATA_KEY.PDF]=0;item[Constants.AUTH_DATA_KEY.EXCEL]=0;item[Constants.AUTH_DATA_KEY.TRANSLATE]=0;item[Constants.AUTH_DATA_KEY.APPROVAL]=0;item[Constants.AUTH_DATA_KEY.FULL]=0;}}item[dataKey]=mask;if(parseInt(item.has_child)===1){dataList.map(function(value,key){if(item.id===value.parent){var maskTemp=0;if(checked){for(var _k=0;_k<vAuth+1;_k++){maskTemp=1<<_k;}// add view permission if other permission has been checked\nif(!Libs.isBlank(vAuth)&&vAuth!==Constants.AUTH_MODE.VIEW){value[Constants.AUTH_DATA_KEY.VIEW]=1;}}else{if(!Libs.isBlank(vAuth)&&vAuth===Constants.AUTH_MODE.VIEW){value[Constants.AUTH_DATA_KEY.NEW]=0;value[Constants.AUTH_DATA_KEY.EDIT]=0;value[Constants.AUTH_DATA_KEY.DEL]=0;value[Constants.AUTH_DATA_KEY.PRINT]=0;value[Constants.AUTH_DATA_KEY.PDF]=0;value[Constants.AUTH_DATA_KEY.EXCEL]=0;value[Constants.AUTH_DATA_KEY.TRANSLATE]=0;value[Constants.AUTH_DATA_KEY.APPROVAL]=0;value[Constants.AUTH_DATA_KEY.FULL]=0;}}value[dataKey]=maskTemp;value=_this._setAuths(value);dataList[key]=value;}});}dataList[index]=item;// if (parseInt(item.has_child) === 1) {\n// dataList.map((value, key) => {\n//     if (item.id === value.parent) {\n//         let action = 0;\n//         let maskTemp = 0;\n//         if (checked) {\n//             // for (let k = 0; k < vAuth + 1; k++) {\n//             //     maskTemp = 1 << k;\n//             // }\n//             // add view permission if other permission has been checked\n//             if (!Libs.isBlank(vAuth) && vAuth !== Constants.AUTH_MODE.VIEW) {\n//                 value[Constants.AUTH_DATA_KEY.VIEW] = 1;\n//             }\n//         } else {\n//             if (!Libs.isBlank(vAuth) && vAuth === Constants.AUTH_MODE.VIEW) {\n//                 value[Constants.AUTH_DATA_KEY.NEW] = 0;\n//                 value[Constants.AUTH_DATA_KEY.EDIT] = 0;\n//                 value[Constants.AUTH_DATA_KEY.DEL] = 0;\n//                 value[Constants.AUTH_DATA_KEY.PRINT] = 0;\n//                 value[Constants.AUTH_DATA_KEY.PDF] = 0;\n//                 value[Constants.AUTH_DATA_KEY.EXCEL] = 0;\n//                 value[Constants.AUTH_DATA_KEY.TRANSLATE] = 0;\n//                 value[Constants.AUTH_DATA_KEY.APPROVAL] = 0;\n//                 value[Constants.AUTH_DATA_KEY.FULL] = 0;\n//             }\n//         }\n//         // value[dataKey] = maskTemp;\n//         value = this._setAuths(value);\n//     }\n// });\n// } else {\n// dataList.map((v, k) => {\n//     if (v.id == item.parent) {\n//         var dataLevel = dataList.filter((k) => k.parent === item.parent);\n//         if (Libs.isArrayData(dataLevel)) {\n//             var countNew = 0, countEdit = 0, countView = 0, countDelete = 0, countPrint = 0, countApproval = 0, countPdf = 0, countExcel = 0, countTranslate = 0;\n//             dataLevel.map((val, key) => {\n//                 if (val.id === item.id) {\n//                     v[key] = item;\n//                     if (item.new > 0) { countNew++; }\n//                     if (item.edit > 0) { countEdit++; }\n//                     if (item.view > 0) { countView++; }\n//                     if (item.delete > 0) { countDelete++; }\n//                     if (item.print > 0) { countPrint++; }\n//                     if (item.pdf > 0) { countPdf++; }\n//                     if (item.excel > 0) { countExcel++; }\n//                     if (item.translate > 0) { countTranslate++; }\n//                     if (item.approval > 0) { countApproval++; }\n//                 } else {\n//                     if (val.new > 0) { countNew++; }\n//                     if (val.edit > 0) { countEdit++; }\n//                     if (val.view > 0) { countView++; }\n//                     if (val.delete > 0) { countDelete++; }\n//                     if (val.print > 0) { countPrint++; }\n//                     if (val.pdf > 0) { countPdf++; }\n//                     if (val.excel > 0) { countExcel++; }\n//                     if (val.translate > 0) { countTranslate++; }\n//                     if (val.approval > 0) { countApproval++; }\n//                 }\n//             });\n//             if (countNew > 0) { v[Constants.AUTH_DATA_KEY.NEW] = 2; } else { v[Constants.AUTH_DATA_KEY.NEW] = 0; }\n//             if (countEdit > 0) { v[Constants.AUTH_DATA_KEY.EDIT] = 8; } else { v[Constants.AUTH_DATA_KEY.EDIT] = 0; }\n//             if (countView > 0) { v[Constants.AUTH_DATA_KEY.VIEW] = 1; } else { v[Constants.AUTH_DATA_KEY.VIEW] = 0; }\n//             if (countDelete > 0) { v[Constants.AUTH_DATA_KEY.DEL] = 4; } else { v[Constants.AUTH_DATA_KEY.DEL] = 0; }\n//             if (countPrint > 0) { v[Constants.AUTH_DATA_KEY.PRINT] = 64; } else { v[Constants.AUTH_DATA_KEY.PRINT] = 0; }\n//             if (countPdf > 0) { v[Constants.AUTH_DATA_KEY.PDF] = 32; } else { v[Constants.AUTH_DATA_KEY.PDF] = 0; }\n//             if (countExcel > 0) { v[Constants.AUTH_DATA_KEY.EXCEL] = 16; } else { v[Constants.AUTH_DATA_KEY.EXCEL] = 0; }\n//             if (countApproval > 0) { v[Constants.AUTH_DATA_KEY.APPROVAL] = 256; } else { v[Constants.AUTH_DATA_KEY.APPROVAL] = 0; }\n//             if (countTranslate > 0) { v[Constants.AUTH_DATA_KEY.TRANSLATE] = 128; } else { v[Constants.AUTH_DATA_KEY.TRANSLATE] = 0; }\n//             v = this._setAuths(v);\n//             dataList[k] = v;\n//         }\n//     }\n// });\n// }\nitem=_this._setAuths(item);self.setState({dataList:dataList});_this._updateData(item);};_this._selectFullCheckedChange=function(event,item,index){var self=_assertThisInitialized(_this);var checked=event.target.checked;var mask=0;var dataList=_this.state.dataList;if(checked){mask=511;dataList[index].auths=mask;if(parseInt(item.has_child)===1){dataList.map(function(v,k){if(parseInt(item.id)===parseInt(v.parent)){dataList[k].auths=mask;}});}else{var findParent=Libs.find(dataList,'id',item.parent);if(!Libs.isObjectEmpty(findParent)){dataList.map(function(m,n){if(parseInt(findParent.id)===parseInt(m.id)){dataList[n].auths=mask;}});}}}else{dataList[index].auths=mask;if(parseInt(item.has_child)===1){dataList.map(function(v,k){if(parseInt(item.id)===parseInt(v.parent)){dataList[k].auths=0;}});}}self.setState({dataList:dataList});_this._updateData(item);};_this.handleDropdownChange=function(obj){if(Libs.isObjectEmpty(obj))return;var curItem=_this.state.curItem;curItem=obj;var self=_assertThisInitialized(_this);self.setState({curItem:curItem},function(){self.getListScreenPermissions();});};_this.jsxTemplate=PermissionsJsx;_this.state={curItem:{},dataList:[],dataRoles:[],searchParam:{limit:Constants.COMMON.LIMIT,offset:0,index:1}};_this._selectFullCheckedChange=_this._selectFullCheckedChange.bind(_assertThisInitialized(_this));_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));return _this;}_createClass(Permissions,[{key:\"componentDidMount\",value:function componentDidMount(){this.getDataRole();}},{key:\"_setPermissions\",value:function _setPermissions(data){data.view=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.VIEW));data.new=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.NEW));data.edit=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.EDIT));data.excel=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.EXCEL));data.pdf=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.PDF));data.translate=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.TRANSLATE));data.print=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.PRINT));data.delete=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.DEL));data.approval=data.auths&parseInt(Math.pow(2,Constants.AUTH_MODE.APPROVAL));return data;}},{key:\"_setAuths\",value:function _setAuths(data){data.auths=data.view+data.new+data.edit+data.excel+data.pdf+data.translate+data.print+data.delete+data.approval;return data;}},{key:\"_updateData\",value:/**\n     * Update quyền đã chọn\n     * @author Long.Pham 2019-09-20\n     * @param {Array} data\n     */function(){var _updateData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var t,self,screens,curItem,dataList,item,dataParent;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:t=this.props.t;self=this,screens=[];curItem=self.state.curItem;if(!Libs.isObjectEmpty(data)){_context.next=6;break;}this.toast(t(\"message.msg_err_unknown\"),\"error\");return _context.abrupt(\"return\");case 6:dataList=self.state.dataList;if(Libs.isBlank(data.has_child)){_context.next=12;break;}screens.push({id_role:curItem.id_role,id_screen:data.id_screen,id_package_screen:data.id_package_screen,auths:data.auths});if(Libs.isArrayData(dataList)){dataList.map(function(v,k){if(v.parent===data.id){screens.push({id_role:curItem.id_role,id_screen:v.id_screen,id_package_screen:v.id_package_screen,auths:v.auths});}});}_context.next=20;break;case 12:if(Libs.isArrayData(dataList)){_context.next=14;break;}return _context.abrupt(\"return\");case 14:item=Libs.find(dataList,'id',data.id);if(!Libs.isObjectEmpty(item)){_context.next=17;break;}return _context.abrupt(\"return\");case 17:screens.push({id_role:curItem.id_role,id_screen:data.id_screen,id_package_screen:data.id_package_screen,auths:data.auths});dataParent=Libs.find(dataList,'id',data.parent);if(!Libs.isObjectEmpty(dataParent)){screens.push({id_role:curItem.id_role,id_screen:dataParent.id_screen,id_package_screen:dataParent.id_package_screen,auths:dataParent.auths});}case 20:if(Libs.isArrayData(screens)){_context.next=23;break;}this.toast(t(\"message.msg_err_unknown\"),\"error\");return _context.abrupt(\"return\");case 23:curItem.screens=screens;RoleService.instance.updateRolePermissions(curItem,function(status,msg){if(status){self.getListScreenPermissions();}else{self.toast(msg,\"error\");}});this.setState({dataList:dataList});case 26:case\"end\":return _context.stop();}}},_callee,this);}));function _updateData(_x){return _updateData2.apply(this,arguments);}return _updateData;}()},{key:\"getDataRole\",value:/**\n         * ge list roles\n         * @author Long.Pham 2019-06-03\n         */function getDataRole(){var self=this,curItem=this.state.curItem;var params=self.state.searchParam;params.id_company=this.employee.id_company;params.id_language=this.employee.id_language;RoleService.instance.getDropdownList(params,function(data,total_row){if(Libs.isArrayData(data)){curItem=data[0];self.setState({dataRoles:data,curItem:curItem},function(){self.getListScreenPermissions();});}});}/**\n     * get list screen\n     * @author long.pham 27/07/2019\n     */},{key:\"getListScreenPermissions\",value:function getListScreenPermissions(){var self=this,curItem=this.state.curItem;curItem.id_language=this.employee.id_language;curItem.id_role=curItem.id;RoleService.instance.getListScreenPermissions(curItem,function(data,total_row){if(Libs.isArrayData(data)){self.setState({dataList:data});}else{self.setState({dataList:[]});}});}},{key:\"onClickUpdateRole\",value:function onClickUpdateRole(){var curItem=this.state.curItem,self=this;RoleService.instance.updateRoleMapScreen(curItem,function(status,data,msg){if(status){self.toast(msg,\"info\");self.getListScreenPermissions();}else if(!Libs.isBlank(msg)){self.toast(msg,\"error\");}},true);}},{key:\"render\",value:function render(){return this.jsxTemplate.call(this);}}]);return Permissions;}(BaseComponent);var HighOrderComponentTranslated=withTranslation('common')(Permissions);export default HighOrderComponentTranslated;","map":{"version":3,"sources":["/Volumes/Data/sources/solars/frontend/src/containers/views/desktop/ModuleSystem/Permissions/Permissions.js"],"names":["PermissionsJsx","BaseComponent","Libs","withTranslation","Constants","RoleService","Permissions","props","context","handleInputChange","event","item","dataKey","vAuth","index","self","checked","target","mask","dataList","state","k","isBlank","AUTH_MODE","VIEW","AUTH_DATA_KEY","NEW","EDIT","DEL","PRINT","PDF","EXCEL","TRANSLATE","APPROVAL","FULL","parseInt","has_child","map","value","key","id","parent","maskTemp","_setAuths","setState","_updateData","_selectFullCheckedChange","auths","v","findParent","find","isObjectEmpty","m","n","handleDropdownChange","obj","curItem","getListScreenPermissions","jsxTemplate","dataRoles","searchParam","limit","COMMON","LIMIT","offset","bind","getDataRole","data","view","Math","pow","new","edit","excel","pdf","translate","print","delete","approval","t","screens","toast","push","id_role","id_screen","id_package_screen","isArrayData","dataParent","instance","updateRolePermissions","status","msg","params","id_company","employee","id_language","getDropdownList","total_row","updateRoleMapScreen","call","HighOrderComponentTranslated"],"mappings":"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","sourcesContent":["import PermissionsJsx from './Permissions.jsx';\nimport BaseComponent from '../../../../BaseComponent';\nimport Libs from '../../../../../utils/Libs';\nimport { withTranslation } from 'react-i18next';\nimport Constants from '../../../../../utils/Constants';\nimport './Permissions.scss';\nimport RoleService from '../../../../../services/RoleService';\n\nclass Permissions extends BaseComponent {\n\n    constructor(props, context) {\n        super(props, context);\n        this.jsxTemplate = PermissionsJsx;\n        this.state = {\n            curItem: {},\n            dataList: [],\n            dataRoles: [],\n            searchParam: {\n                limit: Constants.COMMON.LIMIT,\n                offset: 0,\n                index: 1,\n            }\n        };\n\n        this._selectFullCheckedChange = this._selectFullCheckedChange.bind(this);\n        this.handleInputChange = this.handleInputChange.bind(this);\n    }\n\n    componentDidMount() {\n        this.getDataRole();\n    }\n\n    _setPermissions(data) {\n        data.view = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.VIEW));\n        data.new = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.NEW));\n        data.edit = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.EDIT));\n        data.excel = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.EXCEL));\n        data.pdf = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.PDF));\n        data.translate = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.TRANSLATE));\n        data.print = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.PRINT));\n        data.delete = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.DEL));\n        data.approval = data.auths & parseInt(Math.pow(2, Constants.AUTH_MODE.APPROVAL));\n        return data;\n    }\n    _setAuths(data) {\n        data.auths = data.view + data.new + data.edit + data.excel + data.pdf + data.translate + data.print + data.delete + data.approval;\n        return data;\n    }\n\n\n    handleInputChange = (event, item, dataKey, vAuth, index) => {\n        let self = this;\n        let checked = event.target.checked;\n        let mask = 0;\n        let dataList = this.state.dataList;\n\n        if (checked) {\n            for (let k = 0; k < vAuth + 1; k++) {\n                mask = 1 << k;\n            }\n\n            // add view permission if other permission has been checked\n            if (!Libs.isBlank(vAuth) && vAuth != Constants.AUTH_MODE.VIEW) {\n                item[Constants.AUTH_DATA_KEY.VIEW] = 1;\n            }\n\n        } else {\n            if (!Libs.isBlank(vAuth) && vAuth == Constants.AUTH_MODE.VIEW) {\n                item[Constants.AUTH_DATA_KEY.NEW] = 0;\n                item[Constants.AUTH_DATA_KEY.EDIT] = 0;\n                item[Constants.AUTH_DATA_KEY.DEL] = 0;\n                item[Constants.AUTH_DATA_KEY.PRINT] = 0;\n                item[Constants.AUTH_DATA_KEY.PDF] = 0;\n                item[Constants.AUTH_DATA_KEY.EXCEL] = 0;\n                item[Constants.AUTH_DATA_KEY.TRANSLATE] = 0;\n                item[Constants.AUTH_DATA_KEY.APPROVAL] = 0;\n                item[Constants.AUTH_DATA_KEY.FULL] = 0;\n            }\n        }\n\n        item[dataKey] = mask;\n\n        if (parseInt(item.has_child) === 1) {\n            dataList.map((value, key) => {\n                if (item.id === value.parent) {\n                    let maskTemp = 0;\n                    if (checked) {\n                        for (let k = 0; k < vAuth + 1; k++) {\n                            maskTemp = 1 << k;\n                        }\n                        // add view permission if other permission has been checked\n                        if (!Libs.isBlank(vAuth) && vAuth !== Constants.AUTH_MODE.VIEW) {\n                            value[Constants.AUTH_DATA_KEY.VIEW] = 1;\n                        }\n                    } else {\n                        if (!Libs.isBlank(vAuth) && vAuth === Constants.AUTH_MODE.VIEW) {\n                            value[Constants.AUTH_DATA_KEY.NEW] = 0;\n                            value[Constants.AUTH_DATA_KEY.EDIT] = 0;\n                            value[Constants.AUTH_DATA_KEY.DEL] = 0;\n                            value[Constants.AUTH_DATA_KEY.PRINT] = 0;\n                            value[Constants.AUTH_DATA_KEY.PDF] = 0;\n                            value[Constants.AUTH_DATA_KEY.EXCEL] = 0;\n                            value[Constants.AUTH_DATA_KEY.TRANSLATE] = 0;\n                            value[Constants.AUTH_DATA_KEY.APPROVAL] = 0;\n                            value[Constants.AUTH_DATA_KEY.FULL] = 0;\n                        }\n                    }\n\n                    value[dataKey] = maskTemp;\n                    value = this._setAuths(value);\n\n                    dataList[key] = value;\n\n                }\n            });\n        }\n        \n        dataList[index] = item;\n\n        // if (parseInt(item.has_child) === 1) {\n        // dataList.map((value, key) => {\n        //     if (item.id === value.parent) {\n        //         let action = 0;\n        //         let maskTemp = 0;\n        //         if (checked) {\n        //             // for (let k = 0; k < vAuth + 1; k++) {\n        //             //     maskTemp = 1 << k;\n        //             // }\n        //             // add view permission if other permission has been checked\n        //             if (!Libs.isBlank(vAuth) && vAuth !== Constants.AUTH_MODE.VIEW) {\n        //                 value[Constants.AUTH_DATA_KEY.VIEW] = 1;\n        //             }\n        //         } else {\n        //             if (!Libs.isBlank(vAuth) && vAuth === Constants.AUTH_MODE.VIEW) {\n        //                 value[Constants.AUTH_DATA_KEY.NEW] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.EDIT] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.DEL] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.PRINT] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.PDF] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.EXCEL] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.TRANSLATE] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.APPROVAL] = 0;\n        //                 value[Constants.AUTH_DATA_KEY.FULL] = 0;\n        //             }\n        //         }\n        //         // value[dataKey] = maskTemp;\n        //         value = this._setAuths(value);\n\n        //     }\n        // });\n        // } else {\n        // dataList.map((v, k) => {\n        //     if (v.id == item.parent) {\n        //         var dataLevel = dataList.filter((k) => k.parent === item.parent);\n\n        //         if (Libs.isArrayData(dataLevel)) {\n        //             var countNew = 0, countEdit = 0, countView = 0, countDelete = 0, countPrint = 0, countApproval = 0, countPdf = 0, countExcel = 0, countTranslate = 0;\n        //             dataLevel.map((val, key) => {\n        //                 if (val.id === item.id) {\n        //                     v[key] = item;\n        //                     if (item.new > 0) { countNew++; }\n        //                     if (item.edit > 0) { countEdit++; }\n        //                     if (item.view > 0) { countView++; }\n        //                     if (item.delete > 0) { countDelete++; }\n        //                     if (item.print > 0) { countPrint++; }\n        //                     if (item.pdf > 0) { countPdf++; }\n        //                     if (item.excel > 0) { countExcel++; }\n        //                     if (item.translate > 0) { countTranslate++; }\n        //                     if (item.approval > 0) { countApproval++; }\n        //                 } else {\n        //                     if (val.new > 0) { countNew++; }\n        //                     if (val.edit > 0) { countEdit++; }\n        //                     if (val.view > 0) { countView++; }\n        //                     if (val.delete > 0) { countDelete++; }\n        //                     if (val.print > 0) { countPrint++; }\n        //                     if (val.pdf > 0) { countPdf++; }\n        //                     if (val.excel > 0) { countExcel++; }\n        //                     if (val.translate > 0) { countTranslate++; }\n        //                     if (val.approval > 0) { countApproval++; }\n        //                 }\n        //             });\n\n        //             if (countNew > 0) { v[Constants.AUTH_DATA_KEY.NEW] = 2; } else { v[Constants.AUTH_DATA_KEY.NEW] = 0; }\n        //             if (countEdit > 0) { v[Constants.AUTH_DATA_KEY.EDIT] = 8; } else { v[Constants.AUTH_DATA_KEY.EDIT] = 0; }\n        //             if (countView > 0) { v[Constants.AUTH_DATA_KEY.VIEW] = 1; } else { v[Constants.AUTH_DATA_KEY.VIEW] = 0; }\n        //             if (countDelete > 0) { v[Constants.AUTH_DATA_KEY.DEL] = 4; } else { v[Constants.AUTH_DATA_KEY.DEL] = 0; }\n        //             if (countPrint > 0) { v[Constants.AUTH_DATA_KEY.PRINT] = 64; } else { v[Constants.AUTH_DATA_KEY.PRINT] = 0; }\n        //             if (countPdf > 0) { v[Constants.AUTH_DATA_KEY.PDF] = 32; } else { v[Constants.AUTH_DATA_KEY.PDF] = 0; }\n        //             if (countExcel > 0) { v[Constants.AUTH_DATA_KEY.EXCEL] = 16; } else { v[Constants.AUTH_DATA_KEY.EXCEL] = 0; }\n        //             if (countApproval > 0) { v[Constants.AUTH_DATA_KEY.APPROVAL] = 256; } else { v[Constants.AUTH_DATA_KEY.APPROVAL] = 0; }\n        //             if (countTranslate > 0) { v[Constants.AUTH_DATA_KEY.TRANSLATE] = 128; } else { v[Constants.AUTH_DATA_KEY.TRANSLATE] = 0; }\n\n        //             v = this._setAuths(v);\n        //             dataList[k] = v;\n\n        //         }\n\n        //     }\n        // });\n        // }\n\n        item = this._setAuths(item);\n\n        self.setState({\n            dataList: dataList\n        });\n        this._updateData(item);\n    }\n\n\n\n    /**\n     * Khi checked toàn quyền của màn hình thì tự động checked toàn bộ quyền của màn hình đó\n     * @author Long.Pham 2019-09-20\n     * @param {Object} data \n     * @param {Object} e \n     */\n    _selectFullCheckedChange = (event, item, index) => {\n        let self = this;\n        let checked = event.target.checked;\n        let mask = 0;\n        let dataList = this.state.dataList;\n        if (checked) {\n            mask = 511;\n            dataList[index].auths = mask;\n            if (parseInt(item.has_child) === 1) {\n                dataList.map((v, k) => {\n                    if (parseInt(item.id) === parseInt(v.parent)) {\n                        dataList[k].auths = mask;\n                    }\n                });\n            } else {\n                var findParent = Libs.find(dataList, 'id', item.parent);\n                if (!Libs.isObjectEmpty(findParent)) {\n                    dataList.map((m, n) => {\n                        if (parseInt(findParent.id) === parseInt(m.id)) {\n                            dataList[n].auths = mask;\n                        }\n                    });\n                }\n            }\n        } else {\n            dataList[index].auths = mask;\n            if (parseInt(item.has_child) === 1) {\n                dataList.map((v, k) => {\n                    if (parseInt(item.id) === parseInt(v.parent)) {\n                        dataList[k].auths = 0;\n                    }\n                });\n            }\n        }\n\n        self.setState({\n            dataList: dataList\n        });\n\n        this._updateData(item);\n    }\n\n\n    /**\n     * Update quyền đã chọn\n     * @author Long.Pham 2019-09-20\n     * @param {Array} data\n     */\n    async _updateData(data) {\n        var { t } = this.props;\n        let self = this, screens = [];\n        let curItem = self.state.curItem;\n        if (Libs.isObjectEmpty(data)) {\n            this.toast(t(\"message.msg_err_unknown\"), \"error\");\n            return;\n        }\n\n        let dataList = self.state.dataList;\n\n        if (!Libs.isBlank(data.has_child)) {\n            screens.push({\n                id_role: curItem.id_role,\n                id_screen: data.id_screen,\n                id_package_screen: data.id_package_screen,\n                auths: data.auths\n            });\n\n            if (Libs.isArrayData(dataList)) {\n\n\n                dataList.map((v, k) => {\n                    if (v.parent === data.id) {\n                        screens.push({\n                            id_role: curItem.id_role,\n                            id_screen: v.id_screen,\n                            id_package_screen: v.id_package_screen,\n                            auths: v.auths\n                        });\n                    }\n                })\n            }\n\n        } else {\n            if (!Libs.isArrayData(dataList)) return;\n            let item = Libs.find(dataList, 'id', data.id);\n            if (Libs.isObjectEmpty(item)) return;\n            screens.push({\n                id_role: curItem.id_role,\n                id_screen: data.id_screen,\n                id_package_screen: data.id_package_screen,\n                auths: data.auths\n            });\n\n            var dataParent = Libs.find(dataList, 'id', data.parent);\n            if (!Libs.isObjectEmpty(dataParent)) {\n                screens.push({\n                    id_role: curItem.id_role,\n                    id_screen: dataParent.id_screen,\n                    id_package_screen: dataParent.id_package_screen,\n                    auths: dataParent.auths\n                });\n            }\n        }\n\n\n        if (!Libs.isArrayData(screens)) {\n            this.toast(t(\"message.msg_err_unknown\"), \"error\");\n            return;\n        }\n\n        curItem.screens = screens;\n        RoleService.instance.updateRolePermissions(curItem, function (status, msg) {\n            if (status) {\n                self.getListScreenPermissions();\n            } else {\n                self.toast(msg, \"error\");\n            }\n        });\n        this.setState({\n            dataList: dataList\n        })\n    }\n\n    handleDropdownChange = (obj) => {\n        if (Libs.isObjectEmpty(obj)) return;\n        let curItem = this.state.curItem;\n        curItem = obj;\n        var self = this;\n        self.setState({\n            curItem: curItem\n        }, () => {\n            self.getListScreenPermissions();\n        });\n    }\n\n\n    /**\n         * ge list roles\n         * @author Long.Pham 2019-06-03\n         */\n    getDataRole() {\n        let self = this, curItem = this.state.curItem;\n        let params = self.state.searchParam;\n        params.id_company = this.employee.id_company;\n        params.id_language = this.employee.id_language;\n\n        RoleService.instance.getDropdownList(params, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                curItem = data[0];\n                self.setState({\n                    dataRoles: data,\n                    curItem: curItem\n                }, () => {\n                    self.getListScreenPermissions();\n                });\n            }\n        })\n    }\n\n\n    /**\n     * get list screen\n     * @author long.pham 27/07/2019\n     */\n\n    getListScreenPermissions() {\n        let self = this, curItem = this.state.curItem;\n        curItem.id_language = this.employee.id_language;\n        curItem.id_role = curItem.id;\n        RoleService.instance.getListScreenPermissions(curItem, (data, total_row) => {\n            if (Libs.isArrayData(data)) {\n                self.setState({\n                    dataList: data\n                });\n            } else {\n                self.setState({\n                    dataList: []\n                });\n            }\n        })\n    }\n\n    onClickUpdateRole() {\n        var curItem = this.state.curItem, self = this;\n        RoleService.instance.updateRoleMapScreen(curItem, function (status, data, msg) {\n            if (status) {\n                self.toast(msg, \"info\");\n                self.getListScreenPermissions();\n            }\n            else if (!Libs.isBlank(msg)) {\n                self.toast(msg, \"error\");\n            }\n        }, true);\n\n    }\n\n    render() {\n        return this.jsxTemplate.call(this)\n    }\n}\n\nconst HighOrderComponentTranslated = withTranslation('common')(Permissions)\nexport default HighOrderComponentTranslated;"]},"metadata":{},"sourceType":"module"}